(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(t,e,n){"use strict";n(58),n(23);var r=n(10);n.d(e,"CenterApi",function(){return r.a}),n.d(e,"UnitxApi",function(){return r.c}),n.d(e,"UqApi",function(){return r.d}),n.d(e,"appInFrame",function(){return r.f}),n.d(e,"getExHash",function(){return r.g}),n.d(e,"loadAppUqs",function(){return r.k}),n.d(e,"postWsToTop",function(){return r.m});var i=n(14);n.o(i,"Controller")&&n.d(e,"Controller",function(){return i.Controller}),n.o(i,"Form")&&n.d(e,"Form",function(){return i.Form}),n.o(i,"Image")&&n.d(e,"Image",function(){return i.Image}),n.o(i,"NavView")&&n.d(e,"NavView",function(){return i.NavView}),n.o(i,"Page")&&n.d(e,"Page",function(){return i.Page}),n.o(i,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return i.TabCaptionComponent}),n.o(i,"Tabs")&&n.d(e,"Tabs",function(){return i.Tabs}),n.o(i,"VPage")&&n.d(e,"VPage",function(){return i.VPage}),n.o(i,"View")&&n.d(e,"View",function(){return i.View}),n.o(i,"nav")&&n.d(e,"nav",function(){return i.nav}),n.o(i,"resLang")&&n.d(e,"resLang",function(){return i.resLang});n(24);var o=n(65);n.d(e,"PageItems",function(){return o.a});n(66),n(85)},function(t,e,n){"use strict";var r=n(42);n.o(r,"EasyDate")&&n.d(e,"EasyDate",function(){return r.EasyDate}),n.o(r,"FA")&&n.d(e,"FA",function(){return r.FA}),n.o(r,"LMR")&&n.d(e,"LMR",function(){return r.LMR}),n.o(r,"List")&&n.d(e,"List",function(){return r.List}),n.o(r,"Muted")&&n.d(e,"Muted",function(){return r.Muted}),n.o(r,"PropGrid")&&n.d(e,"PropGrid",function(){return r.PropGrid}),n.o(r,"SearchBox")&&n.d(e,"SearchBox",function(){return r.SearchBox});var i=n(80);n.d(e,"List",function(){return i.a});n(71);var o=n(72);n.d(e,"EasyDate",function(){return o.a});var s=n(81);n.d(e,"PropGrid",function(){return s.a});var a=n(79);n.d(e,"FA",function(){return a.a}),n.d(e,"LMR",function(){return a.b}),n.d(e,"Muted",function(){return a.c});n(73),n(82);var u=n(74);n.d(e,"SearchBox",function(){return u.a});n(75),n(20)},,,,function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return u});var r=n(0),i=n(2),o=n(27),s=n(44),a=function(t){function e(e,n,r,i){var o=t.call(this,e,i)||this;Object.setPrototypeOf(o.x,e.x);var a=n.name,u=n.typeName;return o.entity=n,o.ui=r,o.label=o.res.label||a,o.icon=s.a[u],o}return r.d(e,t),e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.loadSchema()];case 1:return t.sent(),[2,!0]}})})},e.prototype.createForm=function(t,e,n){var r=this.buildFormOptions(n),i=new o.b(r,t);return i.setValues(e),i},e.prototype.buildFormOptions=function(t){var e,n,r,i,s,a=this.entity,u=a.fields,c=a.arrFields;void 0!==this.res&&(e=this.res.none,n=this.res.submit,r=this.res.arrNew,i=this.res.arrEdit,s=this.res.arrTitleNewButton),void 0===e&&(e=this.cUq.res.none||"none"),void 0===n&&(n=this.cUq.res.submit||"Submit"),void 0===r&&(r=this.cUq.res.arrNew||"New"),void 0===i&&(i=this.cUq.res.arrEdit||"Edit"),void 0===s&&(s=this.cUq.res.arrTitleNewButton),void 0===t&&(t=o.a.new);var l=this.ui.form;return{fields:u,arrs:c,ui:l,res:this.res||{},inputs:this.buildInputs(l),none:e,submitCaption:n,arrNewCaption:r,arrEditCaption:i,arrTitleNewButton:s,mode:t}},e.prototype.buildInputs=function(t){var e=this.entity,n=e.fields,r=e.arrFields,i={};if(this.buildFieldsInputs(i,n,void 0,t),void 0!==r)for(var o=0,s=r;o<s.length;o++){var a=s[o],u=a.name,c=a.fields,l=t&&t.items;this.buildFieldsInputs(i,c,u,l&&l[u])}return i},e.prototype.buildFieldsInputs=function(t,e,n,r){if(void 0!==n){var i=t[n];void 0===i&&(t[n]=i={},t=i)}for(var o=0,s=e;o<s.length;o++){var a=s[o],u=a.name,c=a._tuid;if(void 0!==c){var l=r&&r.items&&r.items[u];t[u]={select:this.buildSelect(a,n,l),content:this.buildContent(a,n),placeHolder:this.cUq.getTuidPlaceHolder(c)}}}},e.prototype.buildSelect=function(t,e,n){var i=this;return function(t,e,o){return r.b(i,void 0,Promise,function(){var i,o,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return i=e._tuid,o=e._ownerField,[4,i.cSelectFrom()];case 1:return s=r.sent(),a=void 0,void 0!==o&&(a=t.getValue(o.name)),n&&!0===n.autoList&&(console.log("select search set param=empty string"),a=""),[4,s.call(a)];case 2:return u=r.sent(),s.removeCeased(),void 0===u?[2,void 0]:(c=s.idFromItem(u),i.useId(c),[2,c])}})})}},e.prototype.buildContent=function(t,e){},e.prototype.cQuerySelect=function(t){return this.cUq.cQuerySelect(t)},e}(n(45).a),u=function(t){function e(e){var n=t.call(this,e)||this;return n.entity=e.entity,n.ui=e.ui,n}return r.d(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this.controller.label},enumerable:!0,configurable:!0}),e.prototype.createForm=function(t,e,n){return this.controller.createForm(t,e,n)},e}(i.VPage)},,function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return v}),n.d(e,"a",function(){return g}),n.d(e,"c",function(){return w});var r,i=n(0),o=n(1),s=n(4),a=n(19),u=n(55),c=n(86),l=n(15),h=n(87),d=n(10),p=n(18),f=n(26),m=n(39),v=(n(60),n(89),n(103),n(105),new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0),b=(n(90),[]),y=1,g=function(e){function n(t){var n=e.call(this,t)||this;return n.waitCount=0,n.isHistoryBack=!1,n.clearError=function(){n.setState({fetchError:void 0})},n.back=n.back.bind(n),n.navBack=n.navBack.bind(n),n.stack=[],n.state={stack:n.stack,wait:0,fetchError:void 0},n}return i.d(n,e),n.prototype.componentWillMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){return window.addEventListener("popstate",this.navBack),[2]})})},n.prototype.componentDidMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return w.set(this),[4,w.start()];case 1:return t.sent(),[2]}})})},Object.defineProperty(n.prototype,"level",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),n.prototype.startWait=function(){var e=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=t.setTimeout(function(){e.waitTimeHandler=void 0,e.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})},n.prototype.endWait=function(){var t=this;setTimeout(function(){--t.waitCount,0===t.waitCount&&(void 0!==t.waitTimeHandler&&(clearTimeout(t.waitTimeHandler),t.waitTimeHandler=void 0),t.setState({wait:0}))},100)},n.prototype.onError=function(t){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(n){switch(n.label){case 0:return void 0===(e=t.error)||!0!==e.unauthorized?[3,2]:[4,w.showLogin(void 0)];case 1:return n.sent(),[2];case 2:return this.setState({fetchError:t}),[2]}})})},n.prototype.show=function(t,e){return this.clear(),this.push(t,e)},n.prototype.push=function(t,e){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=y++;return this.stack.push({key:n,view:t,ceased:!1,disposer:e}),this.refresh(),n},n.prototype.replace=function(t,e){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var i=y++;return this.stack.push({key:i,view:t,ceased:!1,disposer:e}),void 0!==n&&this.dispose(n.disposer),this.refresh(),i},n.prototype.ceaseTop=function(t){void 0===t&&(t=1);for(var e=this.stack.length-1,n=0;n<t&&!(e<0);n++,e--){this.stack[e].ceased=!0}},n.prototype.pop=function(t){void 0===t&&(t=1);var e=this.stack,n=e.length;if(!(t<=0||n<=1)){n<t&&(t=n);for(var r=0,i=0;i<t&&0!==e.length;i++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}},n.prototype.popTo=function(t){if(void 0!==t&&void 0!==this.stack.find(function(e){return e.key===t}))for(;this.stack.length>0;){var e=this.stack.length;if(this.stack[e-1].key===t)break;this.pop()}},n.prototype.topKey=function(){var t=this.stack.length;if(0!==t)return this.stack[t-1].key},n.prototype.removeCeased=function(){for(;;){var t=this.stack.length-1;if(t<0)break;if(!1===this.stack[t].ceased)break;var e=this.stack.pop().disposer;this.dispose(e)}this.refresh()},n.prototype.popAndDispose=function(){this.removeCeased();var t=this.stack.pop();if(void 0!==t){var e=t.disposer;return this.dispose(e),this.removeCeased(),t}},n.prototype.dispose=function(t){void 0!==t&&(void 0===this.stack.find(function(e){return e.disposer===t})&&t())},n.prototype.clear=function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose()},n.prototype.regConfirmClose=function(t){var e=this.stack,n=e.length;0!==n&&(e[n-1].confirmClose=t)},n.prototype.navBack=function(){w.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1},n.prototype.back=function(t){return void 0===t&&(t=!0),i.b(this,void 0,void 0,function(){var e,n,r;return i.e(this,function(i){switch(i.label){case 0:return e=this.stack,0===(n=e.length)?[2]:1===n?(self!=window.top&&window.top.postMessage({type:"pop-app"},"*"),[2]):(r=e[n-1],!0===t&&r.confirmClose?[4,r.confirmClose()]:[3,2]);case 1:return!0===i.sent()&&this.pop(),[3,3];case 2:this.pop(),i.label=3;case 3:return[2]}})})},n.prototype.confirmBox=function(t){return window.confirm(t)},n.prototype.render=function(){var t=this.state,e=t.wait,n=t.fetchError,r=this.state.stack,s=r.length-1,a=null,u=null;switch(e){case 1:a=o.createElement("li",{className:"va-wait va-wait1"});break;case 2:a=o.createElement("li",{className:"va-wait va-wait2"},o.createElement(m.a,null))}return n&&(u=o.createElement(c.a,i.a({clearError:this.clearError},n))),o.createElement("ul",{className:"va"},r.map(function(t,e){var n=t.key,r=t.view;return o.createElement("li",{key:n,style:e<s?{visibility:"hidden"}:void 0},r)}),a,u)},n.prototype.refresh=function(){this.setState({stack:this.stack})},n}(o.Component),w=new(function(){function t(){this.local=new h.a,this.user=void 0;var t=f.b.lang,e=f.b.district;this.language=t,this.culture=e}return Object.defineProperty(t.prototype,"guest",{get:function(){var t=this.local.guest;if(void 0===t)return 0;var e=t.get();return void 0===e?0:e.guest},enumerable:!0,configurable:!0}),t.prototype.set=function(t){this.nav=t},t.prototype.registerReceiveHandler=function(t){if(void 0!==this.ws)return this.ws.onWsReceiveAny(t)},t.prototype.unregisterReceiveHandler=function(t){void 0!==this.ws&&void 0!==t&&this.ws.endWsReceive(t)},t.prototype.onReceive=function(t){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return void 0===this.ws?[2]:[4,this.ws.receive(t)];case 1:return e.sent(),[2]}})})},t.prototype.getPredefinedUnitName=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,fetch("unit.json",{})];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().unit];case 3:return t.sent(),this.local.unit.clear(),[2];case 4:return[2]}})})},t.prototype.loadPredefinedUnit=function(){return i.b(this,void 0,void 0,function(){var t,e,n;return i.e(this,function(r){switch(r.label){case 0:return void 0===(e=this.local.unit.get())?[3,2]:!0!==d.j?[2,e.id]:[4,this.getPredefinedUnitName()];case 1:return void 0===(t=r.sent())?[2]:e.name===t?[2,e.id]:[3,4];case 2:return[4,this.getPredefinedUnitName()];case 3:if(void 0===(t=r.sent()))return[2];r.label=4;case 4:return[4,d.h.unitFromName(t)];case 5:return void 0!==(n=r.sent())&&this.local.unit.set({id:n,name:t}),[2,n]}})})},t.prototype.setSettings=function(t){this.navSettings=t},t.prototype.start=function(){return i.b(this,void 0,void 0,function(){var t,e,n,r,o,s,a,u,c,h,f;return i.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,11,12,13]),void 0!==(t=document.location.hash)&&t.length>0&&((e=Object(l.f)())<0&&(e=void 0),this.hashParam=t.substring(1,e)),w.clear(),this.startWait(),[4,d.i.start()];case 1:return i.sent(),n=d.i.url,r=d.i.ws,o=d.i.resHost,this.centerHost=n,this.resUrl="http://"+o+"/res/",this.wsHost=r,Object(d.p)(n),void 0!==(s=this.local.guest.get())?[3,3]:[4,d.h.guest()];case 2:s=i.sent(),i.label=3;case 3:return w.setGuest(s),a=Object(l.e)(),u=Object(l.i)(a),void 0!==a&&window!==window.parent&&void 0!==u?(this.ws=p.d,console.log("this.ws = wsBridge in sub frame"),self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:u.hash},"*"),[2]):[4,this.loadPredefinedUnit()];case 4:return c=i.sent(),u.predefinedUnit=c,void 0!==(h=this.local.user.get())?[3,9]:void 0===(f=this.nav.props.notLogined)?[3,6]:[4,f()];case 5:return i.sent(),[3,8];case 6:return[4,w.showLogin(void 0)];case 7:i.sent(),i.label=8;case 8:return[2];case 9:return[4,w.logined(h)];case 10:return i.sent(),[3,13];case 11:return i.sent(),[3,13];case 12:return this.endWait(),[7];case 13:return[2]}})})},t.prototype.showAppView=function(){return i.b(this,void 0,void 0,function(){var t;return i.e(this,function(e){switch(e.label){case 0:return void 0===(t=this.nav.props.onLogined)?(w.push(o.createElement("div",null,"NavView has no prop onLogined")),[2]):(w.clear(),[4,t()]);case 1:return e.sent(),console.log("logined: AppView shown"),[2]}})})},t.prototype.setGuest=function(t){this.local.guest.set(t),u.a.set(0,t.token)},t.prototype.saveLocalUser=function(){this.local.user.set(this.user)},t.prototype.logined=function(t,e){return i.b(this,void 0,void 0,function(){return i.e(this,function(n){switch(n.label){case 0:return Object(d.l)(),(this.ws=new d.e(this.wsHost,t.token)).connect(),console.log("logined: %s",JSON.stringify(t)),this.user=t,this.saveLocalUser(),u.a.set(t.id,t.token),void 0===e?[3,1]:(e(t),[3,3]);case 1:return[4,this.showAppView()];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.loginTop=function(t){return this.navSettings&&this.navSettings.loginTop||t},t.prototype.showLogin=function(t,e){return i.b(this,void 0,void 0,function(){var r,s;return i.e(this,function(i){switch(i.label){case 0:return[4,n.e(1).then(n.bind(null,123))];case 1:return r=i.sent(),s=o.createElement(r.default,{withBack:e,callback:t}),!0!==e&&(this.nav.clear(),this.pop()),this.nav.push(s),[2]}})})},t.prototype.showLogout=function(t){return i.b(this,void 0,void 0,function(){var e=this;return i.e(this,function(n){return w.push(o.createElement(a.a,{header:"\u5b89\u5168\u9000\u51fa",back:"close"},o.createElement("div",{className:"m-5 border border-info bg-white rounded p-3 text-center"},o.createElement("div",null,"\u9000\u51fa\u5f53\u524d\u8d26\u53f7\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5386\u53f2\u6570\u636e\uff0c\u4e0b\u6b21\u767b\u5f55\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u672c\u8d26\u53f7"),o.createElement("div",{className:"mt-3"},o.createElement("button",{className:"btn btn-danger",onClick:function(){return e.logout(t)}},"\u9000\u51fa"))))),[2]})})},t.prototype.logout=function(t){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(n){switch(n.label){case 0:return d.f.unit=void 0,this.local.logoutClear(),this.user=void 0,Object(d.l)(),e=this.local.guest.get(),Object(d.o)(0,e&&e.token),this.ws=void 0,void 0!==t?[3,2]:[4,w.start()];case 1:return n.sent(),[3,4];case 2:return[4,t()];case 3:n.sent(),n.label=4;case 4:return[2]}})})},t.prototype.changePassword=function(){return i.b(this,void 0,void 0,function(){var t;return i.e(this,function(e){switch(e.label){case 0:return[4,n.e(2).then(n.bind(null,122))];case 1:return t=e.sent(),w.push(o.createElement(t.ChangePasswordPage,null)),[2]}})})},Object.defineProperty(t.prototype,"level",{get:function(){return this.nav.level},enumerable:!0,configurable:!0}),t.prototype.startWait=function(){this.nav.startWait()},t.prototype.endWait=function(){this.nav.endWait()},t.prototype.onError=function(t){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return[4,this.nav.onError(t)];case 1:return e.sent(),[2]}})})},t.prototype.show=function(t,e){this.nav.show(t,e)},t.prototype.push=function(t,e){this.nav.push(t,e)},t.prototype.replace=function(t,e){this.nav.replace(t,e)},t.prototype.pop=function(t){void 0===t&&(t=1),this.nav.pop(t)},t.prototype.topKey=function(){return this.nav.topKey()},t.prototype.popTo=function(t){this.nav.popTo(t)},t.prototype.clear=function(){this.nav.clear()},t.prototype.navBack=function(){this.nav.navBack()},t.prototype.ceaseTop=function(t){this.nav.ceaseTop(t)},t.prototype.removeCeased=function(){this.nav.removeCeased()},t.prototype.back=function(t){return void 0===t&&(t=!0),i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return[4,this.nav.back(t)];case 1:return e.sent(),[2]}})})},t.prototype.regConfirmClose=function(t){this.nav.regConfirmClose(t)},t.prototype.confirmBox=function(t){return this.nav.confirmBox(t)},t.prototype.navToApp=function(t,e,n,r,s){return i.b(this,void 0,Promise,function(){var a=this;return i.e(this,function(i){return[2,new Promise(function(i,u){var c=!0===a.centerHost.includes("http://localhost:")?"sheet_debug":"sheet",h=void 0===s?Object(l.c)(t,e):Object(l.c)(t,e,c,[n,r,s]);console.log("navToApp: %s",JSON.stringify(h)),w.push(o.createElement("article",{className:"app-container"},o.createElement("span",{id:h.hash,onClick:function(){return a.back()},style:v},o.createElement("i",{className:"fa fa-arrow-left"})),o.createElement("iframe",{src:h.url})),function(){i()})})]})})},t.prototype.navToSite=function(t){window.open(t)},Object.defineProperty(t.prototype,"logs",{get:function(){return b},enumerable:!0,configurable:!0}),t.prototype.log=function(t){b.push(t)},t.prototype.logMark=function(){var t=new Date;r=t.getTime(),b.push("log-mark: "+t.toTimeString())},t.prototype.logStep=function(t){b.push(t+": "+((new Date).getTime()-r))},i.c([s.l],t.prototype,"user",void 0),t}())}).call(this,n(38))},function(t,e,n){"use strict";var r=n(18),i=n(34),o=n(0),s=n(23),a=n(16),u=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.guest=function(){return o.b(this,void 0,Promise,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return[4,this.get("",{})];case 1:switch(typeof(t=e.sent())){default:return[2];case"string":return[2,Object(s.a)(t)];case"object":return[2,Object(s.a)(t.token)]}return[2]}})})},e.prototype.unitFromName=function(t){return o.b(this,void 0,Promise,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.get(t)];case 1:return[2,(e=n.sent())&&e.unit]}})})},e}(a.a))("tv/guest/",void 0),c=n(15),l=n(22);n(28);n.d(e,"e",function(){return r.a}),n.d(e,"m",function(){return r.b}),n.d(e,"n",function(){return i.b}),n.d(e,"h",function(){return u}),n.d(e,"l",function(){return a.h}),n.d(e,"d",function(){return a.d}),n.d(e,"c",function(){return a.c}),n.d(e,"p",function(){return a.j}),n.d(e,"o",function(){return a.i}),n.d(e,"a",function(){return a.a}),n.d(e,"b",function(){return a.b}),n.d(e,"k",function(){return a.g}),n.d(e,"f",function(){return c.a}),n.d(e,"g",function(){return c.e}),n.d(e,"j",function(){return l.b}),n.d(e,"i",function(){return l.a})},function(t,e,n){"use strict";n.d(e,"d",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return c});var r=n(1),i=n(5),o=n(12),s=function(){function t(){}return t.prototype.render=function(t){return void 0===this.view?r.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):r.createElement(this.view,{vm:this,className:t})},t}(),a=function(t,e){return r.createElement(r.Fragment,null,"content: ",Object(o.a)(t))},u=Object(i.a)(a),c=function(t){return r.createElement("div",{className:"px-3 py-2"},Object(o.a)(t))}},function(t,e,n){"use strict";function r(t,e){switch(t.substr(0,1)){default:return e;case"$":case"_":return}}function i(t){return JSON.stringify(t,r," ")}var o=n(1),s=n(5),a=n(30);var u=Object(s.a)(function(t){var e=t.tuidValue,n=t.ui,r=t.x,i=t.nullUI,s=typeof e;switch(s){default:if(void 0===n)return o.createElement(o.Fragment,null,s,"-",e);var u=n(e,r);return void 0!==u?u:o.createElement(o.Fragment,null,e);case"undefined":break;case"object":if(null!==e)return function(t,e,n){if("number"===typeof t)return o.createElement(o.Fragment,null,t);var r=t,i=r.id,s=r._$tuid,u=r._$com,c=s;if(void 0===c)return void 0!==e?e(t,n):Object(a.PureJSONContent)(t,n);var l=e||u;void 0===l&&(l=t._$com=c.getTuidContent());var h=c.valueFromId(i);if("number"===typeof h&&(h={id:h}),void 0!==e){var d=e(h,n);return void 0!==d?d:o.createElement(o.Fragment,null,i)}return o.createElement(l,h)}(e,n,r);break;case"number":return o.createElement(o.Fragment,null,"id...",e)}return void 0===i?o.createElement(o.Fragment,null,"."):i()}),c=function(t,e,n,r){return o.createElement(u,{tuidValue:t,ui:e,x:n,nullUI:r})};n.d(e,"a",function(){return i}),n.d(e,"b",function(){return c})},function(t,e,n){"use strict";n.d(e,"startApp",function(){return a});var r=n(0),i=n(1),o=n(30);n(32);n.o(o,"CApp")&&n.d(e,"CApp",function(){return o.CApp}),n.o(o,"tv")&&n.d(e,"tv",function(){return o.tv});n(46);var s=n(12);function a(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return function t(e){for(var n in e){var r=e[n];if(e[n.toLowerCase()]=r,"object"===typeof r&&!i.isValidElement(r))if(!0===Array.isArray(r))for(var o=0,s=r;o<s.length;o++)t(s[o]);else t(r)}}(t),[4,new(t&&t.CApp||o.CApp)(t).start()];case 1:return e.sent(),[2]}})})}n.d(e,"tv",function(){return s.b})},function(t,e,n){"use strict";var r=n(9);n.d(e,"NavView",function(){return r.a}),n.d(e,"nav",function(){return r.c});n(35);var i=n(19);n.d(e,"Page",function(){return i.a});var o=n(61);n.d(e,"Controller",function(){return o.a}),n.d(e,"VPage",function(){return o.b}),n.d(e,"View",function(){return o.c});var s=n(62);n.o(s,"Edit")&&n.d(e,"Edit",function(){return s.Edit}),n.o(s,"Form")&&n.d(e,"Form",function(){return s.Form}),n.o(s,"Image")&&n.d(e,"Image",function(){return s.Image}),n.o(s,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return s.TabCaptionComponent}),n.o(s,"Tabs")&&n.d(e,"Tabs",function(){return s.Tabs}),n.o(s,"resLang")&&n.d(e,"resLang",function(){return s.resLang});var a=n(78);n.d(e,"Form",function(){return a.a});var u=n(83);n.d(e,"Edit",function(){return u.a});var c=n(26);n.d(e,"resLang",function(){return c.a});var l=n(84);n.d(e,"TabCaptionComponent",function(){return l.a}),n.d(e,"Tabs",function(){return l.b});n(39);var h=n(21);n.d(e,"Image",function(){return h.a});n(40)},function(t,e,n){"use strict";n.d(e,"h",function(){return d}),n.d(e,"a",function(){return f}),n.d(e,"g",function(){return m}),n.d(e,"i",function(){return g}),n.d(e,"f",function(){return w}),n.d(e,"e",function(){return E}),n.d(e,"c",function(){return k}),n.d(e,"b",function(){return C}),n.d(e,"d",function(){return N});var r=n(0),i=n(8),o=n.n(i),s=n(14),a=n(24),u=n(16),c=n(18),l=n(22),h={};function d(){for(var t in h)h[t]=void 0}var p={},f=new(function(){function t(){}return Object.defineProperty(t.prototype,"unit",{get:function(){return this._unit},set:function(t){this._unit=t},enumerable:!0,configurable:!0}),t}());function m(){return self!==window.parent}function v(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return console.log("initSubWin: set nav.user",t),e=s.nav.user=t,Object(u.i)(e.id,e.token),[4,s.nav.showAppView()];case 1:return n.sent(),[2]}})})}function b(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return void 0===(n=p[t])?[2,{name:e,url:void 0,urlDebug:void 0,token:void 0}]:(i=n.unit,o=n.predefinedUnit,s=e.split("/"),[4,u.k.uq({unit:i||o,uqOwner:s[0],uqName:s[1]})]);case 1:if(void 0===(a=r.sent()))throw console.log("apiTokenApi.api return undefined. api=%s, unit=%s",e,i),"api not found";return[2,{name:e,url:a.url,urlDebug:a.urlDebug,token:a.token}]}})})}function y(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a;return r.e(this,function(r){if(e=t.apiName,n=t.url,i=t.urlDebug,o=t.token,void 0===(s=h[e]))throw"error app api return";return a=l.a.getUrlOrDebug(n,i),console.log("onAppApiReturn(message:any): url="+n+", debug="+i+", real="+a),s.url=a,s.token=o,s.resolve(s),[2]})})}function g(t){if(t){var e=t.split("-"),n=e.length;if(n>0){var r=1;f.hash=e[r++],n>0&&(f.unit=Number(e[r++])),n>1&&(f.page=e[r++]),n>2&&(f.param=e.slice(r++))}}return f}function w(){var t=document.location.hash;if(void 0!==t&&t.length>0){var e=t.lastIndexOf("#tv-");return e<0&&(e=t.lastIndexOf("#tvdebug-")),e}return-1}function E(){var t=w();if(!(t<0))return document.location.hash.substring(t)}function k(t,e,n,r){for(var i;;){if(i=Object(a.a)(),void 0===p[i]){p[i]={hash:i,unit:e};break}}if(t+="#tv-"+i+"-"+e,void 0!==n&&(t+="-"+n,void 0!==r))for(var o=0;o<r.length;o++)t+="-"+r[o];return{url:t,hash:i}}function C(t,e,n){return r.b(this,void 0,Promise,function(){var i,o,s,a,c,d,p=this;return r.e(this,function(v){switch(v.label){case 0:return void 0!==(i=h[t])?[2,i]:m()?[3,2]:(o=f.unit,s=f.predefinedUnit,[4,u.k.uq({unit:o||s,uqOwner:e,uqName:n})]);case 1:if(void 0===(i=v.sent()))throw"unauthorized call: uqTokenApi center return undefined!","unauthorized call: uqTokenApi center return undefined!";return void 0===i.token&&(i.token=u.f),a=i.url,c=i.urlDebug,d=l.a.getUrlOrDebug(a,c),console.log("realUrl: %s",d),i.url=d,h[t]=i,[2,i];case 2:return console.log("appApi parent send: %s",f.hash),i={name:t,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},h[t]=i,[2,new Promise(function(e,n){i.resolve=function(t){return r.b(p,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),console.log("return from parent window: %s",JSON.stringify(n)),i.url=n.url,i.urlDebug=n.urlDebug,i.token=n.token,e(i),[2]}})})},i.reject=n,(window.opener||window.parent).postMessage({type:"app-api",apiName:t,hash:f.hash},"*")})]}})})}window.addEventListener("message",function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:switch(e=t.data,e.type){case"sub-frame-started":return[3,1];case"ws":return[3,2];case"init-sub-win":return[3,4];case"pop-app":return[3,6];case"center-api":return[3,7];case"center-api-return":return[3,9];case"app-api":return[3,10];case"app-api-return":return[3,12]}return[3,14];case 1:return function(t){var e=t.data,n=t.source;Object(c.c)(n),r=e.hash,i=document.getElementById(r),void 0!==i&&(i.hidden=!0);var r,i;var a=o.a.clone(s.nav.user);a.type="init-sub-win",n.postMessage(a,"*")}(t),[3,15];case 2:return[4,s.nav.onReceive(e.msg)];case 3:return r.sent(),[3,15];case 4:return[4,v(e)];case 5:return r.sent(),[3,15];case 6:return s.nav.navBack(),[3,15];case 7:return[4,S(t.source,e)];case 8:return r.sent(),[3,15];case 9:return function(t){var e=t.callId,n=t.result,r=P[e];if(void 0===r)return;P[e]=void 0,r.resolve(n)}(e),[3,15];case 10:return console.log("receive PostMessage: %s",JSON.stringify(e)),[4,b(e.hash,e.apiName)];case 11:return n=r.sent(),console.log("onReceiveAppApiMessage: %s",JSON.stringify(n)),t.source.postMessage({type:"app-api-return",apiName:e.apiName,url:n.url,urlDebug:n.urlDebug,token:n.token},"*"),[3,15];case 12:return console.log("app-api-return: %s",JSON.stringify(e)),console.log("await onAppApiReturn(message);"),[4,y(e)];case 13:return r.sent(),[3,15];case 14:return this.console.log("message: %s",JSON.stringify(e)),[3,15];case 15:return[2]}})})});var P={};function N(t,e,n){return r.b(this,void 0,Promise,function(){var i=this;return r.e(this,function(o){switch(o.label){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",t,e),[4,new Promise(function(o,s){return r.b(i,void 0,void 0,function(){var i;return r.e(this,function(r){for(;;)if(i=Object(a.a)(),void 0===P[i]){P[i]={id:i,resolve:o,reject:s};break}return(window.opener||window.parent).postMessage({type:"center-api",callId:i,url:t,method:e,body:n},"*"),[2]})})})];case 1:return[2,o.sent()]}})})}function S(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=e.callId,i=e.url,o=e.method,s=e.body,[4,u.e.directCall(i,o,s)];case 1:return a=r.sent(),t.postMessage({type:"center-api-return",callId:n,result:a},"*"),[2]}})})}},function(t,e,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(28),a=n(9),u=function(){function t(){}return t.prototype.startWait=function(){a.c.startWait()},t.prototype.endWait=function(){a.c.endWait()},t.prototype.showError=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return a.c.endWait(),[4,a.c.onError(t)];case 1:return e.sent(),[2]}})})},t}(),c=n(15),l=n(34),h=n(22),d=n(14);n.d(e,"h",function(){return m}),n.d(e,"d",function(){return b}),n.d(e,"c",function(){return w}),n.d(e,"j",function(){return E}),n.d(e,"f",function(){return P}),n.d(e,"i",function(){return S}),n.d(e,"a",function(){return x}),n.d(e,"k",function(){return F}),n.d(e,"e",function(){return T}),n.d(e,"b",function(){return V}),n.d(e,"g",function(){return I});var p={},f={};function m(){p={},f={},y={},Object(c.h)()}var v=new(function(){function t(){}return t.prototype.loadAccess=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a,u,c,l,h,d,p,f;return r.e(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),e=t.uqOwner,n=t.uqName,void 0===this.local&&null!==(i=localStorage.getItem("uqLocalEntities"))&&(this.local=JSON.parse(i)),void 0!==this.local)if(s=this.local,a=s.user,u=s.uqs,a!==N||void 0===u)this.local=void 0;else for(c in u)u[c].isNet=void 0;return void 0===this.local&&(this.local={user:N,unit:void 0,uqs:{}}),l=void 0,h=e+"/"+n,void 0!==(d=this.local.uqs[h])&&(p=d.value,l=p),void 0!==l?[3,2]:[4,t.__loadAccess()];case 1:l=r.sent(),this.saveLocal(h,l),r.label=2;case 2:return[2,o.a.cloneDeep(l)];case 3:throw f=r.sent(),this.local=void 0,localStorage.removeItem("uqLocalEntities"),f;case 4:return[2]}})})},t.prototype.saveLocal=function(t,e){this.local.uqs[t]={value:e,isNet:!0};var n=JSON.stringify(this.local);localStorage.setItem("uqLocalEntities",n)},t.prototype.checkAccess=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return e=t.uqOwner,n=t.uqName,i=e+"/"+n,void 0===(s=this.local.uqs[i])?[2,!1]:(a=s.isNet,u=s.value,!0===a?[2,!0]:[4,t.__loadAccess()]);case 1:return c=r.sent(),!1===o.a.isMatch(u,c)?(this.saveLocal(i,c),[2,!1]):(s.isNet=!0,[2,!0])}})})},t}()),b=function(t){function e(e,n,r,i,o){var s=t.call(this,e,o)||this;return r&&(s.uqOwner=n,s.uqName=r,s.uq=n+"/"+r),s.access=i,s.showWaiting=o,s}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i;return r.e(this,function(r){switch(r.label){case 0:return!0===this.showWaiting||void 0===this.showWaiting?(t=p,e=new u):t=f,void 0!==(n=t[this.uq])?[2,n]:[4,Object(c.b)(this.uq,this.uqOwner,this.uqName)];case 1:return i=r.sent(),this.token=i.token,n=new s.a(!1,i.url,i.token,e),[2,t[this.uq]=n]}})})},e.prototype.update=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("update")];case 1:return[2,t.sent()]}})})},e.prototype.__loadAccess=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=void 0===this.access?"":this.access.join("|"),[4,this.get("access",{acc:t})];case 1:return[2,e.sent()]}})})},e.prototype.loadAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,v.loadAccess(this)];case 1:return[2,t.sent()]}})})},e.prototype.loadEntities=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("entities")];case 1:return[2,t.sent()]}})})},e.prototype.checkAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,v.checkAccess(this)];case 1:return[2,t.sent()]}})})},e.prototype.schema=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("schema/"+t)];case 1:return[2,e.sent()]}})})},e.prototype.schemas=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.post("schema",t)];case 1:return[2,e.sent()]}})})},e.prototype.tuidGet=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("tuid/"+t+"/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.tuidGetAll=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tuid-all/"+t+"/")];case 1:return[2,e.sent()]}})})},e.prototype.tuidSave=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("tuid/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.tuidSearch=function(t,e,n,i,o,s){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuids/"+t,{arr:e,owner:n,key:i,pageStart:o,pageSize:s})];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrGet=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr/"+t+"/"+n+"/"+e+"/"+i)];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrGetAll=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr-all/"+t+"/"+n+"/"+e+"/")];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrSave=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr/"+t+"/"+n+"/"+e+"/",i)];case 1:return[2,r.sent()]}})})},e.prototype.tuidArrPos=function(t,e,n,i,o){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr-pos/"+t+"/"+n+"/"+e+"/",{id:i,$order:o})];case 1:return[2,r.sent()]}})})},e.prototype.tuidIds=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuidids/"+t+"/",i+=void 0!==e?e:"$",[4,this.post(i,n)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},e.prototype.proxied=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuid-proxy/"+t+"/"+e+"/"+n,[4,this.get(i)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},e.prototype.sheetSave=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetAction=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.put("sheet/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.stateSheets=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t+"/states",e)];case 1:return[2,n.sent()]}})})},e.prototype.stateSheetCount=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("sheet/"+t+"/statecount")];case 1:return[2,e.sent()]}})})},e.prototype.mySheets=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t+"/my-sheets",e)];case 1:return[2,n.sent()]}})})},e.prototype.getSheet=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+t+"/get/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetArchives=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+t+"/archives",e)];case 1:return[2,n.sent()]}})})},e.prototype.sheetArchive=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+t+"/archive/"+e)];case 1:return[2,n.sent()]}})})},e.prototype.action=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("action/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.page=function(t,e,n,i){return r.b(this,void 0,Promise,function(){var s;return r.e(this,function(r){switch(r.label){case 0:switch(typeof i){case"undefined":s={key:""};break;default:s=o.a.clone(i)}return s.$pageStart=e,s.$pageSize=n,[4,this.post("query-page/"+t,s)];case 1:return[2,r.sent()]}})})},e.prototype.query=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("query/"+t,e)];case 1:return[2,n.sent()]}})})},e.prototype.user=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("user")];case 1:return[2,t.sent()]}})})},e}(l.a),y={};var g,w=function(t){function e(e){var n=t.call(this,"tv/",void 0,void 0,void 0,!0)||this;return n.unitId=e,n}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(t=y[this.unitId])?[2,t]:(e=y,n=this.unitId,[4,this.buildChannel()]);case 1:return[2,e[n]=r.sent()]}})})},e.prototype.buildChannel=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o,a;return r.e(this,function(r){switch(r.label){case 0:return t=new u,[4,new V("tv/",void 0).unitxUq(this.unitId)];case 1:return e=r.sent(),n=e.token,i=e.url,o=e.urlDebug,a=h.a.getUrlOrDebug(i,o),this.token=n,[2,new s.a(!1,a,n,t)]}})})},e}(b);function E(t){console.log("setCenterUrl %s",t),g=t,P=void 0,C=void 0,k=void 0}var k,C,P=void 0,N=0;function S(t,e){N=t,P=e,console.log("setCenterToken %s",e),C=void 0,k=void 0}var x=function(t){function e(e,n){return t.call(this,e,n)||this}return r.d(e,t),e.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2,!0===this.showWaiting||void 0===this.showWaiting?void 0!==k?k:k=new s.a(!0,g,P,new u):void 0!==C?C:C=new s.a(!0,g,P)]})})},e}(l.a),F=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.uq=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a,u,c,l,h,d,p,f,m,v;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=t.unit,n=t.uqOwner,i=t.uqName,void 0===this.local&&null!==(s=localStorage.getItem("uqTokens"))&&(this.local=JSON.parse(s)),void 0!==this.local&&(a=this.local,u=a.unit,c=a.user,u===e&&c===N||(this.local=void 0)),void 0===this.local&&(this.local={user:N,unit:t.unit,uqs:{}}),l=n+"/"+i,h=(new Date).getTime(),void 0!==(d=this.local.uqs[l])&&(p=d.tick,f=d.value,h-p<864e5)?[2,o.a.clone(f)]:[4,this.get("app-uq",t)];case 1:return m=r.sent(),this.local.uqs[l]={tick:h,value:m},localStorage.setItem("uqTokens",JSON.stringify(this.local)),[2,o.a.clone(m)];case 2:throw v=r.sent(),this.local=void 0,localStorage.removeItem("uqTokens"),v;case 3:return[2]}})})},e}(x))("tv/tie/",void 0),T=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.directCall=function(t,e,n){return this.call(t,e,n)},e}(x))("",void 0),O="appUqs",V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.uqs=function(t,e){return r.b(this,void 0,Promise,function(){var n,i,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:return null!==(i=localStorage.getItem(O))&&(s=JSON.parse(i),a=s.appOwner,u=s.appName,c=s.value,t===a&&e===u&&(n=c)),void 0!==n?[3,2]:[4,this.uqsPure(t,e)];case 1:n=r.sent(),l={appOwner:t,appName:e,value:n},localStorage.setItem(O,JSON.stringify(l)),r.label=2;case 2:return[2,this.cachedUqs=o.a.cloneDeep(n)]}})})},e.prototype.uqsPure=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("tie/app-uqs",{appOwner:t,appName:e})];case 1:return[2,n.sent()]}})})},e.prototype.checkUqs=function(t,e){return r.b(this,void 0,Promise,function(){var n,i,s,a,u,c,l,h;return r.e(this,function(r){switch(r.label){case 0:return[4,this.uqsPure(t,e)];case 1:if(n=r.sent(),i=this.cachedUqs,s=i.id,a=i.uqs,u=n.id,c=n.uqs,s!==u)return[2,!1];if(a.length!==c.length)return[2,!1];for(l=a.length,h=0;h<l;h++)if(!1===o.a.isMatch(a[h],c[h]))return[2,!1];return[2,!0]}})})},e.prototype.unitxUq=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tie/unitx-uq",{unit:t})];case 1:return[2,e.sent()]}})})},e.prototype.changePassword=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.post("tie/reset-password",t)];case 1:return[2,e.sent()]}})})},e}(x);function I(t,e){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return[4,(n=new V("tv/",void 0)).uqs(t,e)];case 1:return i=r.sent(),n.checkUqs(t,e).then(function(t){!1===t&&(localStorage.removeItem(O),d.nav.start())}),[2,i]}})})}},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=function(t){function e(e){var n=t.call(this)||this;return n.onClick=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.start()];case 1:return t.sent(),[2]}})})},n.controller=e,n.icon=e.icon,n.label=e.label,n}return r.d(e,t),e.prototype.render=function(t){return i.createElement("div",{className:s()("px-3","py-2","align-items-center","cursor-pointer",t),onClick:this.onClick},this.icon," \xa0 ",this.label)},e}(function(){return function(){}}());n.d(e,"a",function(){return a})},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"d",function(){return c}),n.d(e,"a",function(){return l});var r,i=n(0);function o(t){r=t}function s(t){window.top.postMessage({type:"ws",msg:t},"*")}var a=function(){function t(){this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return t.prototype.onWsReceiveAny=function(t){var e=this.handlerSeed++;return this.anyHandlers[e]=t,e},t.prototype.onWsReceive=function(t,e){var n=this.handlerSeed++;return this.msgHandlers[n]={type:t,handler:e},n},t.prototype.endWsReceive=function(t){delete this.anyHandlers[t],delete this.msgHandlers[t]},t.prototype.receive=function(t){return i.b(this,void 0,void 0,function(){var e,n,r,o,s,a,u,c,l,h,d;return i.e(this,function(i){switch(i.label){case 0:for(r in e=t.$type,n=[],this.anyHandlers)n.push(r);o=0,i.label=1;case 1:return o<n.length?(c=n[o],[4,this.anyHandlers[c](t)]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:for(a in s=[],this.msgHandlers)s.push(a);u=0,i.label=5;case 5:return u<s.length?(c=s[u],l=this.msgHandlers[c],h=l.type,d=l.handler,h!==e?[3,7]:[4,d(t)]):[3,8];case 6:i.sent(),i.label=7;case 7:return u++,[3,5];case 8:return[2]}})})},t}(),u=1,c=new(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wsBaseId="WsBridge seed "+u++,e}return i.d(e,t),e}(a)),l=function(t){function e(e,n){var r=t.call(this)||this;return r.wsBaseId="WSChannel seed "+u++,r.wsHost=e,r.token=n,r}return i.d(e,t),e.setCenterToken=function(t){e.centerToken=t},e.prototype.connect=function(){var t=this;if(void 0===this.ws){var n=this;return new Promise(function(r,o){var s=new WebSocket(t.wsHost,t.token||e.centerToken);console.log("connect webSocket %s",t.wsHost),s.onopen=function(e){console.log("webSocket connected %s",t.wsHost),n.ws=s,r()},s.onerror=function(t){o("webSocket can't open!")},s.onmessage=function(e){return i.b(t,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return[4,n.wsMessage(e)];case 1:return[2,t.sent()]}})})},s.onclose=function(t){n.ws=void 0,console.log("webSocket closed!")}})}},e.prototype.close=function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)},e.prototype.wsMessage=function(t){return i.b(this,void 0,Promise,function(){var e,n;return i.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),console.log("websocket message: %s",t.data),function(t){void 0!==r&&r.postMessage({type:"ws",msg:t},"*")}(e=JSON.parse(t.data)),[4,this.receive(e)];case 1:return i.sent(),[3,3];case 2:return n=i.sent(),console.log("ws msg error: ",n),[3,3];case 3:return[2]}})})},e.prototype.sendWs=function(t){var e=this;this.connect().then(function(){e.ws.send(t)})},e}(a)},function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r=n(0),i=n(1),o=n(5),s=n(6),a=n.n(s),u=n(8),c=n.n(u),l=n(35),h=100,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bottomTime=0,e.topTime=0,e.onScroll=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o,s,a,u;return r.e(this,function(r){return e=this.props,n=e.onScroll,i=e.onScrollTop,o=e.onScrollBottom,n&&this.props.onScroll(t),(s=t.target).scrollTop<30&&void 0!==i&&(a=(new Date).getTime())-this.topTime>h&&(this.topTime=a,i()),s.scrollTop+s.offsetHeight>s.scrollHeight-30&&void 0!==o&&(u=(new Date).getTime())-this.bottomTime>h&&(this.bottomTime=u,o()),[2]})})},e}return r.d(e,t),e.prototype.eachChild=function(t,e){var n=this,r=t.props;if(void 0!==r){var o=r.children;void 0!==o&&i.Children.forEach(o,function(t,r){var i=t._$scroll;i&&i(e),console.log(t.toString()),n.eachChild(t,e)})}},e.prototype.render=function(){return i.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)},e}(i.Component),p=function(t){function e(e){var n,r=t.call(this,e)||this,i=e.tabs;if(void 0===i||0===i.length)return r;r.tabs=i;for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s],l=c.a.clone(u);void 0===n&&!0===l.isSelected?n=l:l.isSelected=!1,l.isMounted=!1,o.push(l)}return r.state={cur:n,tabs:o},r}return r.d(e,t),e.prototype.componentDidMount=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return void 0===this.tabs?[2]:void 0===(t=this.state.tabs[0])?[2]:[4,this.onTabClick(t)];case 1:return e.sent(),[2]}})})},e.prototype.onTabClick=function(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:if(!0===t.isSelected)return[2];for(n=this.state.tabs,i=0,o=n;i<o.length;i++)(s=o[i])===t?(s.isSelected=!0,e=s):s.isSelected=!1;return!0===e.isMounted?[3,2]:void 0===(a=e.load)?[3,2]:[4,a()];case 1:r.sent(),r.label=2;case 2:return this.setState({cur:e,tabs:n}),[2]}})})},e.prototype.onTouchStart=function(t){},e.prototype.renderTabs=function(t){var e,n=this,r=this.props,o=r.header,s=r.back,u=r.right,c=r.keepHeader,h=this.state.cur,p=i.createElement("div",null,this.state.tabs.map(function(t,e){var r,o,s,u=t.icon,c=t.isSelected,l=t.title,h=t.redDot;if(void 0!==u&&(r=i.createElement("img",{src:u})),void 0!==h){var d=h.get();d<0?(s=a()("red-dot"),o=i.createElement("u",null)):d>0&&(s=a()("red-dot","num"),o=i.createElement("u",null,d))}return i.createElement("div",{key:e,className:a()("va-tab",{cur:c}),onClick:function(){return n.onTabClick(t)}},r,i.createElement("div",{className:s},l,o))}));return!1!==o&&(e=i.createElement(l.a,{back:s,center:!0===c?o:h&&(h.header||h.title),right:u})),i.createElement("article",{className:"page-container"},e,i.createElement("section",{className:"position-relative"},this.props.sideBar,this.state.tabs.map(function(t,e){var n=t.isSelected,r=t.isMounted,o=t.content;if(!0===n||!0===r)return t.isMounted=!0,i.createElement(d,{key:e,className:a()({invisible:!1===n}),onScroll:t.onScroll,onScrollTop:t.onScrollTop,onScrollBottom:t.onScrollBottom},"function"===typeof o?o():o)})),p,t)},e.prototype.renderSingle=function(t){var e,n=this.props,r=n.back,o=n.header,s=n.right,a=n.onScroll,u=n.onScrollTop,c=n.onScrollBottom,h=n.children;return!1!==o&&(e=i.createElement(l.a,{back:r,center:o,right:s,logout:this.props.logout})),i.createElement("article",{className:"page-container",onTouchStart:this.onTouchStart},e,i.createElement("section",{className:"position-relative"},this.props.sideBar,i.createElement(d,{onScroll:a,onScrollTop:u,onScrollBottom:c},h)),t)},e.prototype.render=function(){var t,e=this.props.footer;return void 0!==e&&(t=i.createElement("footer",null,e)),void 0!==this.tabs?this.renderTabs(t):this.renderSingle(t)},e=r.c([o.a],e)}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function o(){for(var t=r.length,e="",n=0;n<i;n++)e+=r.charAt(Math.floor(Math.random()*t));return e}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(1),i=n(6),o=n.n(i),s=n(9);function a(t){var e=t.className,n=t.style,i=t.src;return i?(!0===i.startsWith(":")&&(i=s.c.resUrl+i.substr(1)),r.createElement("img",{src:i,className:e,style:n})):r.createElement("div",{className:o()(e,"image-none"),style:n},r.createElement("i",{className:"fa fa-file-o"}))}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return u});var r=n(0),i=!1,o=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_RES_HOST||"101.200.46.56",s={centerhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||"localhost:3000",local:!1},reshost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_RES_DEBUG_HOST||"localhost:3015",local:!1},uqhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},unitxhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},"uq-build":{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_BUILDER_HOST||"localhost:3009",local:!1}};var a={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},u=new(function(){function t(){}return t.prototype.start=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return!0!==i?[3,2]:[4,this.tryLocal()];case 1:e.sent(),e.label=2;case 2:return t=this.getCenterHost(),this.url=function(t){return"http://"+t+"/"}(t),this.ws=function(t){return"ws://"+t+"/tv/"}(t),this.resHost=this.getResHost(),[2]}})})},t.prototype.debugHostUrl=function(t){return"http://"+t+"/hello"},t.prototype.tryLocal=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,o,a,u,c,l,d,p,f,m,v;return r.e(this,function(r){switch(r.label){case 0:for(d in t=[],e=[],n=function(t){var n=s[t].value;e.findIndex(function(t){return t===n})<0&&e.push(n)},s)n(d);for(i=0,o=e;i<o.length;i++)a=o[i],u=this.debugHostUrl(a),t.push(h(u));return[4,Promise.all(t)];case 1:for(c=r.sent(),l=e.length,d=0;d<l;d++)for(m in p=c[d],f=e[d],s)(v=s[m]).value===f&&(v.local=p);return[2]}})})},t.prototype.getCenterHost=function(){var t=s.centerhost,e=t.value,n=t.local;return!0===document.location.hash.includes("sheet_debug")?e:!0===i&&!0===n?e:"101.200.46.56"},t.prototype.getResHost=function(){var t=s.reshost,e=t.value,n=t.local;return!0===document.location.hash.includes("sheet_debug")?e:!0===i&&!0===n?e:o},t.prototype.getUrlOrDebug=function(t,e){if(!0!==i)return t;if(!e)return t;for(var n in s){var r=s[n],o=r.value,a=r.local,u="://"+n+"/";if(e.indexOf(u)>0)return!1===a?t:e=e.replace(u,"://"+o+"/")}return t},t.prototype.localCheck=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,h(t)];case 1:return[2,e.sent()]}})})},t}()),c=200;function l(t){return new Promise(function(e,n){fetch(t,a).then(function(t){t.text().then(e).catch(n)}).catch(n);var r=new Error("Connection timed out");setTimeout(n,c,r)})}function h(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,l(t)];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}})})}},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return s});var r=n(54),i=n.n(r);function o(t){var e=i()(t);return{id:e.id,name:e.name,guest:e.guest,token:t}}function s(t){return{id:0,guest:i()(t).guest,token:t}}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function o(){for(var t=r.length,e="",n=0;n<i;n++)e+=r.charAt(Math.floor(Math.random()*t));return e}},function(t,e,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(7),a=n(1),u=n.n(a),c=n(3),l=n(2),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onNew=function(){return e.event("new")},e.onList=function(){return e.event("list")},e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return[2,this.event("list",t)]})})},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e.prototype.entityRender=function(t,e){return t.render()},e.prototype.entityClick=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,t.onClick()];case 1:return e.sent(),[2]}})})},Object.defineProperty(e.prototype,"view",{get:function(){var t,e,n=this.controller,r=n.label,i=n.proxyLinks;if(!1===n.isFrom&&(t=a.createElement("button",{className:"btn btn-outline-success ml-2",onClick:this.onNew},"\u65b0\u589e")),void 0===i){var o=a.createElement(a.Fragment,null,t,a.createElement("button",{className:"btn btn-outline-info ml-2",onClick:this.onList},"\u5168\u90e8"));e=a.createElement(c.LMR,{className:"m-3",right:o},a.createElement(c.SearchBox,{className:"w-100",size:"md",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+r}))}else e=a.createElement(c.List,{className:"my-2",header:a.createElement(c.Muted,null,r," \u4ee3\u7406\u4e0b\u5217Tuid"),items:i,item:{render:this.entityRender,onClick:this.entityClick}});return function(){return a.createElement(l.Page,{header:r},e)}},enumerable:!0,configurable:!0}),e}(s.b),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.next=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.reset(),this.closePage(),[2]})})},e.finish=function(){e.closePage(2),e.event("edit-end")},e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,o,s,u;return r.e(this,function(r){switch(r.label){case 0:return t=this.vForm.getValues(),[4,this.controller.entity.save(this.id,t)];case 1:if(e=r.sent(),(n=e.id)<0){if(void 0!==(i=this.controller.entity.unique))for(o=0,s=i;o<s.length;o++)u=s[o],this.vForm.setError(u,"\u4e0d\u80fd\u91cd\u590d");return[2]}return this.controller.isCalling?(this.returnCall(n),this.closePage(),[2]):(this.openPageElement(a.createElement(l.Page,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.FA,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement("button",{className:"btn btn-primary mr-3",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement("button",{className:"btn btn-outline-primary",onClick:this.finish},"\u4e0d\u7ee7\u7eed"))))),this.event("item-changed",{id:this.id,values:t}),[2])}})})},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),void 0!==t&&(this.id=t.id),this.openPage(this.editView),[2]})})},Object.defineProperty(e.prototype,"editView",{get:function(){var t=this;return function(){return a.createElement(l.Page,{header:(void 0===t.id?"\u65b0\u589e":"\u7f16\u8f91")+" - "+t.label},t.vForm.render("py-3"))}},enumerable:!0,configurable:!0}),e.prototype.resetForm=function(){this.vForm.reset()},e}(s.b),p=n(11),f=n(5),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainView=Object(f.a)(function(){var t=u.a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearchMain,placeholder:"\u641c\u7d22"+e.label});return u.a.createElement(l.Page,{header:t,back:"close"},u.a.createElement(c.List,{items:e.controller.PageItems.items,item:{render:e.renderMainRow,onClick:e.clickMainRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e.onSearchMain=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderMainRow=function(t,n){return u.a.createElement(e.mainRowContent,r.a({},t))},e.clickMainRow=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.ceasePage(),void 0===this.controller.entity.owner?(this.returnCall(t),[2]):[4,this.showDiv(this.entity.getIdFromObj(t))];case 1:return e.sent(),[2]}})})},e.divView=function(t){return u.a.createElement(l.Page,{header:"\u9009\u62e9Div"},u.a.createElement(c.List,{items:t.items,item:{render:e.renderDivRow,onClick:e.clickDivRow}}))},e.renderDivRow=function(t,n){return u.a.createElement(e.divRowContent,r.a({},t))},e.clickDivRow=function(t){e.ceasePage(),e.returnCall(t)},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==t?[3,2]:[4,this.showMain(t)];case 1:return e.sent(),[3,4];case 2:return[4,this.showDiv(t)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype.showMain=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.mainRowContent=this.ui.rowContent||p.c,[4,this.controller.searchMain(t)];case 1:return e.sent(),this.openPage(this.mainView),[2]}})})},e.prototype.showDiv=function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(e=this.ui.divs)&&(this.divRowContent=e[this.entity.name].rowContent),void 0===this.divRowContent&&(this.divRowContent=p.c),[4,this.controller.getDivItems(t)];case 1:return n=r.sent(),this.openPage(this.divView,{items:n}),[2]}})})},e}(s.b),v=n(12),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.next=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.reset(),this.closePage(),[2]})})},e.finish=function(){e.closePage(2)},e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e,n=this;return r.e(this,function(r){switch(r.label){case 0:return t=this.vForm.getValues(),[4,this.entity.save(this.id,t)];case 1:return(e=r.sent())&&alert("\u8fd9\u91cc\u8fd8\u8981\u5224\u65ad\u8fd4\u56de\u503c\uff0c\u5148\u4e0d\u5904\u7406\u4e86 \n"+Object(v.a)(e)),this.openPage(function(){return a.createElement(l.Page,{header:n.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.FA,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement("button",{className:"btn btn-primary mr-3",onClick:n.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement("button",{className:"btn btn-outline-primary",onClick:n.finish},"\u4e0d\u7ee7\u7eed"))))}),[2]}})})},e.view=function(){return a.createElement(l.Page,{header:e.label},e.vForm.render("py-3"))},e}return r.d(e,t),e.prototype.buildForm=function(t){this.vForm=this.createForm(void 0,t)},e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.buildForm(t),this.openPage(this.view),[2]})})},e.prototype.render=function(t){return this.buildForm(t),this.vForm.render()},e.prototype.loadId=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.id=t,[2]})})},e.prototype.resetForm=function(){this.vForm.reset()},e}(s.b)),y=function(t){function e(e){var n=t.call(this,!0)||this;return n.tuid=e,n}return r.d(e,t),e.prototype.load=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tuid.search(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(l.PageItems),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.onSelected=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return!1===this.controller.isFrom?this.event("edit",t.id):this.event("info",t.id),[2]})})},e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,n){return a.createElement(e.rowContent,r.a({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.rowKey=function(t){return t.id},e.view=Object(f.a)(function(){var t,n=a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label}),r=e.entity.owner;if(void 0!==r){var i=r.valueFromId(e.ownerId);t=a.createElement("div",null,"owner: ",Object(v.a)(i))}return a.createElement(l.Page,{header:n},t,a.createElement(c.List,{items:e.controller.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow,key:e.rowKey},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.rowContent=this.ui.rowContent||p.c,void 0!==this.entity.owner&&(this.ownerId=Number(t)),[4,this.controller.searchMain("")];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){void 0!==this.onSelected?this.onSelected(t):alert("onSelect is undefined")},e}(s.b)),w=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.onSelected=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.event("edit",t.id),[2]})})}}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.searchMain(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,e){return a.createElement("div",{className:"px-3 py-2"},Object(v.a)(t))},e.clickRow=function(t){e.callOnSelected(t)},e.view=Object(f.a)(function(){var t,n=a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label}),r=e.entity.owner;if(void 0!==r){var i=r.valueFromId(e.ownerId);t=a.createElement("div",null,"owner: ",Object(v.a)(i))}return a.createElement(l.Page,{header:n},t,a.createElement(c.List,{items:e.controller.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))}),e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.entity.owner&&(this.ownerId=Number(t)),[4,this.controller.searchMain("")];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){void 0!==this.onSelected?this.onSelected(t):alert("onSelect is undefined")},e}(s.b)),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.buildPageItems=function(){return new y(this.entity.owner||this.entity)},e.prototype.searchMain=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0===t?[3,2]:[4,this.PageItems.first(t)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.getDivItems=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.searchArr(t,void 0,0,1e3)];case 1:return[2,e.sent()]}})})},e}(s.a)),E=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,i)||this;if(void 0!==o.proxies)for(var s in o.proxyLinks=[],o.proxies){var a=o.cUq.linkFromName("tuid",s);o.proxyLinks.push(a)}return o}return r.d(e,t),e.prototype.from=function(){var t=this.entity.cFrom();return void 0===t?this:t},e.prototype.cUqFrom=function(){return this.entity.cUqFrom()},e.prototype.cEditFrom=function(){return this.entity.cUqFrom().cTuidEditFromName(this.entity.name)},e.prototype.cInfoFrom=function(){return this.entity.cUqFrom().cTuidInfoFromName(this.entity.name)},e.prototype.cSelectFrom=function(){return this.entity.cUqFrom().cTuidSelectFromName(this.entity.name)},e.prototype.getLable=function(t){if(t===this.entity)return this.label;var e=t.name,n=this.res.arrs;if(void 0!==n){var r=n[e];if(void 0!==r){var i=r.label;if(void 0!==i)return i}}return e},Object.defineProperty(e.prototype,"VTuidMain",{get:function(){return h},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VTuidEdit",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VTuidList",{get:function(){return g},enumerable:!0,configurable:!0}),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidMain)];case 1:return t.sent(),[2]}})})},e.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:switch(t){case"new":return[3,2];case"list":return[3,4];case"edit":return[3,6];case"item-changed":return[3,8];case"info":return[3,9]}return[3,1];case 1:return[2];case 2:return[4,this.onNew()];case 3:return n.sent(),[3,11];case 4:return[4,this.onList()];case 5:return n.sent(),[3,11];case 6:return[4,this.onEdit(e)];case 7:return n.sent(),[2];case 8:return this.itemChanged(e),[2];case 9:return[4,new S(this.cUq,this.entity,this.ui,this.res).start(e)];case 10:return n.sent(),[2];case 11:return[2]}})})},e.prototype.edit=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return void 0!==(e=this.ui&&this.ui.CTuidEdit)?[3,2]:[4,this.openVPage(this.VTuidEdit,t)];case 1:return n.sent(),[3,4];case 2:return[4,new e(this.cUq,this.entity,this.ui,this.res).start(t)];case 3:n.sent(),n.label=4;case 4:return[2]}})})},e.prototype.onNew=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.edit(void 0)];case 1:return t.sent(),[2]}})})},e.prototype.onList=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return void 0!==(t=this.ui&&this.ui.CTuidList)?[3,2]:[4,this.openVPage(this.VTuidList,void 0)];case 1:return e.sent(),[3,4];case 2:return[4,new t(this.cUq,this.entity,this.ui,this.res).start(void 0)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype.onEdit=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return e=void 0,void 0===t?[3,2]:[4,this.entity.load(t)];case 1:e=n.sent(),n.label=2;case 2:return this.edit(e),[2]}})})},e.prototype.itemChanged=function(t){var e=t.id,n=t.values;if(void 0!==this.PageItems){var r=this.PageItems.items.find(function(t){return t.id===e});void 0!==r&&o.a.merge(r,n)}},e}(w),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidMain)];case 1:return t.sent(),[2]}})})},e}(E),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,"number"!==typeof t?[3,2]:[4,this.onEdit(t)];case 1:return e.sent(),[3,4];case 2:return[4,this.edit(t)];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype.edit=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VTuidEdit,t)];case 1:return e.sent(),[2]}})})},e}(E),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidList)];case 1:return t.sent(),[2]}})})},e}(E),N=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return alert("tuid div: "+this.entity.name),[2]})})}}(w),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VTuidSelect,t)];case 1:return e.sent(),[2]}})})},e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.loadSchema()];case 1:return t.sent(),void 0!==this.PageItems&&this.PageItems.reset(),[2,!0]}})})},Object.defineProperty(e.prototype,"VTuidSelect",{get:function(){return m},enumerable:!0,configurable:!0}),e.prototype.idFromItem=function(t){return t.id},e}(w)),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.entity.load(t)];case 1:return e=n.sent(),[4,this.openVPage(this.VTuidInfo,e)];case 2:return n.sent(),[2]}})})},Object.defineProperty(e.prototype,"VTuidInfo",{get:function(){return b},enumerable:!0,configurable:!0}),e}(w);n.d(e,"d",function(){return k}),n.d(e,"a",function(){return C}),n.d(e,"c",function(){return P}),n.d(e,"e",function(){return N}),n.d(e,"b",function(){return S})},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return s});var r=n(8),i=n.n(r),o={lang:void 0,district:void 0};function s(t){var e=o.lang,n=o.district,r={};if(void 0===t)return r;i.a.merge(r,t._);var s=t[e];if(void 0===s)return r;i.a.merge(r,s._);var a=s[n];if(void 0===a)return r;i.a.merge(r,a);var u=r.entity;if(void 0!==u)for(var c in u)u[c.toLowerCase()]=u[c];return r}!function(){var t,e,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");t=r[0],r.length>1&&(e=r[1])}else t="zh",e="CN";!function(t,e){o.lang=t,o.district=e}(t,e)}()},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n.n(i),s=n(5),a=function(){function t(t){this.view=function(){return i.createElement("div",null)},this.label=t}return t.prototype.render=function(){return i.createElement("div",{key:this.key,className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.label),i.createElement("div",{className:"col-sm-10"},this.renderContent())))},t.prototype.setAddRow=function(t){},Object.defineProperty(t.prototype,"key",{get:function(){return this.label},enumerable:!0,configurable:!0}),t.prototype.getVFields=function(){},t.prototype.getVArr=function(){},t.prototype.getVSubmit=function(){},t.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"content")},t}(),u=function(t){function e(e,n){var r=t.call(this,e)||this;return r.vField=n,r}return r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this.vField.name},enumerable:!0,configurable:!0}),e.prototype.getVFields=function(){return[this.vField]},e.prototype.renderContent=function(){return this.vField.render()},e}(a),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.vArr=n,r}return r.d(e,t),e.prototype.setAddRow=function(t){this.vArr.setAddRow(t)},Object.defineProperty(e.prototype,"key",{get:function(){return this.vArr.name},enumerable:!0,configurable:!0}),e.prototype.getVArr=function(){return this.vArr},e.prototype.render=function(){return i.createElement(i.Fragment,{key:this.key},this.vArr&&this.vArr.render())},e}(a),l=(function(t){function e(e,n){var r=t.call(this,e)||this;return r.vFields=n,r}r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this.vFields[0].name},enumerable:!0,configurable:!0}),e.prototype.getVFields=function(){return this.vFields},e.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"fields")}}(a),function(t){function e(e){var n=t.call(this,void 0)||this;return n.vSubmit=e,n}return r.d(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return"$submit"},enumerable:!0,configurable:!0}),e.prototype.getVSubmit=function(){return this.vSubmit},e.prototype.render=function(){return i.createElement("div",{key:"$submit",className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"offset-sm-2 col-sm-10"},this.vSubmit.render())))},e}(a)),h=n(11),d=n(4),p=function(t){function e(e){var n=t.call(this)||this;return n.onClickSubmit=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){return this.vForm.submit(),[2]})})},n.view=Object(s.a)(function(){var t=n.vForm.isOk;return i.createElement("button",{type:"button",onClick:n.onClickSubmit,className:n.className,disabled:!1===t},n.caption)}),n.vForm=e,n.caption=n.vForm.submitCaption,n.className="btn btn-primary w-25",n}return r.d(e,t),r.c([d.l],e.prototype,"caption",void 0),r.c([d.l],e.prototype,"className",void 0),e}(h.d),f=n(6),m=n.n(f),v=n(3),b=function(){return function(){}}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){switch(typeof e){default:case"boolean":return;case"object":if(null!==e)return;break;case"string":if(e.trim().length>0)return;break;case"number":if(NaN!==e)return;break;case"undefined":}t.push("\u4e0d\u80fd\u4e3a\u7a7a")},e}(b),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){void 0!==e&&null!==e&&(NaN===Number(e)&&t.push("\u5fc5\u987b\u662f\u6570\u5b57"))},e}(b),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){if(void 0!==e&&null!==e){var n=Number(e);!0!==Number.isNaN(n)&&!1!==Number.isInteger(n)||t.push("\u5fc5\u987b\u662f\u6574\u6570")}},e}(b),E=function(t){function e(e){var n=t.call(this)||this;return n.min=e,n}return r.d(e,t),e.prototype.check=function(e,n){t.prototype.check.call(this,e,n),Number(n)<this.min&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.min)},e}(g),k=function(t){function e(e){var n=t.call(this)||this;return n.max=e,n}return r.d(e,t),e.prototype.check=function(e,n){t.prototype.check.call(this,e,n),Number(n)>this.max&&e.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.max)},e}(g),C=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.form=e,o.field=n,o.name=n.name,o.fieldUI=r||{},o.fieldRes=i||{},o.init(),o}return r.d(e,t),e.prototype.init=function(){this.buildRules()},e.prototype.buildRules=function(){this.rules=[],(!0===this.fieldUI.required||void 0!==this.field&&!1===this.field.null)&&this.rules.push(new y)},Object.defineProperty(e.prototype,"checkRules",{get:function(){for(var t=[],e=0,n=this.rules;e<n.length;e++){n[e].check(t,this.value)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOk",{get:function(){return 0===this.rules.length||0===this.checkRules.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.form.values[this.name]},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){this.form.values[this.name]=t},Object.defineProperty(e.prototype,"error",{get:function(){return this.form.errors[this.name]},set:function(t){this.form.errors[this.name]=t},enumerable:!0,configurable:!0}),e.prototype.parse=function(t){return t},Object.defineProperty(e.prototype,"readonly",{get:function(){var t=this.form.mode;return t===q.readonly||t===q.edit&&!1===this.fieldUI.editable},enumerable:!0,configurable:!0}),r.c([d.e],e.prototype,"checkRules",null),r.c([d.e],e.prototype,"isOk",null),r.c([d.e],e.prototype,"value",null),e}(h.d),P=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return i.createElement("input",{type:"text",className:"form-control form-control-plaintext border border-info rounded bg-light",placeholder:"unkown control: -"})},e}r.d(e,t)}(C),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderError=function(t){var n=e.form.errors[e.name];if(void 0!==n)return i.createElement("div",{className:t},i.createElement(v.FA,{name:"exclamation-circle"})," ",n)},e.ref=function(t){e.input=t,e.setInputValue()},e.onFocus=function(){e.error=void 0},e.onBlur=function(){var t=e.checkRules;t.length>0&&(e.error=t[0]),e.form.computeFields()},e.onChange=function(t){var n=e.parse(t.currentTarget.value);null!==n&&e.setValue(n)},e.view=Object(s.a)(function(){var t,n,r,o=e.fieldUI.required,s=e.fieldRes,a=s.placeHolder,u=s.suffix,c=["form-control","form-control-input"];return!0===e.readonly?n=i.createElement("input",{className:m()(c,"bg-light"),ref:e.ref,type:e.inputType,readOnly:!0}):(n=i.createElement("input",{className:m()(c),ref:e.ref,type:e.inputType,onFocus:e.onFocus,onBlur:e.onBlur,onChange:e.onChange,placeholder:a,readOnly:!1,maxLength:e.maxLength,onKeyPress:e.onKeyPress}),!0!==o&&!1!==e.field.null||(t=i.createElement(N,null))),r=void 0===u?n:i.createElement("div",{className:"input-group"},n,i.createElement("div",{className:"input-group-append"},i.createElement("span",{className:"input-group-text"},u))),i.createElement(i.Fragment,null,t,r,e.renderError("text-danger small mt-1 mx-2"))}),e}return r.d(e,t),Object.defineProperty(e.prototype,"maxLength",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e){t.prototype.setValue.call(this,e),this.setInputValue()},e.prototype.setInputValue=function(){if(this.input){var t=this.value;this.input.value=null===t||void 0===t?"":t}},e}(C)),N=function(){return i.createElement("b",{style:{color:"red",position:"absolute",left:"0.1em",top:"0.5em"}},"*")},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="text",e}return r.d(e,t),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this.field.size},enumerable:!0,configurable:!0}),e}(P),x=45,F=46,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e.onKeyPress=function(t){var n=t.charCode;if(!(8===n||0===n||13===n||n>=48&&n<=57))if(void 0!==e.extraChars&&e.extraChars.indexOf(n)>=0)switch(n){case F:e.onKeyDot();break;case x:e.onKeyNeg(),t.preventDefault()}else t.preventDefault()},e}return r.d(e,t),e.prototype.init=function(){if(t.prototype.init.call(this),this.extraChars=[],void 0!==this.fieldUI){var e=this.fieldUI,n=e.min;e.max;void 0!==n?n<0&&this.extraChars.push(x):this.extraChars.push(x)}switch(this.field.type){case"dec":case"bigint":case"int":case"smallint":case"tinyint":this.extraChars.push(F)}},e.prototype.buildRules=function(){t.prototype.buildRules.call(this),this.rules.push(new g);var e=this.fieldUI,n=e.min,r=e.max;void 0!==n&&this.rules.push(new E(n)),void 0!==r&&this.rules.push(new k(r))},e.prototype.parse=function(t){try{if(0===t.trim().length)return;var e=Number(t);return NaN===e?null:e}catch(n){return null}},e.prototype.setInputValue=function(){if(this.input){var t=this.value;this.parse(this.input.value)!=t&&(this.input.value=null===t||void 0===t?"":t)}},e.prototype.onKeyDot=function(){var t=this.input.value;t.indexOf(".")>=0&&(this.input.value=t.replace(".",""))},e.prototype.onKeyNeg=function(){var t=this.input.value,e=t.indexOf("-");t=e>=0?t.replace("-",""):"-"+t,this.input.value=t},e}(P),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.buildRules=function(){t.prototype.buildRules.call(this),this.rules.push(new w)},e}(T),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(T),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(S),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(S),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(S);var q,R=function(t){function e(e,n,r){var i=t.call(this,e,n,void 0,r)||this;return i.view=Object(s.a)(function(){var t=i.form.values[i.field.name],e=i.fieldRes,n=e.placeHolder,r=e.suffix;null===t&&(t="");var s=o.a.createElement("input",{className:"form-control form-control-input bg-light",type:"text",placeholder:n,readOnly:!0,value:t});return void 0===r?s:o.a.createElement("div",{className:"input-group"},s,o.a.createElement("div",{className:"input-group-append"},o.a.createElement("span",{className:"input-group-text"},r)))}),i}return r.d(e,t),e}(C),L=n(8),D=n.n(L),U=n(2),M=function(t){function e(e,n,o){var s=t.call(this)||this;s.rowPage=function(){return i.createElement(U.Page,{header:s.label,back:"close"},s.vForm.render("py-3"))},s.onSubmit=function(){return r.b(s,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this.vForm.valueBoxs,[4,this.onRowChanged(t)];case 1:return e.sent(),[2]}})})},s.onRowChanged=function(t){return r.b(s,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.rowValues?[3,4]:(t.$owner=this.ownerForm.values,this.list.push(t),void 0!==this.onEditRow?[3,1]:(this.vForm.reset(),[3,3]));case 1:return[4,this.onEditRow(void 0,this.onRowChanged)];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:D.a.merge(this.rowValues,t),void 0===this.onEditRow&&U.nav.pop(),e.label=5;case 5:return[2]}})})},s.renderItem=function(t,e){return void 0===s.rowContent?i.createElement("div",{className:"px-3 py-2"},i.createElement(h.a,r.a({},t))):i.createElement(s.rowContent,r.a({},t))},s.showRow=function(t){return r.b(s,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.onEditRow?[3,2]:[4,this.onEditRow(t,this.onRowChanged)];case 1:return e.sent(),[2];case 2:return this.vForm.reset(),void 0!==t&&this.vForm.setValues(t),U.nav.push(i.createElement(this.rowPage,null)),[2]}})})},s.editRow=function(t){return r.b(s,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return this.rowValues=t,void 0!==(e=this.vForm.vSubmit)&&(e.caption=this.editSubmitCaption,e.className="btn btn-outline-success"),this.vForm.mode=this.ownerForm.mode,[4,this.showRow(t)];case 1:return n.sent(),[2]}})})},s.internalAddRow=function(){return r.b(s,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return this.rowValues=void 0,(t=this.vForm.vSubmit).caption=this.newSubmitCaption,t.className="btn btn-outline-success",this.vForm.reset(),this.vForm.mode=q.new,[4,this.showRow(void 0)];case 1:return e.sent(),[2]}})})},s.view=function(){var t;void 0===s.addRow&&s.mode===q.readonly||(t=i.createElement("button",{onClick:s.addRow||s.internalAddRow,type:"button",className:"btn btn-link p-0"},s.ownerForm.arrTitleNewButton));var e=s.header||i.createElement("div",{className:"px-3 bg-light small",style:{paddingTop:"1px",paddingBottom:"1px"}},i.createElement("div",{className:"flex-fill align-self-center"},s.label),t);return i.createElement(v.List,{className:"pb-3",header:e,none:i.createElement(v.Muted,{className:"px-3 py-2"},s.none),items:s.list,item:{render:s.renderItem,onClick:s.editRow}})},s.ownerForm=e;var a=n.name,u=n.fields;s.name=a;var c=e.ui,l=e.res,d=e.mode,p=e.inputs,f=e.values,m=l.arrs,b=void 0!==m?m[a]:{},y=b.label,g=b.none,w=b.newSubmit,E=b.editSubmit;s.none=g||e.none,s.newSubmitCaption=w||e.arrNewCaption,s.editSubmitCaption=E||e.arrEditCaption,s.label=y||a;var k=c&&c.items[a]||{};return s.rowContent=k.rowContent,s.mode=d,void 0===s.onEditRow?s.vForm=new W({fields:u,arrs:void 0,ui:k,res:b,inputs:p[a],none:e.none,submitCaption:"submit",arrNewCaption:void 0,arrEditCaption:void 0,arrTitleNewButton:void 0,mode:d},d===q.readonly?void 0:s.onSubmit):s.onEditRow=o,s.list=f[a],s}return r.d(e,t),e.prototype.reset=function(){this.vForm.reset(),this.list.clear()},e.prototype.setAddRow=function(t){this.addRow=t},e}(h.d),B=n(12),_={textAlign:"left",paddingLeft:"0.75rem",paddingRight:"0.75rem",overflow:"hidden"},H=function(t){function e(e,n,o,a){var u=t.call(this,e,n,o,a)||this;return u.onClick=function(){return r.b(u,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return!0!==this.readonly?[3,2]:this.value?[4,this.tuid.showInfo(this.value.id)]:[2];case 1:return e.sent(),[2];case 2:return void 0===this.input?[3,4]:[4,this.input.select(this.vForm,this.field,this.vForm.getValues())];case 3:return t=e.sent(),[3,5];case 4:alert("call undefined"),t=0,e.label=5;case 5:return this.setValue(this.tuid.boxId(t)),[2]}})})},u.view=Object(s.a)(function(){var t,e,n=u.fieldRes.placeHolder,r=!1,o=u.field._ownerField;if(void 0!==o){var s=o.name;o.arr;r=null===u.vForm.getValue(s)}if(null===u.value)t=i.createElement(i.Fragment,null,n||u.input.placeHolder);else if("object"===typeof u.value)t=Object(B.b)(u.value);else{var a=u.tuid.boxId(u.value);t=Object(B.b)(a)}return!0===u.readonly?i.createElement("div",{className:"form-control form-control-plaintext border border-info rounded bg-light cursor-pointer",onClick:u.onClick},t):(!0!==u.fieldUI.required&&!1!==u.field.null||(e=i.createElement(N,null)),i.createElement(i.Fragment,null,e,i.createElement("button",{className:"form-control btn btn-outline-info",type:"button",disabled:r,style:_,onClick:u.onClick},t)))}),u.tuid=n._tuid,u.vForm=e,u.input=e.inputs[n.name],u}return r.d(e,t),e}(C),$=function(){function t(t,e,n){this.vForm=t,this.onSubmit=n;var r=e.fields,i=e.arrs,o=e.ui,s=e.res;if(this.fields=r,this.arrs=i,void 0!==o){var a=o.items,u=o.layout;this.formItems=a,this.layout=u}this.res=s}return t.prototype.build=function(){return void 0===this.layout?this.bandsOnFly():this.bandsFromLayout()},t.prototype.resFromName=function(t,e){if(void 0!==e){var n=e.fields;if(void 0!==n)return n[t]||t}},t.prototype.bandsOnFly=function(){var t=[];if(this.bandsFromFields(t,this.fields,this.res),void 0!==this.arrs)for(var e=0,n=this.arrs;e<n.length;e++){var r=n[e];t.push(this.bandFromArr(r))}return void 0!==this.onSubmit&&t.push(new l(new p(this.vForm))),t},t.prototype.bandsFromFields=function(t,e,n){if(void 0!==e)for(var r=0,i=e;r<i.length;r++){var o=i[r];t.push(this.bandFromField(o,n))}},t.prototype.bandsFromLayout=function(){return[]},t.prototype.bandFromField=function(t,e){var n,r,i,o,s=t.name,a=this.resFromName(s,e);return"object"===typeof a?(r=a.label,n=a):(r=a,n=void 0),void 0!==this.formItems&&(o=this.formItems[s]),void 0===(i="function"===typeof o?new R(this.vForm,t,n):function(t,e,n,r){var i;switch(e.type){default:return;case"tinyint":case"smallint":case"int":i=O;break;case"bigint":if(void 0!==e._tuid)return;i=O;break;case"dec":i=V;break;case"char":i=S;break;case"text":i=I;break;case"datetime":i=A;break;case"date":i=j}return new i(t,e,n,r)}(this.vForm,t,o,n))&&(i=new H(this.vForm,t,o,n)),new u(r||s,i)},t.prototype.bandFromArr=function(t){var e=t.name,n=(t.fields,new M(this.vForm,t));return new c(e,n)},t}();!function(t){t[t.new=0]="new",t[t.edit=1]="edit",t[t.readonly=2]="readonly"}(q||(q={}));var W=function(){function t(t,e){var n=this;this.vFields={},this.vArrs={},this.onFormSubmit=function(t){return t.preventDefault(),!1},this.view=Object(s.a)(function(t){var e=t.className;return i.createElement("form",{className:e,onSubmit:n.onFormSubmit},n.bands.map(function(t){return t.render()}))});var r=t.fields,o=t.arrs,a=t.ui,u=t.res,c=t.inputs,l=t.none,h=t.submitCaption,d=t.arrNewCaption,p=t.arrEditCaption,f=t.arrTitleNewButton,m=t.mode;this.fields=r,this.arrs=o,this.ui=a,void 0!==this.ui&&(this.formItems=this.ui.items),this.res=u,this.inputs=c,this.none=l,this.submitCaption=h,this.arrNewCaption=d,this.arrEditCaption=p,this.arrTitleNewButton=f||i.createElement("small",null,i.createElement(v.FA,{name:"plus"})," \u65b0\u589e"),this.mode=void 0===e?q.readonly:m,this.buildFormValues(),this.buildBands(t,e),this.onSubmit=e}return t.prototype.buildBands=function(t,e){this.bandColl={};var n=new $(this,t,e);this.bands=n.build();for(var r=0,i=this.bands;r<i.length;r++){var o=i[r];this.bandColl[o.key]=o;var s=o.getVFields();if(void 0!==s)for(var a=0,u=s;a<u.length;a++){var c=u[a];this.vFields[c.name]=c}var l=o.getVArr();void 0!==l&&(this.vArrs[l.name]=l);var h=o.getVSubmit();void 0!==h&&(this.vSubmit=h)}},t.prototype.getBand=function(t){return this.bandColl[t]},t.prototype.computeFields=function(){if(void 0!==this.formItems){var t=this.values;for(var e in this.formItems){var n=this.formItems[e];"function"===typeof n&&(t[e]=n.call(this,t))}}},t.prototype.submit=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0===this.onSubmit?[2]:[4,this.onSubmit()];case 1:return t.sent(),[2]}})})},t.prototype.getValues=function(){for(var t={},e=this.values,n=0,r=this.fields;n<r.length;n++){var i=e[u=r[n].name];t[u]=null!==i&&"object"===typeof i?i.id:i}if(void 0!==this.arrs)for(var o=0,s=this.arrs;o<s.length;o++)for(var a=s[o],u=a.name,c=a.fields,l=a.id,h=a.order,d=t[u]=[],p=0,f=this.vArrs[u].list;p<f.length;p++){var m=f[p],v={};void 0!==l&&(v[l]=m[l]),void 0!==h&&(v[h]=m[h]);for(var b=0,y=c;b<y.length;b++){var g=y[b].name;i=m[g];v[g]=null!==i&&"object"===typeof i?i.id:i}d.push(v)}return t},Object.defineProperty(t.prototype,"valueBoxs",{get:function(){for(var t={},e=this.values,n=0,r=this.fields;n<r.length;n++){var i=(v=r[n]).name,o=v._tuid,s=e[i];t[i]=void 0===o||"object"===typeof s?s:o.boxId(s)}if(void 0===this.arrs)return t;for(var a=0,u=this.arrs;a<u.length;a++)for(var c=u[a],l=(i=c.name,c.fields),h=(c.id,c.order,0),d=t[i]=this.vArrs[i].list.slice();h<d.length;h++)for(var p=d[h],f=0,m=l;f<m.length;f++){var v,b=(v=m[f]).name;o=v._tuid,s=p[b];p[b]=void 0===o||"object"===typeof s?s:o.boxId(s)}return t},enumerable:!0,configurable:!0}),t.prototype.setValues=function(t){if(void 0!==t){for(var e=this.values,n=this.errors,r=0,i=this.fields;r<i.length;r++){var o=i[r].name;n[o]=void 0;var s=t[o];e[o]=s}for(var a in this.vArrs){var u=t[a];if(void 0!==u){var c=e[a];c.clear(),c.push.apply(c,u)}}}else this.reset()},Object.defineProperty(t.prototype,"isOk",{get:function(){for(var t in this.vFields)if(!1===this.vFields[t].isOk)return!1;return!0},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t=this.values,e=this.errors,n=0,r=this.fields;n<r.length;n++){var i=r[n].name;t[i]=null,e[i]=void 0}for(var o in this.vFields){var s=this.vFields[o];void 0!==s.name&&s.setValue(null)}for(var o in this.vArrs){this.vArrs[o].reset()}},t.prototype.getValue=function(t){return this.values[t]},t.prototype.setValue=function(t,e){this.values[t]=e},t.prototype.setError=function(t,e){this.errors[t]=e},t.prototype.buildFieldValues=function(t){for(var e={valueFromFieldName:function(t){return this[t]}},n=0,r=t;n<r.length;n++){e[r[n].name]=null}return e},t.prototype.buildObservableValues=function(){var t=this.buildFieldValues(this.fields);if(void 0!==this.arrs)for(var e=0,n=this.arrs;e<n.length;e++){t[n[e].name]=d.l.array([],{deep:!0})}return Object(d.l)(t)},t.prototype.buildFormValues=function(){this.values=this.buildObservableValues(),this.errors=Object(d.l)(this.buildFieldValues(this.fields))},t.prototype.render=function(t){return void 0===t&&(t="py-3"),i.createElement(this.view,{className:t})},r.c([d.e],t.prototype,"isOk",null),t}();n.d(e,"a",function(){return q}),n.d(e,"b",function(){return W})},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(15),o=n(9),s=n(22);var a=function(){function t(t,e,n,i){var o=this;this.startWait=function(){void 0!==o.ui&&o.ui.startWait()},this.endWait=function(t,e){void 0!==o.ui&&o.ui.endWait(),void 0!==e&&e("\u8bbf\u95eewebapi\u8d85\u65f6 "+t)},this.showError=function(t){return r.b(o,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.ui?[3,2]:[4,this.ui.showError(t)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},this.isCenter=t,this.hostUrl=e,this.apiToken=n,this.ui=i,this.timeout=!0===s.b?5e5:5e3}return t.prototype.used=function(){this.post("",{})},t.prototype.get=function(t,e){return void 0===e&&(e=void 0),r.b(this,void 0,Promise,function(){var n,i,o,s,a,u;return r.e(this,function(r){switch(r.label){case 0:if(e&&(n=Object.keys(e)).length>0)for(i="?",o=0,s=n;o<s.length;o++)a=s[o],void 0!==e[a]&&(t+=i+a+"="+e[a],i="&");return(u=this.buildOptions()).method="GET",[4,this.innerFetch(t,u)];case 1:return[2,r.sent()]}})})},t.prototype.post=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="POST",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.put=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="PUT",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.delete=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="DELETE",n.body=JSON.stringify(e),[4,this.innerFetch(t,n)];case 1:return[2,r.sent()]}})})},t.prototype.fetch=function(t,e,n,i){return r.b(this,void 0,Promise,function(){function s(t){return{channel:a,url:u,options:e,resolve:n,reject:i,error:t}}var a,u,c,l,h,d,p,f=this;return r.e(this,function(m){switch(m.label){case 0:a=this,this.startWait(),u=t,m.label=1;case 1:return m.trys.push([1,6,,8]),console.log("%s %s",e.method,u),c=setTimeout(function(){return a.endWait(t,i)},this.timeout),[4,fetch(encodeURI(u),e)];case 2:if(!1===(l=m.sent()).ok)throw clearTimeout(c),a.endWait(),console.log("call error %s",l.statusText),l.statusText;return(h=l.headers.get("content-type"))&&h.indexOf("json")>=0?[2,l.json().then(function(t){return r.b(f,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return clearTimeout(c),a.endWait(),!0===t.ok?[2,n(t.res)]:void 0!==t.error?[3,2]:[4,a.showError(s("not valid tonva json"))];case 1:return e.sent(),[3,4];case 2:return[4,a.showError(s(t.error))];case 3:e.sent(),i(t.error),e.label=4;case 4:return[2]}})})}).catch(function(t){return r.b(f,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,a.showError(s(t.message))];case 1:return e.sent(),[2]}})})})]:[3,3];case 3:return[4,l.text()];case 4:d=m.sent(),clearTimeout(c),a.endWait(),n(d),m.label=5;case 5:return[3,8];case 6:return"string"===typeof(p=m.sent())&&!0===p.toLowerCase().startsWith("unauthorized")?(o.c.logout(),[2]):[4,this.showError(s(p.message))];case 7:return m.sent(),[3,8];case 8:return[2]}})})},t.prototype.innerFetch=function(t,e){return r.b(this,void 0,Promise,function(){var n,o=this;return r.e(this,function(s){switch(s.label){case 0:return n=this.hostUrl+t,!0===this.isCenter&&void 0===this.apiToken&&Object(i.g)()?[4,Object(i.d)(n,e.method,e.body)]:[3,2];case 1:return[2,s.sent()];case 2:return[4,new Promise(function(t,i){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(n,e,t,i)];case 1:return r.sent(),[2]}})})})];case 3:return[2,s.sent()]}})})},t.prototype.callFetch=function(t,e,n){return r.b(this,void 0,Promise,function(){var i,o=this;return r.e(this,function(s){switch(s.label){case 0:return(i=this.buildOptions()).method=e,i.body=n,[4,new Promise(function(e,n){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(t,i,e,n)];case 1:return r.sent(),[2]}})})})];case 1:return[2,s.sent()]}})})},t.prototype.buildOptions=function(){var t=o.c.language,e=o.c.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=t;return e&&(r+="-"+e),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),{headers:n}},t}()},,function(t,e,n){"use strict";var r=n(41);n.d(e,"CApp",function(){return r.a});n(76),n(48),n(50),n(25),n(47),n(36),n(49),n(52),n(51);var i=n(11);n.d(e,"PureJSONContent",function(){return i.b});n(27);var o=n(77);n.o(o,"tv")&&n.d(e,"tv",function(){return o.tv});n(45),n(7),n(17),n(44)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(4),s=function(){function t(t){this.formView=t}return t.prototype.render=function(){return i.createElement("div",{className:"col-sm-10"},this.renderControl())},Object.defineProperty(t.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.clear=function(){},t.prototype.clearErrors=function(){},t.prototype.readValues=function(t){},t.prototype.setError=function(t,e){},t.prototype.setInitValues=function(t){},t.prototype.isOk=function(){return this.validate(),!this.hasError},t.prototype.validate=function(){},r.c([o.e],t.prototype,"hasError",null),r.c([o.e],t.prototype,"filled",null),t}(),a=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.field=n,i.face=r,i.init(),i.setProps(),i}return r.d(e,t),e.prototype.ref=function(t){this.element=t},e.prototype.init=function(){var t;this.rules=[];var e=this.field.rules;void 0!==e&&(!0===Array.isArray(e)?(t=this.rules).push.apply(t,e):this.rules.push(e))},e.prototype.setProps=function(){return this.props={ref:this.ref.bind(this),name:this.field.name}},Object.defineProperty(e.prototype,"hasError",{get:function(){return void 0!==this.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return void 0!==this.value&&this.value!==this.field.defaultValue},enumerable:!0,configurable:!0}),e.prototype.clearValue=function(){this.value=void 0},e.prototype.clear=function(){this.clearErrors(),this.clearValue()},e.prototype.clearErrors=function(){this.isOK=void 0,this.error=void 0},e.prototype.readValues=function(t){t[this.field.name]=this.value},e.prototype.setError=function(t,e){},e.prototype.setInitValues=function(t){},e.prototype.getValueFromElement=function(){return this.value},e.prototype.validate=function(){try{var t=this.getValueFromElement();if(this.rules.length>0){for(var e=void 0,n=0,r=this.rules;n<r.length;n++){var i=r[n];console.log("validate: %s",t);var o=i(t);if(console.log("validate: %s err: %s",t,o),!0===o)this.error=void 0,e=!0;else if(void 0!==o)return this.error=o,void(this.isOK=!1)}this.isOK=e}this.value=t}catch(s){this.error=s.message}},e.prototype.render=function(){var t;if(void 0!==this.face){var e=this.face.notes;void 0!==e&&(t=i.createElement("small",{className:"text-muted"},e))}return i.createElement("div",{className:"col-sm-10"},this.renderControl(),t)},r.c([o.l],e.prototype,"isOK",void 0),r.c([o.l],e.prototype,"error",void 0),r.c([o.l],e.prototype,"value",void 0),r.c([o.e],e.prototype,"hasError",null),r.c([o.e],e.prototype,"filled",null),e}(s),u=function(t){function e(e){var n=t.call(this,e)||this;return n.otherClick=n.otherClick.bind(n),n}return r.d(e,t),e.prototype.otherClick=function(){var t=this.formView.props.onOther;void 0!==t&&t(this.formView.readValues())},e.prototype.renderControl=function(){console.log("buttons.renderControl");var t=this.formView.nothing,e=this.formView.hasError,n=this.formView.props;console.log("buttons.renderControl nothing:%s hasError:%s",t,e);var r,o=n.submitButton,s=n.otherButton;n.onOther;return void 0!==s&&(r=i.createElement("button",{className:"btn btn-outline-info ml-auto",onClick:this.otherClick},s)),i.createElement("div",{className:"d-flex justify-content-start"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:t||e},o||"\u63d0\u4ea4"),r)},e}(s),c=n(8),l=n(6),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.init=function(){t.prototype.init.call(this),!0===this.field.required&&this.rules.push(function(t){return null!==t&&void 0!==t&&0!==t.trim().length||"\u5fc5\u987b\u586b\u5165\u8981\u6c42\u5185\u5bb9"})},e.prototype.getValueFromElement=function(){return this.parseValue(this.element.value)},e.prototype.setProps=function(){t.prototype.setProps.call(this),c.assign(this.props,{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)});var e=this.face;return void 0!==e&&c.assign(this.props,{placeholder:e.placeholder}),this.props},e.prototype.parseValue=function(t){return t},e.prototype.onBlur=function(){this.validate()},e.prototype.onChange=function(){console.log("onChange"),this.validate()},e.prototype.onFocus=function(){this.clearErrors()},e.prototype.className=function(){return l({"form-control":!0,"has-success":!0===this.isOK,"is-invalid":void 0!==this.error,"is-valid":void 0===this.error&&!0===this.isOK})},e.prototype.renderInput=function(){return i.createElement("input",r.a({className:this.className()},this.props))},e.prototype.ref=function(e){t.prototype.ref.call(this,e),e&&(e.value=void 0===this.value?"":this.value)},e.prototype.renderError=function(){return void 0===this.error?null:i.createElement("div",{className:"invalid-feedback"},this.error)},e.prototype.clearValue=function(){t.prototype.clearValue.call(this),this.element.value=""},e.prototype.setError=function(t,e){this.field.name===t&&(this.error=e)},e.prototype.setInitValues=function(t){var e=t[this.field.name];void 0!==e&&(this.value=e)},e.prototype.renderControl=function(){return i.createElement(i.Fragment,null,this.renderInput(),this.renderError())},e}(a),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this);return c.assign(e,{type:"text",maxLength:this.field.maxLength}),e},e.prototype.parseValue=function(t){if(void 0!==t&&0!==t.trim().length)return t},e}(h),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this);return c.assign(e,{type:"password",maxLength:this.field.maxLength}),e},e}(d),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.extraChars=[];var e=this.field,n=e.min,r=e.max;switch(void 0!==n?(this.rules.push(function(t){if(void 0!==t)return!(t<n)||"\u6700\u5c0f\u503c\u4e3a"+n}),n<0&&this.extraChars.push(45)):this.extraChars.push(45),void 0!==r&&this.rules.push(function(t){if(void 0!==t)return!(t>r)||"\u6700\u5927\u503c\u4e3a"+r}),this.field.type){case"dec":case"number":this.extraChars.push(46)}},e.prototype.parseValue=function(t){if(void 0!==t&&0!==t.trim().length){var e=Number.parseFloat(t);if(isNaN(e))throw new Error("\u65e0\u6548\u7684\u6570\u5b57");return e}},e.prototype.setProps=function(){t.prototype.setProps.call(this),c.assign(this.props,{type:"number",step:this.field.step,onKeyPress:this.onKeyPress.bind(this)})},e.prototype.onKeyPress=function(t){var e=t.charCode;if(!(8===e||0===e||13===e||e>=48&&e<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(e)>=0)switch(e){case 46:this.onKeyDot();break;case 45:this.onKeyNeg(),t.preventDefault()}else t.preventDefault()},e.prototype.onKeyDot=function(){var t=this.element.value;t.indexOf(".")>=0&&(this.element.value=t.replace(".",""))},e.prototype.onKeyNeg=function(){var t=this.element.value,e=t.indexOf("-");t=e>=0?t.replace("-",""):"-"+t,this.element.value=t},e}(h),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.field,n=e.trueValue,r=e.falseValue;void 0===n&&(this.trueValue=1),void 0===r&&(this.falseValue=0)},e.prototype.setProps=function(){t.prototype.setProps.call(this),c.assign(this.props,{onChange:this.onChange.bind(this)})},e.prototype.clearValue=function(){this.element.checked=this.field.defaultValue===this.trueValue,this.value=this.getValueFromElement()},e.prototype.setInitValues=function(t){var e=t[this.field.name];void 0===e&&(e=this.field.defaultValue)},e.prototype.getValueFromElement=function(){return this.element.checked?this.trueValue:this.falseValue},e.prototype.onChange=function(){this.value=this.getValueFromElement()},e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static"},i.createElement("label",{className:"form-control"},i.createElement("label",{className:"custom-control custom-checkbox mb-0"},i.createElement("input",{type:"checkbox",name:this.field.name,ref:this.props.ref,onChange:this.props.onChange,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},this.face.label))))},e}(a),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.renderControl=function(){var t=this;return i.createElement("div",{className:"form-control-static"},i.createElement("div",{className:"form-control"},this.face.list.map(function(e,n){var r;return"object"!==typeof e?r=e:(r=e.text,e.value),i.createElement("label",{key:n,className:"custom-control custom-radio w-25"},i.createElement("input",{type:"radio",name:t.field.name,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},r))})))},e}(a),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setProps=function(){var e=t.prototype.setProps.call(this),n=this.field.maxLength,r=this.face.rows;return c.assign(e,{maxLength:n,rows:r}),e},e.prototype.renderInput=function(){var t=this;return i.createElement("textarea",r.a({ref:function(e){t.el=e,void 0!==e&&(e.value="")},className:this.className()},this.props))},e}(h),y=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.ref=i.ref.bind(i),i}return r.d(e,t),e.prototype.getValueFromElement=function(){var t=this.element,e=(t.selectedIndex,t.selectedOptions[0].value);switch(this.field.type){case"number":e=Number(e);break;case"date":e=new Date(e);break;case"bool":"string"===typeof e&&(e="true"===e.toLowerCase())}return e},e.prototype.renderControl=function(){var t=this.face.list,e=[];return void 0===this.face.default&&e.push(i.createElement("option",{key:-1,value:void 0},"\u8bf7\u9009\u62e9")),e.push.apply(e,t.map(function(t,e){var n,r;return"object"!==typeof t?n=r=t:(n=t.text,r=t.value),i.createElement("option",{key:e,value:r},n)})),i.createElement("div",{className:"form-control-static"},i.createElement("select",{name:this.field.name,className:"form-control",ref:this.ref},e))},e}(a),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},i.createElement("div",{className:"alert alert-primary",role:"alert"},"don't know how to create control",i.createElement("br",null),"field: ",JSON.stringify(this.field)," must be object ",i.createElement("br",null),"face: ",JSON.stringify(this.face)," must be object ",i.createElement("br",null)))},e}(a),w=function(t){function e(e,n){var r=t.call(this,e)||this;return r.element=n,r}return r.d(e,t),e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},this.element)},e}(s),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return t=this.face,e=t.pick,n=t.fromPicked,[4,e(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(i=r.sent())?(this.value=void 0,[2]):void 0===n?(this.value=i.id,[2]):(o=n(i),s=o.id,a=o.caption,this.value=s,this.caption=a,[2])}})})},e.onPicked=function(t){e.value=t.id},e}return r.d(e,t),e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.controlContent=function(){var t=this.face,e=t.itemFromId,n=t.fromPicked,r=t.initCaption;if(void 0===this.value)return r||"\u8bf7\u9009\u62e9Id";if(void 0!==this.caption)return this.caption;if(void 0!==e&&void 0!==n){var i=e(this.value);if(i){var o=n(i);if(void 0!==o)return o.caption}}return String(this.value)},e.prototype.renderControl=function(){var t=this.face,e=t.tuid,n=t.input;return void 0===n?i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer",onClick:this.onClick},this.controlContent()):i.createElement("div",{className:"form-control-static "},i.createElement(n.component,{id:this.value,ui:e}))},r.c([o.l],e.prototype,"caption",void 0),e}(a),k=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.onIdChanged=i.onIdChanged.bind(i),i}return r.d(e,t),e.prototype.onIdChanged=function(t){this.value=t.id},e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.buildContent=function(){var t=this;return i.createElement(this.face.input.component,r.a({},this.face,{id:this.value,onFormValues:function(){return t.formView.readValues()},onIdChanged:this.onIdChanged}))},e.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static "},this.buildContent())},r.c([o.l],e.prototype,"caption",void 0),e}(a),C=n(5),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return t=this.face,e=t.pick,n=t.fromPicked,[4,e(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(i=r.sent())?(this.value=void 0,[2]):(o=n(i),s=o.id,a=o.caption,this.value=s,this.caption=a,[2])}})})},e.view=Object(C.a)(function(){var t,n=e.face.content;return t=void 0===e.value||null===e.value?"\u8bf7\u9009\u62e9":i.createElement(n,{id:e.value}),i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer bg-light",onClick:e.onClick},t)}),e}return r.d(e,t),e.prototype.setInitValues=function(t){var e=t[this.field.name];this.value=e},e.prototype.renderControl=function(){return i.createElement(this.view,null)},r.c([o.l],e.prototype,"caption",void 0),e}(a);n.d(e,"b",function(){return N}),n.d(e,"a",function(){return u});var N=function(t,e){e.label;return void 0!==e.group?function(t,e,n){return new g(t,n,void 0)}(t,0,e):void 0!==e.field?function(t,e,n){var r=n.field,i=n.face;switch(typeof r){case"string":r={name:r,type:"string"};break;case"object":break;default:return new g(t,r,i)}var o=r.type||"string";if(void 0===i){if(void 0===(i=x[o]))return new g(t,r,i)}else if(void 0===i.type){var s=x[o];i.type=void 0===s?"string":s.type}return new(S[i.type||o]||g)(t,r,i)}(t,0,e):new w(t,e.help)},S={string:d,password:p,number:f,checkbox:m,radiobox:v,select:y,"pick-id":E,"pick-tuid":k,textarea:b,pick:P},x={string:{type:"string"},number:{type:"number"},int:{type:"number"},dec:{type:"number"},bool:{type:"checkbox"}}},function(t,e,n){"use strict";var r=n(0),i=n(4),o=n(8),s=n.n(o),a=function(){function t(t,e,n){this.fieldMaps={},this.entities=t,this.name=e,this.typeId=n,this.sys=this.name.indexOf("$")>=0}return Object.defineProperty(t.prototype,"sName",{get:function(){return this.jName||this.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tvApi",{get:function(){return this.entities.uqApi},enumerable:!0,configurable:!0}),t.prototype.getApiFrom=function(){return this.entities.uqApi},t.prototype.fieldMap=function(t){void 0===t&&(t="$");var e=this.fieldMaps[t];if(void 0===e){var n=void 0;if("$"===t)n=this.fields;else if(void 0!==this.arrFields){void 0!==(r=this.arrFields.find(function(e){return e.name===t}))&&(n=r.fields)}else if(void 0!==this.returns){var r;void 0!==(r=this.returns.find(function(e){return e.name===t}))&&(n=r.fields)}if(void 0===n)return{};e={};for(var i=0,o=n;i<o.length;i++){var s=o[i];e[s.name]=s}this.fieldMaps[t]=e}return e},t.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return void 0!==this.schema?[2]:[4,this.entities.uqApi.schema(this.name)];case 1:return t=e.sent(),this.setSchema(t),this.buildFieldsTuid(),[2]}})})},t.prototype.setSchema=function(t){if(void 0!==t&&void 0===this.schema){this.schema=t;var e=t.name;e!==this.name&&(this.jName=e),this.buildFieldsTuid()}},t.prototype.buildFieldsTuid=function(){var t=this.schema,e=t.fields,n=t.arrs,r=t.returns;this.entities.buildFieldTuid(this.fields=e),this.entities.buildArrFieldsTuid(this.arrFields=n,e),this.entities.buildArrFieldsTuid(this.returns=r,e)},t.prototype.schemaStringify=function(){return JSON.stringify(this.schema,function(t,e){if("_tuid"!==t)return e},4)},t.prototype.tuidFromField=function(t){var e=t._tuid,n=t.tuid;if(void 0!==n)return void 0!==e?e:t._tuid=this.entities.getTuid(n,void 0)},t.prototype.tuidFromName=function(t,e){if(void 0!==this.schema){var n=this.schema,r=n.fields,i=n.arrs,o=this.entities,s=t.toLowerCase();if(void 0===e)return c(s,r);if(void 0!==i){var a=e.toLowerCase(),u=i.find(function(t){return t.name===a});if(void 0!==u)return c(s,u.fields)}}function c(t,e){if(void 0!==e){var n=e.find(function(e){return e.name===t});if(void 0!==n)return o.getTuid(n.tuid,void 0)}}},t.prototype.buildParams=function(t){var e={},n=this.fields;void 0!==n&&this.buildFieldsParams(e,n,t);var r=this.arrFields;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i],a=s.name,u=s.fields;if(void 0!==t[a]){var c=[];e[a]=c;for(var l=0,h=t;l<h.length;l++){var d=h[l],p={};this.buildFieldsParams(p,u,d),c.push(p)}}}return e},t.prototype.buildFieldsParams=function(t,e,n){for(var r=0,i=e;r<i.length;r++){var o=i[r],s=o.name,a=n[s],u=void 0;switch(typeof a){default:u=a;break;case"object":var c=o._tuid;u=void 0===c?a.id:c.getIdFromObj(a)}t[s]=u}},t.prototype.pack=function(t){var e=[],n=this.fields;void 0!==n&&this.packRow(e,n,t);var r=this.arrFields;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];this.packArr(e,s.fields,t[s.name])}return e.join("")},t.prototype.escape=function(t,e){var n=t[e.name];switch(typeof n){default:return n;case"object":var r=e._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var i=n.length,o="",s=0,a=0;a<i;a++){switch(n.charCodeAt(a)){case 9:o+=n.substring(s,a)+"\\t",s=a+1;break;case 10:o+=n.substring(s,a)+"\\n",s=a+1}}return o+n.substring(s);case"undefined":return""}},t.prototype.packRow=function(t,e,n){var r=e.length;if(0!==r){var i="";i+=this.escape(n,e[0]);for(var o=1;o<r;o++){var s=e[o];i+="\t"+this.escape(n,s)}t.push(i+"\n")}},t.prototype.packArr=function(t,e,n){if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r];this.packRow(t,e,o)}t.push("\n")},t.prototype.unpackSheet=function(t){var e={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(e,n,t,r));var i=this.arrFields;if(void 0!==i)for(var o=0,s=i;o<s.length;o++){var a=s[o];r=this.unpackArr(e,a,t,r)}return e},t.prototype.unpackReturns=function(t){var e={},n=0,r=this.returns;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];n=this.unpackArr(e,s,t,n)}return e},t.prototype.unpackRow=function(t,e,n,r){for(var i=0,o=0,s=r,a=0,u=n.length,c=e.length;r<u;r++)if(i=o,9===(o=n.charCodeAt(r))){var l=(d=e[a]).name;if(8!==i){if(r>s){var h=n.substring(s,r);t[l]=this.to(t,h,d)}}else t[l]=null;if(s=r+1,++a>=c){(r=n.indexOf("\n",s))>=0?++r:r=u;break}}else if(10===o){var d;l=(d=e[a]).name;if(8!==i){if(r>s){h=n.substring(s,r);t[l]=this.to(t,h,d)}}else t[l]=null;++r,++a;break}return r},t.prototype.to=function(t,e,n){switch(n.type){default:return e;case"datetime":case"date":case"time":return new Date(Number(e));case"id":case"tinyint":case"smallint":case"int":case"dec":return Number(e);case"bigint":var r=Number(e),i=n._tuid;return void 0===i?r:(i.useId(r,!0),i.boxId(r))}},t.prototype.unpackArr=function(t,e,n,r){for(var i=[],o=n.length,s=e.name,a=e.fields;r<o;){if(10===n.charCodeAt(r)){++r;break}var u={};i.push(u),r=this.unpackRow(u,a,n,r)}return t[s]=i,r},t}(),u=n(88),c=(function(){}(),function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.queue=[],o.waitingIds=[],o.cache=i.l.map({},{deep:!1}),o.buildIdBoxer(),o}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"tuid"},enumerable:!0,configurable:!0}),e.prototype.buildIdBoxer=function(){this.BoxId=function(){};var t=this.BoxId.prototype;Object.defineProperty(t,"_$tuid",{value:this.from(),writable:!1,enumerable:!1}),Object.defineProperty(t,"obj",{enumerable:!1,get:function(){if(!(void 0===this.id||this.id<=0))return this._$tuid.valueFromId(this.id)}}),t.valueFromFieldName=function(t){return this._$tuid.valueFromFieldName(t,this.obj)},t.getObj=function(){if(void 0!==this._$tuid)return this._$tuid.getCacheValue(this.id)},t.toJSON=function(){return this.id}},e.prototype.boxId=function(t){if("object"===typeof t)return t;this.useId(t);var e=new this.BoxId;return e.id=t,e},e.prototype.getTuidContent=function(){return this.entities.cUq.getTuidContent(this)},e.prototype.getIdFromObj=function(t){return t[this.idName]},e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.id,r=e.unique;this.idName=n,this.unique=r,this.schemaFrom=this.schema.from},e.prototype.buildFieldsTuid=function(){t.prototype.buildFieldsTuid.call(this);var e=this.schema.mainFields;if(void 0!==e)for(var n=function(t){var e=r.fields.find(function(e){return e.name===t.name});if(void 0===e)return"continue";t._tuid=e._tuid},r=this,i=0,o=e;i<o.length;i++){n(o[i])}},e.prototype.moveToHead=function(t){var e=this.queue.findIndex(function(e){return e===t});this.queue.splice(e,1),this.queue.push(t)},e.prototype.valueFromId=function(t){var e;switch(typeof t){case"object":e=t.id;break;case"number":e=t;break;default:return}return this.getCacheValue(e)},e.prototype.getCacheValue=function(t){var e=this.cache.get(t);return void 0!==this.owner&&"object"===typeof e&&(e.$owner=this.owner.boxId(e.owner)),e},e.prototype.valueFromFieldName=function(t,e){if(void 0!==e&&void 0!==this.fields){var n=this.fields.find(function(e){return e.name===t});if(void 0!==n){var r=e[t],i=n._tuid;return void 0===i?r:i.valueFromId(r)}}},e.prototype.resetCache=function(t){this.cache.delete(t);var e=this.queue.findIndex(function(e){return e===t});this.queue.splice(e,1),this.useId(t)},e.prototype.useId=function(t,e){if(void 0!==t&&0!==t&&!1!==Object(u.isNumber)(t))if(!0!==this.cache.has(t))if(this.entities.cacheTuids(!0===e?70:20),this.cache.set(t,t),this.waitingIds.findIndex(function(e){return e===t})>=0)this.moveToHead(t);else{if(this.queue.length>=1e3){var n=this.queue.shift();if(n===t)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex(function(t){return t===n});this.waitingIds.splice(r,1)}}this.waitingIds.push(t),this.queue.push(t)}else this.moveToHead(t)},e.prototype.proxied=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return this.entities.getTuid(t,void 0).useId(e),[4,this.tvApi.proxied(this.name,t,e)];case 1:return n=r.sent(),this.cacheValue(n),[2,n]}})})},e.prototype.cacheValue=function(t){if(void 0===t)return!1;var e=this.getIdFromObj(t);if(void 0===e)return!1;var n=this.waitingIds.findIndex(function(t){return t===e});return n>=0&&this.waitingIds.splice(n,1),this.cache.set(e,t),!0},e.prototype.afterCacheId=function(t){if(void 0!==this.fields)for(var e=0,n=this.fields;e<n.length;e++){var r=n[e],i=r._tuid;void 0!==i&&i.useId(t[r.name])}},e.prototype.from=function(){},e.prototype.unpackTuidIds=function(t){if(void 0===this.schemaFrom){var e=this.schema.mainFields;if(void 0===e)return t;for(var n=[],r=t.length,i=0;i<r;){if(10===t.charCodeAt(i)){++i;break}var o={};i=this.unpackRow(o,e,t,i),n.push(o)}return n}return n=this.from().unpackTuidIds(t)},e.prototype.cacheIds=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return 0===this.waitingIds.length?[2]:(void 0===this.owner?t=this.name:(t=this.owner.name,e=this.name),[4,this.getApiFrom().tuidIds(t,e,this.waitingIds)]);case 1:for(n=r.sent(),n=this.unpackTuidIds(n),i=0,o=n;i<o.length;i++)s=o[i],!1!==this.cacheValue(s)&&(this.cacheTuidFieldValues(s),this.afterCacheId(s));return[4,this.cacheDivIds()];case 2:return r.sent(),[2]}})})},e.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2]})})},e.prototype.load=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return void 0===t||0===t?[2]:[4,this.getApiFrom().tuidGet(this.name,t)];case 1:return void 0===(e=n.sent())?[2]:(e._$tuid=this,this.cacheValue(e),this.cacheTuidFieldValues(e),[2,e])}})})},e.prototype.getDiv=function(t){},e.prototype.cacheTuidFieldValues=function(t){var e=this.schema,n=e.fields,r=e.arrs;if(this.cacheFieldsInValue(t,n),void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i],a=s.name,u=s.fields,c=t[a];if(void 0!==c)for(var l=this.getDiv(a),h=0,d=c;h<d.length;h++){var p=d[h];p._$tuid=l,p.$owner=this.boxId(p.owner),l.cacheValue(p),this.cacheFieldsInValue(p,u)}}},e.prototype.cacheFieldsInValue=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i.name,s=i._tuid;if(void 0!==s){var a=t[o];t[o]=s.boxId(a)}}},e.prototype.save=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=s.a.clone(e)).$id=t,[4,this.tvApi.tuidSave(this.name,n)];case 1:return[2,r.sent()]}})})},e.prototype.search=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.searchArr(void 0,t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.searchArr=function(t,e,n,i){return r.b(this,void 0,Promise,function(){var o,s,a,u,c,l,h;return r.e(this,function(r){switch(r.label){case 0:return o=this.schema.fields,void 0!==this.owner?(s=this.owner.name,a=this.name):(s=this.name,a=void 0),[4,this.getApiFrom().tuidSearch(s,a,t,e,n,i)];case 1:for(u=r.sent(),c=0,l=u;c<l.length;c++)h=l[c],this.cacheFieldsInValue(h,o),void 0!==this.owner&&(h.$owner=this.owner.boxId(h.owner));return[2,u]}})})},e.prototype.loadArr=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return void 0===n||0===n?[2]:[4,this.getApiFrom().tuidArrGet(this.name,t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.saveArr=function(t,e,n,i){return r.b(this,void 0,void 0,function(){var o;return r.e(this,function(r){switch(r.label){case 0:return(o=s.a.clone(i)).$id=n,[4,this.tvApi.tuidArrSave(this.name,t,e,o)];case 1:return[2,r.sent()]}})})},e.prototype.posArr=function(t,e,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tvApi.tuidArrPos(this.name,t,e,n,i)];case 1:return[2,r.sent()]}})})},e.prototype.showInfo=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entities.cUq.showTuid(this,t)];case 1:return e.sent(),[2]}})})},e}(a)),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"Main",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uqApi",{get:function(){return this.entities.uqApi},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.arrs;if(void 0!==n){this.divs={};for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o.name,a=new h(this.entities,s,this.typeId);a.owner=this,this.divs[s]=a,a.setSchema(o)}}},e.prototype.getDiv=function(t){return this.divs[t]},e.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.divs)return[2];for(e in t=[],this.divs)t.push(e);n=0,r.label=1;case 1:return n<t.length?(i=t[n],[4,this.divs[i].cacheIds()]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.cUqFrom=function(){if(void 0===this.schemaFrom)return this.entities.cUq;var t=this.schemaFrom,e=t.owner,n=t.uq,r=this.entities.cUq,i=r.cApp;if(void 0===i)return r;var o=i.getImportUq(e,n);return void 0===o?(console.error(e+"/"+n+" \u4e0d\u5b58\u5728"),r):o},e.prototype.getApiFrom=function(){var t=this.from();return void 0!==t?t.entities.uqApi:this.entities.uqApi},e.prototype.from=function(){return void 0===this.schemaFrom?this:this.cUqFrom().tuid(this.name)},e.prototype.cFrom=function(){return this.cUqFrom().cTuidMainFromName(this.name)},e.prototype.cEditFrom=function(){return this.cUqFrom().cTuidEditFromName(this.name)},e.prototype.cInfoFrom=function(){return this.cUqFrom().cTuidInfoFromName(this.name)},e.prototype.cSelectFrom=function(){var t=this.cUqFrom();if(void 0!==t)return t.cTuidSelectFromName(this.name)},e}(c),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"Main",{get:function(){return this.owner},enumerable:!0,configurable:!0}),e.prototype.getApiFrom=function(){return this.owner.getApiFrom()},e}(c),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"action"},enumerable:!0,configurable:!0}),e.prototype.submit=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),e=this.pack(t),[4,this.tvApi.action(this.name,{data:e})];case 2:return[2,n.sent()]}})})},e}(a),p=n(2),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"sheet"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e),this.states=e.states},e.prototype.build=function(t){this.states=[];for(var e=0,n=t.ops;e<n.length;e++){var r=n[e];this.states.push({name:r,actions:void 0})}},e.prototype.createSheetState=function(t,e){var n={name:t,actions:[]},r=n.actions;for(var i in e){var o={name:i};r.push(o)}return n},e.prototype.save=function(t,e){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),n=this.entities.appId,i=this.pack(e),[4,this.tvApi.sheetSave(this.name,{app:n,discription:t,data:i})];case 2:return[2,r.sent()]}})})},e.prototype.action=function(t,e,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.sheetAction(this.name,{id:t,flow:e,state:n,action:i})];case 2:return[2,r.sent()]}})})},e.prototype.unpack=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o;return r.e(this,function(r){return e=t[0],n=e[0],i=this.unpackSheet(n.data),o=t[1],[2,{brief:n,data:i,flows:o}]})})},e.prototype.getSheet=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.getSheet(this.name,t)];case 2:return 0!==(e=n.sent())[0].length?[3,4]:[4,this.getArchive(t)];case 3:return[2,n.sent()];case 4:return[4,this.unpack(e)];case 5:return[2,n.sent()]}})})},e.prototype.getArchive=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.sheetArchive(this.name,t)];case 2:return e=n.sent(),[4,this.unpack(e)];case 3:return[2,n.sent()]}})})},e.prototype.getArchives=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.sheetArchives(this.name,{pageStart:t,pageSize:e})];case 2:return[2,n.sent()]}})})},e.prototype.getStateSheets=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.stateSheets(this.name,{state:t,pageStart:e,pageSize:n})];case 2:return[2,r.sent()]}})})},e.prototype.createPageStateItems=function(){return new m(this)},e.prototype.stateSheetCount=function(){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.tvApi.stateSheetCount(this.name)];case 2:return t=e.sent(),[2,this.states.map(function(e){var n=e.name,r=0,i=t.find(function(t){return t.state===n});return void 0!==i&&(r=i.count),{state:n,count:r}})]}})})},e.prototype.mySheets=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.mySheets(this.name,{state:t,pageStart:e,pageSize:n})];case 2:return[2,r.sent()]}})})},e}(a),m=function(t){function e(e){var n=t.call(this,!0)||this;return n.sheet=e,n.pageSize=10,n}return r.d(e,t),e.prototype.load=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.sheet.getStateSheets(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(p.PageItems),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"query"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e);var n=e.returns;this.returns=n,this.isPaged=void 0!==n.find(function(t){return"$page"===t.name})},e.prototype.resetPage=function(t,e){this.pageStart=void 0,this.pageSize=t,this.params=e,this.more=!1,this.list=void 0},Object.defineProperty(e.prototype,"hasMore",{get:function(){return this.more},enumerable:!0,configurable:!0}),e.prototype.loadPage=function(){return r.b(this,void 0,Promise,function(){var t,e,n,o;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.pageSize)throw"call resetPage(size:number, params:any) first";if(void 0!==this.pageStart)switch(this.startField.type){default:e=this.pageStart;break;case"date":case"time":case"datetime":e=this.pageStart.getTime()}return[4,this.page(this.params,e,this.pageSize+1)];case 1:return n=r.sent(),this.list=i.l.array([],{deep:!1}),void 0!==n&&(n.length>this.pageSize?(this.more=!0,n.pop(),o=this.returns.find(function(t){return"$page"===t.name}),this.startField=o.fields[0],this.pageStart=n[n.length-1][this.startField.name]):this.more=!1,(t=this.list).push.apply(t,n)),[2]}})})},e.prototype.page=function(t,e,n){return r.b(this,void 0,Promise,function(){var i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.page(this.name,e,n+1,this.buildParams(t))];case 2:return i=r.sent(),[4,this.unpackReturns(i)];case 3:return[2,r.sent().$page]}})})},e.prototype.query=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.query(this.name,this.buildParams(t))];case 2:return e=n.sent(),[4,this.unpackReturns(e)];case 3:return[2,n.sent()]}})})},e.prototype.table=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e.prototype.obj=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(t)];case 1:return(e=n.sent()).length>0?[2,e[0]]:[2]}})})},e.prototype.scalar=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},r.c([i.l],e.prototype,"list",void 0),e}(a),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="book",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"book"},enumerable:!0,configurable:!0}),e}(v),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="history",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"history"},enumerable:!0,configurable:!0}),e}(v),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions={},e.queries={},e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"map"},enumerable:!0,configurable:!0}),e.prototype.setSchema=function(e){t.prototype.setSchema.call(this,e),this.schemaFrom=this.schema.from;var n=e.actions,r=e.queries,i=e.keys;for(var o in this.entities.buildFieldTuid(this.keys=i),n){var s=n[o],a=s.name,u=this.entities.newAction(a,void 0);u.setSchema(s),this.actions[o]=u}for(var o in r){var c=r[o],l=(a=c.name,this.entities.newQuery(a,void 0));l.setSchema(c),this.queries[o]=l}},e.prototype.add=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.actions.add.submit(t)];case 2:return[2,e.sent()]}})})},e.prototype.del=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.actions.del.submit(t)];case 2:return[2,e.sent()]}})})},e.prototype.all=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.queries.all.query({})];case 2:return[2,t.sent()]}})})},e.prototype.page=function(t,e,n){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.queries.page.page(t,e,n)];case 2:return[2,r.sent()]}})})},e.prototype.query=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.queries.query.query(t)];case 2:return[2,e.sent()]}})})},e.prototype.table=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e.prototype.obj=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(t)];case 1:return(e=n.sent()).length>0?[2,e[0]]:[2]}})})},e.prototype.scalar=function(t){return r.b(this,void 0,Promise,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(t)];case 1:for(n in e=r.sent())return[2,e[n]];return[2]}})})},e}(a),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.queryApiName="pending",e}return r.d(e,t),Object.defineProperty(e.prototype,"typeName",{get:function(){return"pending"},enumerable:!0,configurable:!0}),e}(v);function E(t){switch(t){case"tinyint":case"smallint":case"int":case"bigint":case"dec":return 0;case"char":case"text":return"";case"datetime":case"date":return"2000-1-1";case"time":return"0:00"}}var k=function(){function t(t,e,n){var r=this;this.tuids={},this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.loadIds=function(){for(var t in r.clearCacheTimer(),r.tuids){r.tuids[t].cacheIds()}},this.cUq=t,this.uqApi=e,this.appId=n}return t.prototype.tuid=function(t){return this.tuids[t.toLowerCase()]},t.prototype.action=function(t){return this.actions[t.toLowerCase()]},t.prototype.sheet=function(t){return this.sheets[t.toLowerCase()]},t.prototype.query=function(t){return this.queries[t.toLowerCase()]},t.prototype.book=function(t){return this.books[t.toLowerCase()]},t.prototype.map=function(t){return this.maps[t.toLowerCase()]},t.prototype.history=function(t){return this.histories[t.toLowerCase()]},t.prototype.pending=function(t){return this.pendings[t.toLowerCase()]},t.prototype.sheetFromTypeId=function(t){for(var e in this.sheets){var n=this.sheets[e];if(n.typeId===t)return n}},t.prototype.loadAccess=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.uqApi.loadAccess()];case 1:return void 0===(t=e.sent())?[2]:(this.buildEntities(t),[2])}})})},t.prototype.loadEntities=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.uqApi.loadEntities()];case 1:return t=e.sent(),this.buildEntities(t),[2]}})})},t.prototype.buildEntities=function(t){var e=t.access,n=t.tuids;this.buildTuids(n),this.buildAccess(e)},t.prototype.getTuid=function(t,e,n){var r=this.tuids[t];if(void 0!==r)return void 0===e?r:r.divs[e]},t.prototype.cacheTuids=function(t){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,t)},t.prototype.clearCacheTimer=function(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)},t.prototype.buildTuids=function(t){for(var e in t){(r=t[e]).name;var n=r.typeId;this.newTuid(e,n).sys=!0}for(var e in t){var r;(r=t[e]).name;this.getTuid(e).setSchema(r)}for(var e in this.tuids){this.tuids[e].buildFieldsTuid()}},t.prototype.buildAccess=function(t){for(var e in t){var n=t[e];switch(typeof n){case"string":this.fromType(e,n);break;case"object":this.fromObj(e,n)}}},t.prototype.newAction=function(t,e){var n=this.actions[t];return void 0!==n?n:(n=this.actions[t]=new d(this,t,e),this.actionArr.push(n),n)},t.prototype.newTuid=function(t,e){var n=this.tuids[t];return void 0!==n?n:(n=this.tuids[t]=new l(this,t,e),this.tuidArr.push(n),n)},t.prototype.newQuery=function(t,e){var n=this.queries[t];return void 0!==n?n:(n=this.queries[t]=new v(this,t,e),this.queryArr.push(n),n)},t.prototype.newBook=function(t,e){var n=this.books[t];return void 0!==n?n:(n=this.books[t]=new b(this,t,e),this.bookArr.push(n),n)},t.prototype.newMap=function(t,e){var n=this.maps[t];return void 0!==n?n:(n=this.maps[t]=new g(this,t,e),this.mapArr.push(n),n)},t.prototype.newHistory=function(t,e){var n=this.histories[t];if(void 0===n)return n=this.histories[t]=new y(this,t,e),this.historyArr.push(n),n},t.prototype.newPending=function(t,e){var n=this.pendings[t];if(void 0===n)return n=this.pendings[t]=new w(this,t,e),this.pendingArr.push(n),n},t.prototype.newSheet=function(t,e){var n=this.sheets[t];return void 0!==n?n:(n=this.sheets[t]=new f(this,t,e),this.sheetArr.push(n),n)},t.prototype.fromType=function(t,e){var n=e.split("|");e=n[0];var r=Number(n[1]);switch(e){case"uq":this.uqId=r;break;case"tuid":this.newTuid(t,r).sys=!1;break;case"action":this.newAction(t,r);break;case"query":this.newQuery(t,r);break;case"book":this.newBook(t,r);break;case"map":this.newMap(t,r);break;case"history":this.newHistory(t,r);break;case"sheet":this.newSheet(t,r);break;case"pending":this.newPending(t,r)}},t.prototype.fromObj=function(t,e){switch(e.$){case"sheet":this.buildSheet(t,e)}},t.prototype.buildSheet=function(t,e){var n=this.sheets[t];void 0===n&&(n=this.newSheet(t,e.id)),n.build(e)},t.prototype.buildFieldTuid=function(t,e){if(void 0!==t){for(var n=0,r=t;n<r.length;n++){var i=(h=r[n]).tuid,o=h.arr,s=h.url;void 0!==i&&(h._tuid=this.getTuid(i,o,s))}for(var a=function(n){var r=n.owner;if(void 0===r)return"continue";var i=t.find(function(t){return t.name===r});if(void 0===i&&(void 0!==e&&(i=e.find(function(t){return t.name===r})),void 0===i))throw"owner field "+r+" is undefined";n._ownerField=i;var o=n.arr,s=n.url;if(n._tuid=u.getTuid(i._tuid.name,o,s),void 0===n._tuid)throw"owner field ${owner} is not tuid"},u=this,c=0,l=t;c<l.length;c++){var h;a(h=l[c])}}},t.prototype.buildArrFieldsTuid=function(t,e){if(void 0!==t)for(var n=0,r=t;n<r.length;n++){var i=r[n].fields;void 0!==i&&this.buildFieldTuid(i,e)}},t}();n.d(e,"b",function(){return E}),n.d(e,"a",function(){return k})},function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return l});var r=n(0),i=n(1),o=n(31),s=function(){function t(t,e){if(this.form=t,this.row=e,void 0===e.type){var n=e.createControl;void 0===n&&(n=t.createControl),void 0===n&&(n=o.b),this.control=n(t,e)}}return t.prototype.isOk=function(){return void 0===this.control||this.control.isOk()},t.prototype.contains=function(t){var e=this.row.field;if(void 0!==e)return t===e.name;var n=this.row.group;return void 0!==n&&void 0!==n.find(function(e){return e.field.name===t})},Object.defineProperty(t.prototype,"hasError",{get:function(){return this.control.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return this.control.filled},enumerable:!0,configurable:!0}),t.prototype.clear=function(){void 0!==this.control&&this.control.clear()},t.prototype.clearErrors=function(){void 0!==this.control&&this.control.clearErrors()},t.prototype.readValues=function(t){void 0!==this.control&&this.control.readValues(t)},t.prototype.setError=function(t,e){void 0!==this.control&&this.control.setError(t,e)},t.prototype.setInitValues=function(t){void 0!==this.control&&this.control.setInitValues(t)},t}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t){return i.createElement("div",{key:t,className:"form-group"},this.row)},Object.defineProperty(e.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(s),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t){return i.createElement("div",{key:t,className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.row.label),this.control.render())},e}(s);function c(t,e){return new u(t,e)}function l(t,e){return new a(t,e)}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var r=n(0);function i(t,e,n,i,o){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,t.fetch(e,n,i,o)];case 1:return r.sent(),[2]}})})}var o=function(){function t(t,e){this.path=t||"",this.showWaiting=e}return t.prototype.call=function(t,e,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,r.sent().callFetch(t,e,n)];case 2:return[2,r.sent()]}})})},t.prototype.get=function(t,e){return void 0===e&&(e=void 0),r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().get(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.post=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().post(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.put=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().put(this.path+t,e)];case 2:return[2,n.sent()]}})})},t.prototype.delete=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().delete(this.path+t,e)];case 2:return[2,n.sent()]}})})},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(1),o=n(9),s=function(t){function e(e){var n=t.call(this,e)||this;return n.logoutClick=function(){o.c.showLogout(n.logout)},n.logout=function(){return r.b(n,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return"function"!==typeof(t=this.props.logout)?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[4,o.c.logout(void 0)];case 3:return e.sent(),[2]}})})},n.navChange=n.navChange.bind(n),n.state={hasBack:!1},n}return r.d(e,t),e.prototype.navChange=function(){this.setState({hasBack:o.c.level>1})},e.prototype.componentWillMount=function(){this.navChange()},e.prototype.componentWillUnmount=function(){},e.prototype.back=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,o.c.back()];case 1:return t.sent(),[2]}})})},e.prototype.openWindow=function(){window.open(document.location.href)},e.prototype.render=function(){var t,e,n,r,s=this.state.hasBack||self!=top,a=this.props,u=a.right,c=a.center,l=a.logout;if(void 0!==l&&self===top&&("boolean"===typeof l&&!0===l||"function"===typeof l)){var h=o.c.user;if(void 0!==h){var d=h.nick,p=h.name;n=i.createElement("div",{className:"d-flex align-items-center"},i.createElement("small",{className:"text-light"},d||p),i.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},i.createElement("i",{className:"fa fa-sign-out"})))}}if(s)switch(this.props.back){case"none":t=void 0;break;default:case"back":t=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":t=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),e=i.createElement("header",{onClick:this.openWindow})),(u||n)&&(r=i.createElement("aside",null,u," ",n)),i.createElement("header",{style:o.b},e,t,i.createElement("div",null,c),r)},e}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n.n(o),a=n(5),u=n(3),c=n(2),l=n(12),h=function(t){return s.a.createElement("div",{className:"px-3 py-2"},Object(l.a)(t))},d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),!0!==this.entity.isPaged?[3,3]:[4,this.entity.resetPage(30,t)];case 1:return n.sent(),[4,this.entity.loadPage()];case 2:return n.sent(),this.replacePage(this.pageResult),[3,5];case 3:return[4,this.entity.query(t)];case 4:e=n.sent(),this.replacePage(this.queryResult,e),n.label=5;case 5:return[2]}})})},e.again=function(){e.vForm.reset(),e.replacePage(e.view)},e.renderRow=function(t,n){return o.createElement(e.row,r.a({},t))},e.view=function(){return o.createElement(c.Page,{header:e.label},e.vForm.render("mx-3 my-2"),e.renderExtra())},e.pageResult=function(){var t=e.entity,n=(t.name,t.list),r=o.createElement("button",{className:"btn btn-outline-success",onClick:e.again},o.createElement(u.FA,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:e.label,right:r},o.createElement(u.List,{items:n,item:{render:e.renderRow}}))},e.queryResult=Object(a.a)(function(t){var n=o.createElement("button",{className:"btn btn-outline-success",onClick:e.again},o.createElement(u.FA,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:e.label,right:n},o.createElement("pre",null,JSON.stringify(t,void 0,"\t")))}),e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){var e,n,i;return r.e(this,function(r){return this.vForm=this.createForm(this.onSubmit,t),e=this.ui,n=e.row,i=e.queryRow,this.row=i||n||h,this.openPage(this.view),[2]})})},e.prototype.renderExtra=function(){},e}(i.b),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSearch=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.PageItems.first(t)];case 1:return e.sent(),[2]}})})},e.renderRow=function(t,n){return o.createElement(e.row,r.a({},t))},e.clickRow=function(t){e.callOnSelected(t)},e.view=function(){var t=o.createElement(u.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:e.onSearch,placeholder:"\u641c\u7d22"+e.label});return o.createElement(c.Page,{header:t},o.createElement(u.List,{items:e.PageItems.items,item:{render:e.renderRow,onClick:e.clickRow},before:"\u641c\u7d22"+e.label+"\u8d44\u6599"}))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){var e,n,i;return r.e(this,function(r){switch(r.label){case 0:return e=this.ui,n=e.row,i=e.selectRow,this.row=i||n||h,this.PageItems=new f(this.entity),[4,this.onSearch(t)];case 1:return r.sent(),this.openPage(this.view),[2]}})})},e.prototype.callOnSelected=function(t){this.closePage(),this.returnCall(t)},e}(i.b),f=function(t){function e(e){var n=t.call(this)||this;return n.query=e,n}return r.d(e,t),e.prototype.load=function(){return r.b(this,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.query.loadSchema()];case 1:return n.sent(),!0!==this.query.isPaged?[3,3]:[4,this.query.page(this.param,this.pageStart,this.pageSize)];case 2:return t=n.sent(),[3,5];case 3:return[4,this.query.query(this.param)];case 4:e=n.sent(),t=e[this.query.returns[0].name],n.label=5;case 5:return[2,t]}})})},e.prototype.setPageStart=function(t){void 0===t&&(this.pageStart=0)},e}(c.PageItems),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(i.a),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VQueryMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VQueryMain",{get:function(){return this.ui&&this.ui.main||d},enumerable:!0,configurable:!0}),e}(m),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VQuerySelect,t)];case 1:return e.sent(),[2]}})})},Object.defineProperty(e.prototype,"VQuerySelect",{get:function(){return p},enumerable:!0,configurable:!0}),e}(m);n.d(e,"a",function(){return v}),n.d(e,"b",function(){return b})},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(1),o=n(5),s=n(4),a=n(40),u=n(21),c=n(9),l=n(19),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.overSize=!1,e.upload=function(){return r.b(e,void 0,void 0,function(){var t,e=this;return r.e(this,function(n){switch(n.label){case 0:return this.resUploader?[4,this.resUploader.upload()]:[2];case 1:return null===(t=n.sent())?(this.overSize=!0,setTimeout(function(){return e.overSize=!1},3e3),[2]):(this.resId=t,this.isChanged=this.resId!=this.value,[2])}})})},e.page=Object(o.a)(function(t){var n,r=t.resolve,o=i.createElement("button",{className:"btn btn-sm btn-success",disabled:!e.isChanged,onClick:function(){return r(e.resId)}},"\u4fdd\u5b58");return!0===e.overSize&&(n=i.createElement("div",{className:"text-danger"},i.createElement("i",{className:"fa fa-times-circle"})," \u56fe\u7247\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc72M\uff0c\u65e0\u6cd5\u4e0a\u4f20")),i.createElement(l.a,{header:"\u66f4\u6539"+e.label,right:o},i.createElement("div",{className:"my-3 px-3 py-3 bg-white"},i.createElement("div",null,i.createElement("div",null,"\u4e0a\u4f20\u56fe\u7247\uff1a"),i.createElement("div",{className:"my-3"},i.createElement(a.a,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048})),i.createElement("div",null,i.createElement("button",{className:"btn btn-primary",onClick:e.upload},"\u4e0a\u4f20"))),n,i.createElement("div",{className:"small muted my-4"},"\u652f\u6301JPG\u3001GIF\u3001PNG\u683c\u5f0f\u56fe\u7247\uff0c\u4e0d\u8d85\u8fc72M\u3002"),i.createElement("div",{className:"d-flex"},i.createElement("div",{className:"w-12c h-12c mr-4",style:{border:"1px dotted gray",padding:"8px"}},i.createElement(u.a,{className:"w-100 h-100",src:e.resId})),i.createElement("div",null,i.createElement("div",{className:"small"},"\u56fe\u7247\u9884\u89c8"),i.createElement(u.a,{className:"w-4c h-4c mt-3",src:e.resId})))))}),e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var t=this;return r.e(this,function(e){return this.resId=this.value,[2,new Promise(function(e,n){c.c.push(i.createElement(t.page,{resolve:e,reject:n}),function(){return n()})})]})})},r.c([s.l],e.prototype,"resId",void 0),r.c([s.l],e.prototype,"overSize",void 0),e}(n(53).a)},,function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(1);function i(){return r.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},r.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"}))}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(1),o=n(9),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.upload=function(){return r.b(e,void 0,Promise,function(){var t,e,n,i,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:for(void 0===(t=this.props.maxSize)||t<=0?t=1e11:t*=1024,e=o.c.resUrl+"upload",n=this.fileInput.files,i=new FormData,s=n.length,a=0;a<s;a++){if((u=n[a]).size>t)return[2,null];i.append("files[]",u,u.name)}r.label=1;case 1:return r.trys.push([1,4,,5]),c=new AbortController,[4,fetch(e,{method:"POST",body:i,signal:c.signal})];case 2:return[4,r.sent().json()];case 3:return[2,":"+r.sent().res.id];case 4:return l=r.sent(),console.error("%s %s",e,l),[3,5];case 5:return[2]}})})},e}return r.d(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.className,r=e.multiple,o=e.onFilesChange;return i.createElement("input",{className:n,ref:function(e){return t.fileInput=e},onChange:o,type:"file",name:"file",multiple:r})},e}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(1),o=n(8),s=n.n(o),a=n(2),u=n(3),c=n(48),l=n(46),h=function(t){function e(e){var n=t.call(this,Object(a.resLang)(e&&e.res))||this;n.cImportUqs={},n.cUqCollection={},n.renderRow=function(t,e){var n=t.id,r=t.nick,o=t.name;return i.createElement(u.LMR,{className:"px-3 py-2",right:"id: "+n},i.createElement("div",null,r||o))},n.onRowClick=function(t){return r.b(n,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return a.appInFrame.unit=t.id,[4,this.start()];case 1:return e.sent(),[2]}})})},n.selectUnitPage=function(){return i.createElement(a.Page,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},i.createElement(u.List,{items:n.appUnits,item:{render:n.renderRow,onClick:n.onRowClick}}))},a.nav.setSettings(e);var o=e.appName;if(void 0===o)throw'appName like "owner/app" must be defined in UI';var s=o.split("/");if(2!==s.length)throw"tonvaApp name must be / separated, owner/app";return n.appOwner=s[0],n.appName=s[1],void 0===e.uqs&&(e.uqs={}),n.ui=e,n.caption=n.res.caption||"Tonva",n}return r.d(e,t),e.prototype.startDebug=function(){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return t=this.appOwner+"/"+this.appName,n=new e({appName:t,uqs:{}}),!0,[4,n.start(!0)];case 1:return r.sent(),[2]}})})},e.prototype.loadUqs=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o,s,u,c,l,h,d,p,f,m,v,b,y,g,w,E,k,C;return r.e(this,function(r){switch(r.label){case 0:return e=[],a.appInFrame.unit,n=t.id,i=t.uqs,this.id=n,o=[],s=[],[4,this.buildRoleAppUI()];case 1:for(u=r.sent(),this.ui=u,c=0,l=i;c<l.length;c++)h=l[c],d=h.id,p=h.uqOwner,f=h.uqName,m=h.access,v=p+"/"+f,b=u&&u.uqs&&u.uqs[v],y=this.newCUq(v,d,m,b||{}),this.cUqCollection[v]=y,o.push(y.loadSchema()),s.push(y.entities.uqApi.checkAccess());return[4,Promise.all(o)];case 2:for(g=r.sent(),Promise.all(s).then(function(t){for(var e=0,n=t;e<n.length;e++)n[e]}),w=0,E=g;w<E.length;w++)k=E[w],void 0===(C=k)||e.push(C);return 0===e.length?[2]:[2,e]}})})},e.prototype.buildRoleAppUI=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:if(!this.ui)return[2,void 0];if(!(t=a.nav.hashParam))return[2,this.ui];if(e=this.ui.roles,!(n=e&&e[t]))return[2,this.ui];for(o in i={},this.ui)"roles"!==o&&(i[o]=this.ui[o]);return"function"!==typeof n?[3,2]:[4,n()];case 1:n=r.sent(),r.label=2;case 2:return s.a.merge(i,n),[2,i]}})})},e.prototype.getImportUq=function(t,e){var n=t+"/"+e,r=this.cImportUqs[n];if(void 0!==r)return r;this.ui&&this.ui.uqs&&this.ui.uqs[n];return this.cImportUqs[n]=r=this.getCUq(n),r},e.prototype.newCUq=function(t,e,n,r){var i=new(this.ui.CUq||c.a)(this,t,this.id,e,n,r);return Object.setPrototypeOf(i.x,this.x),i},Object.defineProperty(e.prototype,"cUqArr",{get:function(){var t=[];for(var e in this.cUqCollection)t.push(this.cUqCollection[e]);return t},enumerable:!0,configurable:!0}),e.prototype.getCUq=function(t){return this.cUqCollection[t]},Object.defineProperty(e.prototype,"VAppMain",{get:function(){return this.ui&&this.ui.main||d},enumerable:!0,configurable:!0}),e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){var t,e,n,o,s,u,c,h;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,Object(a.loadAppUqs)(this.appOwner,this.appName)];case 1:return t=r.sent(),e=a.appInFrame.predefinedUnit,n=t.id,this.id=n,void 0!==(o=a.nav.user)&&o.id>0?(s=this,[4,l.a.userAppUnits(this.id)]):[3,3];case 2:switch(s.appUnits=r.sent(),this.appUnits.length){case 0:return this.showUnsupport(e),[2,!1];case 1:if(void 0===(u=this.appUnits[0].id)||u<0||void 0!==e&&u!=e)return this.showUnsupport(e),[2,!1];a.appInFrame.unit=u;break;default:if(e>0&&void 0!==this.appUnits.find(function(t){return t.id===e})){a.appInFrame.unit=e;break}return a.nav.push(i.createElement(this.selectUnitPage,null)),[2,!1]}r.label=3;case 3:return[4,this.loadUqs(t)];case 4:return void 0!==(c=r.sent())?(this.openPage(i.createElement(a.Page,{header:"ERROR"},i.createElement("div",{className:"m-3"},i.createElement("div",null,"Load Uqs \u53d1\u751f\u9519\u8bef\uff1a"),c.map(function(t,e){return i.createElement("div",{key:e},t)})))),[2,!1]):[2,!0];case 5:return h=r.sent(),a.nav.push(i.createElement(a.Page,{header:"App start error!"},i.createElement("pre",null,"string"===typeof h?h:h.message))),[2,!1];case 6:return[2]}})})},e.prototype.internalStart=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return!0!==t&&this.clearPrevPages(),[4,this.showMainPage()];case 1:return e.sent(),[2]}})})},e.prototype.render=function(){return this.renderView(this.VAppMain)},e.prototype.clearPrevPages=function(){a.nav.clear()},e.prototype.showUnsupport=function(t){this.clearPrevPages();var e=a.nav.user,n=e?e.name:"[\u672a\u767b\u5f55]";this.openPage(i.createElement(a.Page,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},i.createElement("div",{className:"m-3 text-danger container"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"\u767b\u5f55\u7528\u6237: "),i.createElement("div",{className:"col"},n)),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"App:"),i.createElement("div",{className:"col"},this.appOwner+"/"+this.appName)),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"\u9884\u8bbe\u5c0f\u53f7:"),i.createElement("div",{className:"col"},t||i.createElement("small",{className:"text-muted"},"[\u65e0\u9884\u8bbe\u5c0f\u53f7]"))),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},i.createElement(u.FA,{name:"exclamation-triangle"})),i.createElement("div",{className:"col"},i.createElement("div",{className:"text-muted"},"\u65e0\u6cd5\u8fd0\u884c\u53ef\u80fd\u539f\u56e0\uff1a"),i.createElement("ul",{className:"p-0"},i.createElement("li",null,"\u6ca1\u6709\u5c0f\u53f7\u8fd0\u884c ",this.ui.appName),i.createElement("li",null,"\u7528\u6237 ",i.createElement("b",null,n)," \u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u4e00\u4e2a\u8fd0\u884c",this.ui.appName,"\u7684\u5c0f\u53f7"),t&&i.createElement("li",null,"\u9884\u8bbe\u5c0f\u53f7 ",i.createElement("b",null,t)," \u6ca1\u6709\u8fd0\u884cApp ",this.ui.appName)))),t||i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"}),i.createElement("div",{className:"col"},"\u9884\u8bbe\u5c0f\u53f7\u5b9a\u4e49\u5728 public/unit.json \u6587\u4ef6\u4e2d\u3002 \u5b9a\u4e49\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u7531url\u76f4\u63a5\u542f\u52a8\u3002 \u7528\u6237\u7b2c\u4e00\u6b21\u8bbf\u95eeapp\u4e4b\u540e\uff0c\u4f1a\u7f13\u5b58\u5728localStorage\u91cc\u3002",i.createElement("br",null),"\u5982\u679c\u8981\u5220\u53bb\u7f13\u5b58\u7684\u9884\u5b9a\u4e49Unit\uff0clogout\u7136\u540e\u518dlogin\u3002")))))},e.prototype.showMainPage=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,o,s,u;return r.e(this,function(r){switch(r.label){case 0:return void 0===(t=Object(a.getExHash)())?[3,2]:(e=t.split("-")).length>3?"sheet"!==(n=e[3])&&"sheet_debug"!==n?[3,2]:(i=Number(e[4]),o=Number(e[5]),s=Number(e[6]),void 0===(u=this.getCUqFromId(i))?(alert("unknown uqId: "+i),[2]):(this.clearPrevPages(),[4,u.navSheet(o,s)])):[3,2];case 1:return r.sent(),[2];case 2:return this.openVPage(this.VAppMain),[2]}})})},e.prototype.getCUqFromId=function(t){for(var e in this.cUqCollection){var n=this.cUqCollection[e];if(n.id===t)return n}},e}(a.Controller),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.appPage=function(){var t=e.controller.caption;return i.createElement(a.Page,{header:t,logout:function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return a.appInFrame.unit=void 0,[2]})})}},e.appContent())},e.appContent=function(){var t,n=e.controller.cUqArr;return t=0===n.length?i.createElement("div",{className:"text-danger"},i.createElement(u.FA,{name:""})," \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684UQ"):n.map(function(t,e){return i.createElement("div",{key:e},t.render())}),i.createElement(i.Fragment,null,t)},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.appPage),[2]})})},e.prototype.render=function(t){return this.appContent()},e}(a.VPage)},function(t,e,n){"use strict";var r=n(67);n.o(r,"EasyDate")&&n.d(e,"EasyDate",function(){return r.EasyDate}),n.o(r,"FA")&&n.d(e,"FA",function(){return r.FA}),n.o(r,"LMR")&&n.d(e,"LMR",function(){return r.LMR}),n.o(r,"List")&&n.d(e,"List",function(){return r.List}),n.o(r,"Muted")&&n.d(e,"Muted",function(){return r.Muted}),n.o(r,"PropGrid")&&n.d(e,"PropGrid",function(){return r.PropGrid}),n.o(r,"SearchBox")&&n.d(e,"SearchBox",function(){return r.SearchBox}),n.o(r,"TonvaForm")&&n.d(e,"TonvaForm",function(){return r.TonvaForm});var i=n(68);n.o(i,"EasyDate")&&n.d(e,"EasyDate",function(){return i.EasyDate}),n.o(i,"FA")&&n.d(e,"FA",function(){return i.FA}),n.o(i,"LMR")&&n.d(e,"LMR",function(){return i.LMR}),n.o(i,"List")&&n.d(e,"List",function(){return i.List}),n.o(i,"Muted")&&n.d(e,"Muted",function(){return i.Muted}),n.o(i,"PropGrid")&&n.d(e,"PropGrid",function(){return i.PropGrid}),n.o(i,"SearchBox")&&n.d(e,"SearchBox",function(){return i.SearchBox}),n.o(i,"TonvaForm")&&n.d(e,"TonvaForm",function(){return i.TonvaForm});var o=n(69);n.o(o,"EasyDate")&&n.d(e,"EasyDate",function(){return o.EasyDate}),n.o(o,"FA")&&n.d(e,"FA",function(){return o.FA}),n.o(o,"LMR")&&n.d(e,"LMR",function(){return o.LMR}),n.o(o,"List")&&n.d(e,"List",function(){return o.List}),n.o(o,"Muted")&&n.d(e,"Muted",function(){return o.Muted}),n.o(o,"PropGrid")&&n.d(e,"PropGrid",function(){return o.PropGrid}),n.o(o,"SearchBox")&&n.d(e,"SearchBox",function(){return o.SearchBox}),n.o(o,"TonvaForm")&&n.d(e,"TonvaForm",function(){return o.TonvaForm});n(33),n(43);var s=n(70);n.d(e,"TonvaForm",function(){return s.a});n(31)},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(0),i=n(1),o=n(4),s=n(20),a=n(31),u=n(33),c=function(){function t(t){this.rows=[],this.uid=Object(s.a)(),this.props=t,this.buildRows(t),this.createControl=t.createControl,this.onSubmit=this.onSubmit.bind(this)}return Object.defineProperty(t.prototype,"hasError",{get:function(){var t=this.rows.map(function(t,e){return e+": "+t.hasError+"\n"});return console.log(t),this.rows.some(function(t){return t.hasError})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nothing",{get:function(){return this.rows.every(function(t){return!t.filled})},enumerable:!0,configurable:!0}),t.prototype.readValues=function(){for(var t={},e=0,n=this.rows;e<n.length;e++){n[e].readValues(t)}return t},t.prototype.clear=function(){for(var t=0,e=this.rows;t<e.length;t++){e[t].clear()}},t.prototype.clearErrors=function(){for(var t=0,e=this.rows;t<e.length;t++){e[t].clearErrors()}},t.prototype.setError=function(t,e){for(var n=0,r=this.rows;n<r.length;n++){r[n].setError(t,e)}},t.prototype.setInitValues=function(t){if(void 0!==t)for(var e=0,n=this.rows;e<n.length;e++){n[e].setInitValues(t)}},t.prototype.buildRows=function(t){var e=t.formRows,n=t.createRow;if(void 0!==e){for(var r=0,o=e;r<o.length;r++){var s=o[r];this.rows.push(this.buildRow(s,n))}!0!==this.props.readOnly&&(this.buttonsRow=this.buildRow({createControl:this.createButtons.bind(this)},void 0))}else this.rows.push(Object(u.b)(this,i.createElement("div",{className:"text-warning"},"TonvaForm need formRows defined")))},t.prototype.buildRow=function(t,e){var n;return void 0!==t.type?n=u.b:void 0===(n=t.createRow)&&void 0===(n=e)&&(n=u.a),n(this,t)},t.prototype.createButtons=function(t,e){return new a.a(t)},t.prototype.isOk=function(){for(var t=!0,e=0,n=this.rows;e<n.length;e++){n[e].isOk()||(t=!1)}return t},t.prototype.render=function(){var t=this;return i.createElement("form",{onSubmit:this.onSubmit},this.rows.map(function(e,n){return e.render(t.uid+n)}),this.buttons())},t.prototype.buttons=function(){if(void 0!==this.buttonsRow)return this.buttonsRow.render(this.uid+this.rows.length)},t.prototype.onSubmit=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return t.preventDefault(),this.isOk()?(e=this.readValues(),[4,this.props.onSubmit(e)]):[2];case 1:return n.sent(),[2]}})})},r.c([o.e],t.prototype,"hasError",null),r.c([o.e],t.prototype,"nothing",null),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(1),i=n.n(r),o=n(3);function s(t,e){return i.a.createElement(o.FA,{className:t,name:e,fixWidth:!0})}var a={tuid:s("text-info","list-alt"),action:s("text-info","hand-o-right"),map:s("text-muted","list-ul"),book:s("text-muted","book"),query:s("text-warning","search"),history:s("text-info","hand-o-right"),pending:s("text-info","forward"),sheet:s("text-primary","wpforms")}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),i=function(t){function e(e,n){var r=t.call(this,n)||this;return r.cUq=e,r}return r.d(e,t),e}(n(2).Controller)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.userAppUnits=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("tie/user-app-units",{app:t})];case 1:return[2,e.sent()]}})})},e}(n(2).CenterApi))("tv/",void 0)},function(t,e,n){"use strict";var r=n(0),i=n(4),o=n(2),s=n(7),a=n(1),u=n.n(a),c=n(5),l=n(3),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.newClick=function(){return e.event("new")},e.schemaClick=function(){return e.event("schema")},e.archivesClick=function(){return e.event("archives")},e.sheetStateClick=function(t){return e.event("state",t)},e.renderState=function(t,n){var r=t.state,i=t.count;if(0===i)return null;var o=a.createElement("span",{className:"badge badge-success ml-5 align-self-end"},i);return a.createElement(l.LMR,{className:"px-3 py-2",left:e.controller.getStateLabel(r),right:o})},e.view=Object(c.a)(function(){var t,n=e.controller.statesCount.filter(function(t){return t.count}),r=a.createElement("button",{className:"btn btn-outline-primary",onClick:e.archivesClick},"\u5df2\u5f52\u6863");return!0===e.isDev&&(t=a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.schemaClick},"\u6a21\u677f")),a.createElement(o.Page,{header:e.label},a.createElement(l.LMR,{className:"mx-3 my-2",right:r},a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:e.newClick},"\u65b0\u5efa"),t),a.createElement(l.List,{className:"my-2",header:a.createElement(l.Muted,{className:"mx-3 my-1"},"\u5f85\u5904\u7406",e.label),none:"[ \u65e0 ]",items:n,item:{render:e.renderState,onClick:e.sheetStateClick}}))}),e}return r.d(e,t),e.prototype.open=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(s.b),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),e=this.vForm.values,[4,this.controller.onSave(t,e)];case 1:return n.sent(),[2]}})})},e.view=function(){return a.createElement(o.Page,{header:e.label},e.vForm.render())},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),this.openPage(this.view),[2]})})},e}(s.b),p=n(27),f={width:"8rem"},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.flowRow=function(t,e){var n,r=t.date,i=(t.user,t.preState,t.state),o=t.action;switch(void 0===o&&(o=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-primary",name:"pencil-square-o"})," \u5236\u5355")),i){case"$":break;case"#":n=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-success",name:"file-archive-o"}));break;default:n=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-muted",name:"arrow-right"})," \xa0 ",i)}return a.createElement(l.LMR,{left:a.createElement("div",{className:"pl-3 py-2",style:f},o),right:a.createElement("div",{className:"p-2"},a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:r})))},a.createElement("div",{className:"p-2"},n))},e.sheetView=function(){var t,n=e.sheetData,r=n.brief,i=n.flows;return"-"===r.state&&(t=a.createElement("div",{className:"mx-3 my-2",style:{color:"red"}},"\u672c\u5355\u636e\u4f5c\u5e9f")),a.createElement("div",null,t,e.vForm.render(),a.createElement(l.List,{header:a.createElement(l.Muted,{className:"mx-3 my-1"},"\u6d41\u7a0b"),items:i,item:{render:e.flowRow}}))},e}return r.d(e,t),e}(s.b),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,Promise,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this.vForm.getValues(),[4,this.controller.saveSheet(t,this.vForm.values)];case 1:return e.sent(),this.closePage(),this.returnCall(this.vForm.values),[2]}})})},e.view=function(){return a.createElement(o.Page,{header:e.label},e.vForm.render())},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(this.onSubmit,t.data,p.a.edit),this.openPage(this.view),[2]})})},e}(m),b=n(6),y=n.n(b),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actionClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return e=this.sheetData.brief,n=e.id,i=e.flow,o=e.state,[4,this.controller.action(n,i,o,t.name)];case 1:return r.sent(),this.ceasePage(),this.openPage(this.acted),[2]}})})},e.deleteClick=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return alert("\u5355\u636e\u4f5c\u5e9f\uff1a\u7a0b\u5e8f\u6b63\u5728\u8bbe\u8ba1\u4e2d"),[2]})})},e.editClick=function(){return r.b(e,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.editSheet(this.sheetData)];case 1:return t=e.sent(),this.vForm.setValues(t),[2]}})})},e.page=function(){var t,n,r=e.sheetData.brief,i=r.state,s=r.no,a=e.controller.getStateLabel(i),c=e.entity.states.find(function(t){return t.name===i});if(void 0===c){var l=void 0,h=void 0;switch(i){default:l="\u4e0d\u8ba4\u8bc6\u7684\u5355\u636e\u72b6\u6001'"+i+"'",h="text-info";break;case"-":l="\u5df2\u4f5c\u5e9f",h="text-danger";break;case"#":l="\u5df2\u5f52\u6863",h="text-success"}t=u.a.createElement("div",{className:y()(h)},"[",l,"]")}else t=u.a.createElement("div",{className:"flex-grow-1"},c.actions.map(function(t,n){return u.a.createElement("button",{key:n,className:"btn btn-primary mr-2",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel(i,t.name))})),"$"===i&&(n=u.a.createElement("div",null,u.a.createElement("button",{className:"btn btn-outline-info ml-2",onClick:e.editClick},"\u4fee\u6539"),u.a.createElement("button",{className:"btn btn-outline-danger ml-2",onClick:e.deleteClick},"\u4f5c\u5e9f")));return u.a.createElement(o.Page,{header:e.label+":"+a+"-"+s},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},t,n),u.a.createElement(e.sheetView,null)))},e.acted=function(){var t=e.sheetData.brief.discription;return u.a.createElement(o.Page,{header:"\u5df2\u5904\u7406",back:"close"},u.a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},u.a.createElement("div",{className:"p-3"},t),u.a.createElement("div",{className:"text-success"},u.a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),u.a.createElement("div",{className:"p-3"},u.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de"))))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,t.data),this.openPage(this.page),[2]})})},e}(m),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return a.createElement(o.Page,{header:e.label+"\u6a21\u677f"},a.createElement("pre",{className:"mx-3 my-2"},e.entity.schemaStringify()))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(s.b),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.archiveClick=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return 1===t.processing?[2]:(this.event("archived",t),[2])})})},e.archiveRow=function(t,e){t.id,t.no,t.discription;var n=t.date,r=a.createElement(a.Fragment,null,1===t.processing?"... ":"",t.no," \xa0 ",t.discription),i=a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:n}));return a.createElement(l.LMR,{className:"px-3 py-2",left:r,right:i})},e.view=function(){return a.createElement(o.Page,{header:"\u5df2\u5f52\u6863"+e.label},a.createElement(l.List,{items:e.list,item:{render:e.archiveRow,onClick:e.archiveClick}}))},e}return r.d(e,t),e.prototype.open=function(){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(e){switch(e.label){case 0:return t=this,[4,this.entity.getArchives(void 0,10)];case 1:return t.list=e.sent(),this.openPage(this.view),[2]}})})},e}(s.b),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rowClick=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){return 1===t.processing?(this.event("processing",t.id),[2]):(this.event("action",t.id),[2])})})},e.onScrollBottom=function(){console.log("onScrollBottom"),e.controller.pageStateItems.more()},e.rowContent=function(t){t.id;var e=t.no,n=t.discription,r=t.date,i=t.processing,o=a.createElement(a.Fragment,null,e," \xa0 ",a.createElement(l.Muted,null,n)," ",1===i?"...":""),s=a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:r}));return a.createElement(l.LMR,{className:"px-3 py-2",left:o,right:s})},e.renderRow=function(t,n){return a.createElement(e.row,r.a({},t))},e.view=function(){var t=e.controller.pageStateItems;return a.createElement(o.Page,{header:e.label+" - "+e.stateLabel,onScrollBottom:e.onScrollBottom},a.createElement(l.List,{items:t,item:{render:e.renderRow,onClick:e.rowClick}}))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.row=this.ui.listRow||this.rowContent,this.stateName=t.state,this.stateLabel=this.controller.getStateLabel(this.stateName),[4,this.controller.pageStateItems.first(this.stateName)];case 1:return e.sent(),this.openPage(this.view),[2]}})})},e}(s.b),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){var t=e.sheetData.brief;return a.createElement(o.Page,{header:e.label+":-"+t.no},a.createElement(e.sheetView,null))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,this.sheetData.data),this.openPage(this.view),[2]})})},e}(m),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.restart=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.ceasePage(),[4,this.event("new")];case 1:return t.sent(),[2]}})})},e.actionClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return this.ceasePage(),e=this.brief,n=e.id,i=e.flow,o=e.state,[4,this.controller.action(n,i,o,t.name)];case 1:return r.sent(),this.openPage(this.acted),[2]}})})},e.buttons=a.createElement(a.Fragment,null,a.createElement("button",{className:"btn btn-outline-primary mr-3",onClick:e.restart},"\u7ee7\u7eed\u5f00\u5355"),a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de")),e.view=function(){var t=e.entity.states,n=t.find(function(t){return"$"===t.name}),r=a.createElement(a.Fragment,null,n.actions.map(function(t,n){return a.createElement("button",{key:n,className:"btn btn-primary mr-3",onClick:function(){return e.actionClick(t)}},e.controller.getActionLabel("$",t.name))}));return a.createElement(o.Page,{header:"\u5df2\u4fdd\u5b58",back:"close"},a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u4fdd\u5b58\uff01\u7cfb\u7edf\u5c1a\u672a\u5904\u7406"),a.createElement("div",{className:"p-3"},r,e.buttons)))},e.acted=function(){return a.createElement(o.Page,null,a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),a.createElement("div",{className:"p-3"},e.buttons)))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.brief=t,this.openPage(this.view),[2]})})},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e}(s.b)),N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=function(){var t=e.sheetData.brief,n=t.state,r=t.no,i=e.controller.getStateLabel(n);return u.a.createElement(o.Page,{header:e.label+":"+i+"-"+r},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},"\u6b63\u5728\u5904\u7406\u4e2d..."),u.a.createElement(e.sheetView,null)))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.sheetData=t,this.vForm=this.createForm(void 0,t.data),this.openPage(this.page),[2]})})},e}(m),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statesCount=i.l.array([],{deep:!0}),e.onSave=function(t,n){return r.b(e,void 0,Promise,function(){var e;return r.e(this,function(r){switch(r.label){case 0:return[4,this.saveSheet(t,n)];case 1:return e=r.sent(),this.ceasePage(),[4,this.showSaved(e)];case 2:return r.sent(),[2]}})})},e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadStateSheetCount()];case 1:return t.sent(),this.pageStateItems=this.entity.createPageStateItems(),[4,this.openVPage(this.VSheetMain)];case 2:return t.sent(),[2]}})})},e.prototype.onMessage=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,o;return r.e(this,function(r){return e=t.type,n=t.body,i=t.from,o=t.to,t.push,"sheet"===e&&this.onSheet(i,o,n),[2]})})},e.prototype.onSheet=function(t,e,n){var r=this.user.id,i=n.id,o=n.preState,s=n.state;console.log({$:"onMessage sheet",from:t,to:e.join(","),id:i,preState:o,state:s,me:r,sheetData:n}),t===r&&this.sheetActPreState(i,o),void 0!==e.find(function(t){return t===r})&&this.sheetActState(i,s,n)},e.prototype.sheetActPreState=function(t,e){if(this.changeStateCount(e,-1),void 0!==this.curState&&this.curState===e){var n=this.pageStateItems.items.findIndex(function(e){return e.id===t});n>=0&&this.pageStateItems.items.splice(n,1)}},e.prototype.sheetActState=function(t,e,n){this.changeStateCount(e,1),void 0!==this.curState&&this.curState===e&&this.pageStateItems.items.findIndex(function(e){return e.id===t})<0&&this.pageStateItems.items.push(n)},e.prototype.changeStateCount=function(t,e){if(void 0!==t){var n=this.statesCount.findIndex(function(e){return e.state===t});if(console.log({$:"changeState",state:t,delta:e,index:n}),!(n<0)){var r=this.statesCount[n];r.count+=e,r.count<0&&(r.count=0)}}},Object.defineProperty(e.prototype,"VSheetMain",{get:function(){return this.ui&&this.ui.main||h},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetNew",{get:function(){return this.ui.sheetNew||d},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetSaved",{get:function(){return this.ui.sheetSaved||P},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetEdit",{get:function(){return this.ui.sheetEdit||v},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetSchema",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VArchives",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VArchived",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetList",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetAction",{get:function(){return this.ui.sheetAction||g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VSheetProcessing",{get:function(){return N},enumerable:!0,configurable:!0}),e.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:switch(t){case"new":return[3,2];case"schema":return[3,3];case"archives":return[3,4];case"state":return[3,5];case"archived":return[3,6];case"action":return[3,8];case"processing":return[3,10]}return[3,1];case 1:return[2];case 2:return n=this.VSheetNew,[3,12];case 3:return n=this.VSheetSchema,[3,12];case 4:return n=this.VArchives,[3,12];case 5:return this.curState=e.state,n=this.VSheetList,[3,12];case 6:return[4,this.showArchived(e)];case 7:return r.sent(),[2];case 8:return[4,this.showAction(e)];case 9:return r.sent(),[2];case 10:return[4,this.showProcessing(e)];case 11:return r.sent(),[2];case 12:return[4,this.openVPage(n,e)];case 13:return r.sent(),[2]}})})},e.prototype.startSheet=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.beforeStart()];case 1:return!1===e.sent()?[2]:[4,this.onEvent("action",t)];case 2:return e.sent(),[2]}})})},e.prototype.showAction=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(t)];case 1:return e=n.sent(),Object(o.postWsToTop)({body:{$type:"msg",action:"$sheet",msg:{id:t,uq:this.cUq.id,state:e.brief.state}}}),[4,this.openVPage(this.VSheetAction,e)];case 2:return n.sent(),[2]}})})},e.prototype.showProcessing=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(t)];case 1:return e=n.sent(),[4,this.openVPage(this.VSheetProcessing,e)];case 2:return n.sent(),[2]}})})},e.prototype.editSheet=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.vCall(this.VSheetEdit,t)];case 1:return[2,e.sent()]}})})},e.prototype.showArchived=function(t){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getArchived(t.id)];case 1:return e=n.sent(),[4,this.openVPage(this.VArchived,e)];case 2:return n.sent(),[2]}})})},e.prototype.showSaved=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VSheetSaved,t)];case 1:return e.sent(),[2]}})})},e.prototype.getStateUI=function(t){var e=this.res.states;if(void 0!==e)return e[t]},e.prototype.getStateLabel=function(t){var e=this.getStateUI(t),n=e&&e.label||t;switch(n){default:return n;case"$":return"\u65b0\u5355"}},e.prototype.getActionLabel=function(t,e){var n=this.getStateUI(t);if(void 0===n)return e;var r=n.actions;if(void 0===r)return e;var i=r[e];return i&&i.label||e},e.prototype.loadStateSheetCount=function(){return r.b(this,void 0,Promise,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return this.statesCount.clear(),[4,this.entity.stateSheetCount()];case 1:return e=n.sent(),(t=this.statesCount).splice.apply(t,[0,0].concat(e)),[2]}})})},e.prototype.getSheetData=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.getSheet(t)];case 1:return[2,e.sent()]}})})},e.prototype.getArchived=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.getArchive(t)];case 1:return[2,e.sent()]}})})},e.prototype.saveSheet=function(t,e){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return n=this.ui.sheetTitle,i=void 0===n?this.label:n(e,this.x),[4,this.entity.save(i,t)];case 1:return[2,r.sent()]}})})},e.prototype.action=function(t,e,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.entity.action(t,e,n,i)];case 1:return[2,r.sent()]}})})},e}(s.a);n.d(e,"a",function(){return S})},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(32),s=n(17),a=n(7),u=n(1),c=n.n(u),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return u.createElement(i.Page,{header:e.label},"Book")},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(a.b),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VBookMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VBookMain",{get:function(){return l},enumerable:!0,configurable:!0}),e}(a.a),d=n(47),p=n(50),f=n(36),m=n(25),v=n(49),b=n(11),y=n(3),g=function(t){function e(e){var n=t.call(this,e)||this;n.isSysVisible=!1,n.view=function(){var t,e=n.controller,r=e.res,i=e.uq,o=e.error,s={render:function(t,e){return t.render()},onClick:void 0},a=[{header:r.tuid||"TUID",items:n.tuidLinks},{cn:"my-2",header:r.map||"MAP",items:n.mapLinks},{cn:"my-2",header:r.sheet||"SHEET",items:n.sheetLinks},{cn:"my-2",header:r.action||"ACTION",items:n.actionLinks},{cn:"my-2",header:r.query||"QUERY",items:n.queryLinks},{cn:"mt-2 mb-4",header:r.book||"BOOK",items:n.bookLinks},{cn:"mt-2 mb-4",header:r.history||"HISTORY",items:n.historyLinks},{cn:"mt-2 mb-4",header:r.pending||"PENDING",items:n.pendingLinks}];return t=void 0!==o?c.a.createElement("div",{className:"p-3 text-danger"},"\u8fde\u63a5\u9519\u8bef: ",o):a.map(function(t,e){var n=t.cn,r=t.header,i=t.items;return i.length>0&&c.a.createElement(y.List,{key:e,className:n,header:c.a.createElement("div",{className:"px-3 py-1 bg-light"},c.a.createElement(y.Muted,null,r)),items:i,item:s})}),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"px-3 py-1 small"},r.uq||i),t)};var r=e.entities,i=r.tuidArr,o=r.mapArr,a=r.sheetArr,u=r.actionArr,l=r.queryArr,h=r.bookArr,d=r.historyArr,p=r.pendingArr;return n.tuidLinks=i.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cTuidMain(t))}),n.mapLinks=o.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cMap(t))}),n.sheetLinks=a.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cSheet(t))}),n.actionLinks=u.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cAction(t))}),n.queryLinks=l.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cQuery(t))}),n.bookLinks=h.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cBook(t))}),n.historyLinks=d.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cHistory(t))}),n.pendingLinks=p.filter(function(t){return n.isVisible(t)}).map(function(t){return new s.a(n.controller.cPending(t))}),n}return r.d(e,t),e.prototype.isVisible=function(t){return!0!==t.sys||this.isSysVisible},e.prototype.render=function(t){return void 0===this.view?c.a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):c.a.createElement(this.view)},e}(i.View),w=n(52),E=n(51);function k(t){if(void 0!==t)for(var e in t)t[e.toLowerCase()]=t[e]}var C=function(t){function e(e,n,r,s,a,u){var c=t.call(this,Object(i.resLang)(u.res))||this;c.schemaLoaded=!1,c.isSysVisible=!1,c.cApp=e,c.uq=n,c.id=s,k(u.tuid),k(u.sheet),k(u.map),k(u.query),k(u.action),k(u.book),k(u.history),k(u.pending),c.ui=u,c.CTuidMain=u.CTuidMain||m.d,c.CTuidEdit=u.CTuidEdit||m.a,c.CTuidList=u.CTuidList||m.c,c.CTuidSelect=u.CTuidSelect||m.e,c.CTuidInfo=u.CTuidInfo||m.b,c.CQuery=u.CQuery||f.a,c.CQuerySelect=u.CQuerySelect||f.b,c.CMap=u.CMap||v.a,c.CAction=u.CAction||p.a,c.CSheet=u.CSheet||d.a,c.CBook=u.CBook||h,c.CHistory=u.CHistory||w.a,c.CPending=u.CPending||E.a;var l,b,y=n.split("/");switch(y.length){case 1:l="$$$",b=y[0];break;case 2:l=y[0],b=y[1];break;default:return void console.log("uq must be uqOwner/uqName format")}var g,C,P=document.location.hash,N=void 0===P||""===P?"debug/":"tv/";return g=null===a||void 0===a||"*"===a?[]:a.split(";").map(function(t){return t.trim()}).filter(function(t){return t.length>0}),C="$$$/$unitx"===n?new i.UnitxApi(i.appInFrame.unit):new i.UqApi(N,l,b,g,!0),c.entities=new o.a(c,C,r),c}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2]})})},e.prototype.loadEntites=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entities.loadAccess()];case 1:return t.sent(),[2]}})})},e.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),!0===this.schemaLoaded?[2]:[4,this.loadEntites()];case 1:for(t in r.sent(),void 0===this.id&&(this.id=this.entities.uqId),this.ui)if(void 0!==(e=this.ui[t])&&(e.caption,void 0!==(n=e.collection)))for(i in n)void 0===this.entities[t](i)&&console.warn(t+":'"+i+"' is not uq entity");return this.schemaLoaded=!0,[2];case 2:return o=r.sent(),console.error(o),[2,this.error=o];case 3:return[2]}})})},e.prototype.getQuerySearch=function(t){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(n){switch(n.label){case 0:return void 0!==(e=this.entities.query(t))?[3,1]:(alert("QUERY "+t+" \u6ca1\u6709\u5b9a\u4e49!"),[3,3]);case 1:return[4,e.loadSchema()];case 2:n.sent(),e.returns.length>1&&alert("QUERY "+t+" \u8fd4\u56de\u591a\u5f20\u8868, \u65e0\u6cd5\u505aQuerySearch"),n.label=3;case 3:return[2,e]}})})},e.prototype.getTuidPlaceHolder=function(t){var e=this.res,n=e.tuidPlaceHolder,r=e.entity,i=t.name;if(void 0!==r){var o=r[i];void 0!==o&&o.label}return n||"Select"},e.prototype.getNone=function(){return this.res.none||"none"},e.prototype.isVisible=function(t){return!0!==t.sys||this.isSysVisible},e.prototype.navSheet=function(t,e){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return void 0===(n=this.entities.sheetFromTypeId(t))?(alert("sheetTypeId "+t+" is not exists!"),[2]):[4,this.cSheet(n).startSheet(e)];case 1:return r.sent(),[2]}})})},e.prototype.sheet=function(t){return this.entities.sheet(t)},e.prototype.action=function(t){return this.entities.action(t)},e.prototype.query=function(t){return this.entities.query(t)},e.prototype.book=function(t){return this.entities.book(t)},e.prototype.map=function(t){return this.entities.map(t)},e.prototype.history=function(t){return this.entities.history(t)},e.prototype.pending=function(t){return this.entities.pending(t)},e.prototype.tuid=function(t){return this.entities.tuid(t)},e.prototype.tuidDiv=function(t,e){var n=this.entities.tuid(t);if(void 0!==n){var r=n.divs;if(void 0!==r)return r[e]}},e.prototype.cSheetFromName=function(t){var e=this.entities.sheet(t);if(void 0!==e)return this.cSheet(e)},e.prototype.cActionFromName=function(t){var e=this.entities.action(t);if(void 0!==e)return this.cAction(e)},e.prototype.cQueryFromName=function(t){var e=this.entities.query(t);if(void 0!==e)return this.cQuery(e)},e.prototype.cBookFromName=function(t){var e=this.entities.book(t);if(void 0!==e)return this.cBook(e)},e.prototype.cMapFromName=function(t){var e=this.entities.map(t);if(void 0!==e)return this.cMap(e)},e.prototype.cHistoryFromName=function(t){var e=this.entities.history(t);if(void 0!==e)return this.cHistory(e)},e.prototype.cPendingFromName=function(t){var e=this.entities.pending(t);if(void 0!==e)return this.cPending(e)},e.prototype.cTuidMainFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidMain(e)},e.prototype.cTuidEditFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidEdit(e)},e.prototype.cTuidInfoFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidInfo(e)},e.prototype.cTuidSelectFromName=function(t){var e=this.entities.tuid(t);if(void 0!==e)return this.cTuidSelect(e)},e.prototype.cFromName=function(t,e){switch(t){case"sheet":var n=this.entities.sheet(e);if(void 0===n)return;return this.cSheet(n);case"action":var r=this.entities.action(e);if(void 0===r)return;return this.cAction(r);case"tuid":var i=this.entities.tuid(e);if(void 0===i)return;return this.cTuidMain(i);case"query":var o=this.entities.query(e);if(void 0===o)return;return this.cQuery(o);case"book":var s=this.entities.book(e);if(void 0===s)return;return this.cBook(s);case"map":var a=this.entities.map(e);if(void 0===a)return;return this.cMap(a);case"history":var u=this.entities.history(e);if(void 0===u)return;return this.cHistory(u);case"pending":var c=this.entities.pending(e);if(void 0===c)return;return this.cPending(c)}},e.prototype.linkFromName=function(t,e){return this.link(this.cFromName(t,e))},e.prototype.getUI=function(t){var e,n,r=t.name,i=t.typeName;if(void 0!==this.ui){var o=this.ui[i];void 0!==o&&(e=o[r])}var s=this.res.entity;return void 0!==s&&(n=s[r]),{ui:e||{},res:n||{}}},e.prototype.link=function(t){return new s.a(t)},Object.defineProperty(e.prototype,"tuidLinks",{get:function(){var t=this;return this.entities.tuidArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cTuidMain(e))})},enumerable:!0,configurable:!0}),e.prototype.cTuidMain=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidMain||this.CTuidMain)(this,t,n,r)},e.prototype.cTuidEdit=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidEdit||this.CTuidEdit)(this,t,n,r)},e.prototype.cTuidList=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidList||this.CTuidList)(this,t,n,r)},e.prototype.cTuidSelect=function(t){var e=this.getUI(t.owner||t),n=e.ui,r=e.res;return new(n&&n.CTuidSelect||this.CTuidSelect)(this,t,n,r)},e.prototype.cTuidInfo=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CTuidInfo||this.CTuidInfo)(this,t,n,r)},e.prototype.cSheet=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CSheet||this.CSheet)(this,t,n,r)},Object.defineProperty(e.prototype,"sheetLinks",{get:function(){var t=this;return this.entities.sheetArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cSheet(e))})},enumerable:!0,configurable:!0}),e.prototype.cAction=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CAction||this.CAction)(this,t,n,r)},Object.defineProperty(e.prototype,"actionLinks",{get:function(){var t=this;return this.entities.actionArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cAction(e))})},enumerable:!0,configurable:!0}),e.prototype.cQuery=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CQuery||this.CQuery)(this,t,n,r)},e.prototype.cQuerySelect=function(t){var e=this.entities.query(t);if(void 0!==e){var n=this.getUI(e),r=n.ui,i=n.res;return new(r&&r.CQuerySelect||this.CQuerySelect)(this,e,r,i)}},Object.defineProperty(e.prototype,"queryLinks",{get:function(){var t=this;return this.entities.queryArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cQuery(e))})},enumerable:!0,configurable:!0}),e.prototype.cBook=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CBook||this.CBook)(this,t,n,r)},Object.defineProperty(e.prototype,"bookLinks",{get:function(){var t=this;return this.entities.bookArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cBook(e))})},enumerable:!0,configurable:!0}),e.prototype.cHistory=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CHistory||this.CHistory)(this,t,n,r)},Object.defineProperty(e.prototype,"historyLinks",{get:function(){var t=this;return this.entities.historyArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cHistory(e))})},enumerable:!0,configurable:!0}),e.prototype.cPending=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CPending||this.CPending)(this,t,n,r)},Object.defineProperty(e.prototype,"pendingLinks",{get:function(){var t=this;return this.entities.pendingArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cPending(e))})},enumerable:!0,configurable:!0}),e.prototype.cMap=function(t){var e=this.getUI(t),n=e.ui,r=e.res;return new(n&&n.CMap||this.CMap)(this,t,n,r)},Object.defineProperty(e.prototype,"mapLinks",{get:function(){var t=this;return this.entities.mapArr.filter(function(e){return t.isVisible(e)}).map(function(e){return t.link(t.cMap(e))})},enumerable:!0,configurable:!0}),e.prototype.getTuidContent=function(t){var e,n=t.owner;return void 0===n?(e=this.getUI(t).ui)&&e.content||b.b:(e=this.getUI(n).ui)&&e.divs&&e.divs[t.name].content||b.b},e.prototype.showTuid=function(t,e){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return n=t.owner,[4,this.cTuidInfo(n||t).start(e)];case 1:return r.sent(),[2]}})})},Object.defineProperty(e.prototype,"VUq",{get:function(){return g},enumerable:!0,configurable:!0}),e.prototype.render=function(){return new this.VUq(this).render()},e}(i.Controller);n.d(e,"a",function(){return C})},function(t,e,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(7),a=n(32),u=n(1),c=n(5),l=n(6),h=n.n(l),d=n(3),p=n(2),f=n(12),m=n(11),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemRender=function(t,n){return u.createElement(e.ItemRow,{item:t})},e.ItemRow=Object(c.a)(function(t){var n,r,i,o,s,a,c=t.item,l=(c.tuid,c.box),p=c.children,v=c.isLeaf,b=c.keyIndex,y=c.values,g=e.controller.keyUIs[b],w=g.content,E=g.valuesContent,k=g.none;if(!1===e.isFrom&&(n=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.addClick(c)}},u.createElement(d.FA,{name:"plus"})),r=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return e.controller.removeClick(c)}},u.createElement(d.FA,{className:"text-info",name:"trash"}))),!1===v?i=0===b?n:u.createElement(u.Fragment,null,r," \xa0 ",n):b>0&&(i=r),!0===v)o=void 0,y&&(a=(E||m.b)(y,e.x));else{s="border-bottom";var C=k&&k(e.x);o=u.createElement(d.List,{className:"ml-4",items:p,item:{onClick:void 0,render:e.itemRender},none:C})}var P=u.createElement("div",{className:"py-1 pr-3"},Object(f.b)(l,w,e.x));return u.createElement("div",{className:"d-flex flex-column"},u.createElement(d.LMR,{className:h()("px-3","py-2",s),left:P,right:i},u.createElement("div",{className:"py-1"},a)),o)}),e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.isFrom=this.controller.isFrom,this.openPage(this.view),[2]})})},Object.defineProperty(e.prototype,"view",{get:function(){var t=this;return function(){return u.createElement(p.Page,{header:t.label},u.createElement(d.List,{items:t.controller.items,item:{className:"my-2",onClick:void 0,render:t.itemRender}}))}},enumerable:!0,configurable:!0}),e}(s.b),b=n(4),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onValuesSubmit=function(){return r.b(e,void 0,void 0,function(){var t;return r.e(this,function(e){return this.ceasePage(),t=this.vForm.getValues(),this.returnCall(t),[2]})})},e.view=function(){return u.createElement(p.Page,null,e.vForm.render())},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.vForm=this.createForm(this.onValuesSubmit),this.openPageElement(u.createElement(this.view,null)),[2]})})},e}(s.b),g=function(){return function(t,e,n,r){this.children=b.l.array([],{deep:!0}),this.parent=t,this.tuid=e,this.box=n,this.keyIndex=r,this.isLeaf=!1}}(),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.addClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,o,s,u,c,l,h,d,p,f,m,v,b,g,w,E,k,C,P,N,S,x,F,T,O;return r.e(this,function(r){switch(r.label){case 0:if(e=t.keyIndex,n=t.children,i=this.keyFields.length,o=i-1,(s=e+1)>=i)return[2];for(u=this.keyFields[s],c=u.name,l=u._tuid,h={},d={},p=t;void 0!==p;p=p.parent)f=p.keyIndex,m=p.box,v=this.keyFields[f].name,h[v]=d[v]=m.id;return[4,this.searchOnKey(u,h)];case 1:return void 0===(b=r.sent())||b<=0?[2]:(l.useId(b),g=l.boxId(b),w={},E={},e+1!==o?[3,4]:(l.useId(b),E[c]=w[c]=g,this.entity.fields.length>0?[4,this.vCall(y,d)]:[3,3]));case 2:for(C in k=r.sent())E[C]=w[C]=k[C];r.label=3;case 3:return[3,5];case 4:for(E[c]=d[c]=g,C=s+1;C<o;C++)d[this.keyFields[C].name]=0;for(w[this.keyFields[o].name]=0,T=this.entity.fields,P=0,N=T;P<N.length;P++)S=N[P],S.name,x=S.type,!0!==S.null&&(w[S.name]=Object(a.b)(x));r.label=5;case 5:return d.arr1=[w],[4,this.entity.actions.add.submit(d)];case 6:return r.sent(),(F=n.findIndex(function(t){return t.box.id===b}))<0?n.push(this.createItem(t,l,g,s,E)):void 0!==(T=this.entity.fields)&&T.length>0&&(O=n[F],n.splice(F,1),O.values=E,n.splice(F,0,O)),this.removeCeased(),[2]}})})},e.removeClick=function(t){return r.b(e,void 0,void 0,function(){var e,n,i,s,a,u,c,l,h,d,p,f,m,v,b,y;return r.e(this,function(r){switch(r.label){case 0:if(e=this.keyFields[t.keyIndex],n=e._tuid,i=this.cUq.cTuidMain(n.Main),s=i.getLable(n),a=this.res.confirmDelete||o.a.template("do you really want to remove ${label}?"),!1===confirm(a({label:s})))return[2];for(u=this.entity,l=(c={}).arr1=[],h={},l.push(h),d=t;void 0!==d;d=d.parent)p=d.keyIndex,h[this.keyFields[p].name]=d.box.id;for(f=this.keyFields.length,m=t.keyIndex+1;m<f;m++)v=this.keyFields[m],h[v.name]=-1;return[4,u.actions.del.submit(c)];case 1:return r.sent(),b=t.parent.children,(y=b.findIndex(function(e){return e===t}))>=0&&b.splice(y,1),[2]}})})},e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){var t,e,n,i,s,a,u,c,l,h,d,p,f,v;return r.e(this,function(r){switch(r.label){case 0:return t=this.entity,e=t.keys,n=t.schemaFrom,this.isFrom=void 0!==n,[4,(i=this.entity.queries.all).query({})];case 1:for(s=r.sent(),a=s.ret,u=e.length,this.keyUIs=o.a.clone(this.ui.keys||[]),this.keyFields=[],c=i.returns[0].fields,l=0;l<u;l++)this.keyFields.push(c[l]),l>=this.keyUIs.length&&this.keyUIs.push({content:m.b});for(this.items=Object(b.l)([]),h=void 0,d=0,p=a;d<p.length;d++)f=p[d],void 0!==(v=this.addItem(h,f))&&(this.items.push(v),h=v);return[4,this.openVPage(this.VMapMain)];case 2:return r.sent(),[2]}})})},e.prototype.createItem=function(t,e,n,r,i){var o=new g(t,e,n,r);return r===this.keyFields.length-1&&(o.isLeaf=!0,o.values=i),o},e.prototype.addItem=function(t,e){for(var n=void 0,r=this.keyFields.length,i=t,o=0;o<r;o++){var s=this.keyFields[o],a=s.name,u=s._tuid,c=e[a];if(void 0===c)break;var l=c.id;if(0!==o){var h=i.children,d=(i.box,h.length);if(d>0){var p=h[d-1];if(p.box.id===l){i=p;continue}}l>0&&h.push(i=this.createItem(i,u,c,o,e))}else{if(0===l)continue;void 0!==i&&i.box.id===l||(n=i=this.createItem(void 0,u,c,o,e))}}return n},e.prototype.searchOnKey=function(t,e){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=t._tuid,i=t._ownerField,o=this.cUq.cTuidSelect(n),s=e,void 0!==i&&"object"===typeof(s=e[i.name])&&(s=s.id),[4,o.call(s)];case 1:return a=r.sent(),[2,n.getIdFromObj(a)]}})})},Object.defineProperty(e.prototype,"VMapMain",{get:function(){return v},enumerable:!0,configurable:!0}),e}(s.a);n.d(e,"a",function(){return w})},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=n(12),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSubmit=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return t=this.vForm.getValues(),e=this,[4,this.controller.submit(t)];case 1:return e.returns=n.sent(),this.closePage(),this.openPage(this.resultPage),[2]}})})},e.mainPage=function(){var t=e.controller.label;return o.createElement(s.Page,{header:t},e.vForm.render("mx-3 my-2"))},e.resultPage=function(){var t=e.controller.label;return o.createElement(s.Page,{header:t,back:"close"},"\u5b8c\u6210\uff01",o.createElement("pre",null,Object(a.a)(e.returns)))},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onSubmit,t),this.openPage(this.mainPage),[2]})})},e}(i.b),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VActionMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VActionMain",{get:function(){return u},enumerable:!0,configurable:!0}),e.prototype.submit=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return[2,this.entity.submit(t)]})})},e}(i.a);n.d(e,"a",function(){return c})},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return o.createElement(s.Page,{header:e.label},"pending")},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(i.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VPendingMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VPendingMain",{get:function(){return a},enumerable:!0,configurable:!0}),e}(i.a);n.d(e,"a",function(){return u})},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=function(){return o.createElement(s.Page,{header:e.label},"History")},e}return r.d(e,t),e.prototype.open=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.openPage(this.view),[2]})})},e}(i.b),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VHistoryMain)];case 1:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"VHistoryMain",{get:function(){return a},enumerable:!0,configurable:!0}),e}(i.a);n.d(e,"a",function(){return u})},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(9),o=n(4),s=function(){function t(t,e,n,r){this.isChanged=!1,this.itemSchema=t,this.uiItem=e,this.value=r;var i=t.name;this.name=i,this.label=n}return t.prototype.start=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.internalStart()];case 1:return[2,t.sent()]}})})},t.prototype.end=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.internalEnd()];case 1:return t.sent(),[2]}})})},t.prototype.internalEnd=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return i.c.pop(),[2]})})},r.c([o.l],t.prototype,"isChanged",void 0),t}()},,function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(16),i=n(18),o={set:function(t,e){Object(r.i)(t,e),i.a.setCenterToken(e)},clear:function(){Object(r.i)(0,void 0),i.a.setCenterToken(void 0)}}},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(23),s=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.login=function(t){return r.b(this,void 0,Promise,function(){var e,n,i,s,a;return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("login",t)];case 1:switch(typeof(e=r.sent())){default:return[2];case"string":return[2,Object(o.b)(e)];case"object":return n=e.token,i=Object(o.b)(n),s=e.nick,a=e.icon,s&&(i.nick=s),a&&(i.icon=a),[2,i]}return[2]}})})},e.prototype.register=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.post("register",t)];case 1:return[2,e.sent()]}})})},e.prototype.setVerify=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("set-verify",{account:t,type:e})];case 1:return[2,n.sent()]}})})},e.prototype.checkVerify=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("check-verify",{account:t,verify:e})];case 1:return[2,n.sent()]}})})},e.prototype.isExists=function(t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("is-exists",{account:t})];case 1:return[2,e.sent()]}})})},e.prototype.resetPassword=function(t,e,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("reset-password",{account:t,password:e,verify:n,type:i})];case 1:return[2,r.sent()]}})})},e.prototype.userSetProp=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("tie/user-set-prop",{prop:t,value:e})];case 1:return n.sent(),[2]}})})},e}(i.a))("tv/user/",void 0);e.a=s},,function(t,e,n){"use strict"},,,function(t,e,n){"use strict";n.d(e,"a",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return l});var r=n(0),i=n(1),o=n(9),s=n(19),a=n(10),u=function(){function t(t){var e=this;this.isDev=a.j,this.onMessageReceive=function(t){return r.b(e,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.onMessage(t)];case 1:return e.sent(),[2]}})})},this.res=t||{},this.x=this.res.x||{}}return Object.defineProperty(t.prototype,"user",{get:function(){return o.c.user},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLogined",{get:function(){var t=o.c.user;return void 0!==t&&t.id>0},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){o.c.unregisterReceiveHandler(this.receiveHandlerId),this.onDispose()},t.prototype.onDispose=function(){},t.prototype.openVPage=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new t(this).open(e)];case 1:return n.sent(),[2]}})})},t.prototype.renderView=function(t,e){return new t(this).render(e)},t.prototype.event=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.onEvent(t,e)];case 1:return n.sent(),[2]}})})},t.prototype.onEvent=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2]})})},t.prototype.msg=function(t){alert(t)},t.prototype.errorPage=function(t,e){this.openPage(i.createElement(s.a,{header:"App error!"},i.createElement("pre",null,"string"===typeof e?e:e.message)))},t.prototype.onMessage=function(t){},t.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return[2,!0]})})},t.prototype.registerReceiveHandler=function(){this.receiveHandlerId=o.c.registerReceiveHandler(this.onMessageReceive)},t.prototype.start=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.disposer=this.dispose.bind(this),this.registerReceiveHandler(),[4,this.beforeStart()];case 1:return!1===e.sent()?[2]:[4,this.internalStart(t)];case 2:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"isCalling",{get:function(){return void 0!==this._resolve_$},enumerable:!0,configurable:!0}),t.prototype.call=function(t){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(n){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(n,i){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this._resolve_$.push(n),[4,this.start(t)];case 1:return e.sent(),[2]}})})})]})})},t.prototype.vCall=function(t,e){return r.b(this,void 0,Promise,function(){var n=this;return r.e(this,function(i){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(i,o){return r.b(n,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return this._resolve_$.push(i),[4,new t(this).open(e)];case 1:return n.sent(),[2]}})})})]})})},t.prototype.returnCall=function(t){if(void 0!==this._resolve_$){var e=this._resolve_$.pop();void 0!==e?e(t):alert("the Controller call already returned, or not called")}},t.prototype.openPage=function(t){o.c.push(t,this.disposer),this.disposer=void 0},t.prototype.replacePage=function(t){o.c.replace(t,this.disposer),this.disposer=void 0},t.prototype.backPage=function(){o.c.back()},t.prototype.closePage=function(t){o.c.pop(t)},t.prototype.ceasePage=function(t){o.c.ceaseTop(t)},t.prototype.removeCeased=function(){o.c.removeCeased()},t.prototype.regConfirmClose=function(t){o.c.regConfirmClose(t)},t}(),c=function(){function t(t){this.controller=t,this.res=t.res,this.x=t.x}return Object.defineProperty(t.prototype,"isDev",{get:function(){return a.j},enumerable:!0,configurable:!0}),t.prototype.renderVm=function(t,e){return new t(this.controller).render(e)},t.prototype.openVPage=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new t(this.controller).open(e)];case 1:return n.sent(),[2]}})})},t.prototype.event=function(t,e){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.controller.event(t,e)];case 1:return n.sent(),[2]}})})},t.prototype.vCall=function(t,e){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.controller.vCall(t,e)];case 1:return[2,n.sent()]}})})},t.prototype.returnCall=function(t){this.controller.returnCall(t)},t.prototype.openPage=function(t,e){this.controller.openPage(i.createElement(t,e))},t.prototype.replacePage=function(t,e){this.controller.replacePage(i.createElement(t,e))},t.prototype.openPageElement=function(t){this.controller.openPage(t)},t.prototype.replacePageElement=function(t){this.controller.replacePage(t)},t.prototype.backPage=function(){this.controller.backPage()},t.prototype.closePage=function(t){this.controller.closePage(t)},t.prototype.ceasePage=function(t){this.controller.ceasePage(t)},t.prototype.removeCeased=function(){this.controller.removeCeased()},t.prototype.regConfirmClose=function(t){this.controller.regConfirmClose(t)},t}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t){return null},e}(c)},function(t,e,n){"use strict";var r=n(63);n.o(r,"Edit")&&n.d(e,"Edit",function(){return r.Edit}),n.o(r,"Form")&&n.d(e,"Form",function(){return r.Form}),n.o(r,"Image")&&n.d(e,"Image",function(){return r.Image}),n.o(r,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return r.TabCaptionComponent}),n.o(r,"Tabs")&&n.d(e,"Tabs",function(){return r.Tabs}),n.o(r,"resLang")&&n.d(e,"resLang",function(){return r.resLang});var i=n(64);n.o(i,"Edit")&&n.d(e,"Edit",function(){return i.Edit}),n.o(i,"Form")&&n.d(e,"Form",function(){return i.Form}),n.o(i,"Image")&&n.d(e,"Image",function(){return i.Image}),n.o(i,"TabCaptionComponent")&&n.d(e,"TabCaptionComponent",function(){return i.TabCaptionComponent}),n.o(i,"Tabs")&&n.d(e,"Tabs",function(){return i.Tabs}),n.o(i,"resLang")&&n.d(e,"resLang",function(){return i.resLang})},function(t,e){},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=n(4),o=n(24),s=function(){function t(t){void 0===t&&(t=!1),this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=i.l.array([],{deep:t})}return Object.defineProperty(t.prototype,"items",{get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0},enumerable:!0,configurable:!0}),t.prototype.scrollToTop=function(){this.topDiv="$$"+Object(o.a)()},t.prototype.scrollToBottom=function(){this.bottomDiv="$$"+Object(o.a)()},t.prototype.reset=function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)},t.prototype.append=function(t){"tail"===this.appendPosition?this._items.unshift(t):this._items.push(t)},t.prototype.first=function(t){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.reset(),this.beforeLoad=!1,this.param=t,[4,this.more()];case 1:return e.sent(),[2]}})})},t.prototype.more=function(){return r.b(this,void 0,Promise,function(){var t,e,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return!0===this.allLoaded?[2]:!0===this.loading?[2]:(this.loading=!0,n=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(n=this.firstSize+1),[4,this.load(this.param,this.pageStart,n)]);case 1:return i=r.sent(),this.loading=!1,this.loaded=!0,o=i.length,!0===this.isFirst&&o>this.firstSize||!1===this.isFirst&&o>this.pageSize?(this.allLoaded=!1,--o,i.splice(o,1)):this.allLoaded=!0,0===o?(this._items.clear(),[2]):(this.setPageStart(i[o-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,i):(e=this._items).unshift.apply(e,i.reverse()),this.isFirst=!1,[2])}})})},r.c([i.l],t.prototype,"loading",void 0),r.c([i.l],t.prototype,"beforeLoad",void 0),r.c([i.l],t.prototype,"loaded",void 0),r.c([i.l],t.prototype,"allLoaded",void 0),r.c([i.e],t.prototype,"items",null),r.c([i.l],t.prototype,"topDiv",void 0),r.c([i.l],t.prototype,"bottomDiv",void 0),t}()},function(t,e,n){"use strict";var r=n(0),i=n(4);!function(){function t(t){void 0===t&&(t=100),this.arr=[],this.dict=new Map,this.maxCount=t}t.prototype.loadIds=function(t){for(var e=[],n=0,r=t;n<r.length;n++){var i=r[n];if(null!==i){var o=this.dict.get(i);void 0===o&&(e.push(i),o={id:i},this.dict.set(i,o))}}this.loadId(e)},t.prototype.get=function(t){if(void 0===t||null===t)return null;var e=this.dict.get(t);return void 0===e&&(this.dict.set(t,{id:t}),this.loadId([t]),e=this.dict.get(t)),e},t.prototype.setItem=function(t,e){void 0===e?(this.dict.set(t,null),this.arr.push({id:t})):(this.dict.set(t,e),this.arr.push(e)),this.arr.length>this.maxCount&&(e=this.arr.shift(),this.dict.delete(e.id))},t.prototype.loadId=function(t){return r.b(this,void 0,void 0,function(){var e,n,i,o,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:return[4,this._loadIds(t)];case 1:if(void 0!==(e=r.sent()))return[3,6];n=0,i=t,r.label=2;case 2:return n<i.length?null===(l=i[n])?[3,4]:[4,this._loadId(l)]:[3,5];case 3:o=r.sent(),this.setItem(l,o),r.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:for(s=function(t){var n=e.find(function(e){return e.id===t});a.setItem(t,n)},a=this,u=0,c=t;u<c.length;u++)l=c[u],s(l);r.label=7;case 7:return[2]}})})},r.c([i.l],t.prototype,"dict",void 0)}()},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=n(1),o=n(5),s=n(43);var a=function(t){function e(e){var n=t.call(this,e)||this;return n.formView=new s.a(n.props),n}return r.d(e,t),e.prototype.componentWillMount=function(){this.formView.setInitValues(this.props.initValues)},e.prototype.debug=function(){},e.prototype.render=function(){var t=this.props,e=t.className,n=t.children;t.initValues;return i.createElement("div",{className:e},void 0===n?this.formView.render():i.createElement("form",{onSubmit:this.formView.onSubmit},n))},e=r.c([o.a],e)}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o);!function(t){function e(e){var n=t.call(this,e)||this;return n.handleDocumentClick=function(t){!1!==n.state.dropdownOpen&&(n.button&&n.button.contains(t.target)||n.menu&&n.toggle())},n.toggle=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={dropdownOpen:!1},n}r.d(e,t),e.prototype.componentWillMount=function(){document.addEventListener("click",this.handleDocumentClick),document.addEventListener("touchstart",this.handleDocumentClick)},e.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("touchstart",this.handleDocumentClick)},e.prototype.render=function(){var t=this,e=this.props,n=e.icon,r=e.actions,o=e.isRight;void 0===o&&(o=!0);var a=r.some(function(t){return void 0!==t.icon}),u=this.state.dropdownOpen;return i.createElement("div",{className:"dropdown"},i.createElement("button",{ref:function(e){return t.button=e},className:"cursor-pointer dropdown-toggle btn btn-sm","data-toggle":"dropdown","aria-expanded":u,onClick:this.toggle},i.createElement("i",{className:s()("fa","fa-"+(n||"ellipsis-v"))})),i.createElement("div",{ref:function(e){return t.menu=e},className:s()({"dropdown-menu":!0,"dropdown-menu-right":o,show:u})},r.map(function(t,e){var n,r=t.icon,o=t.caption,u=t.action;return void 0===r&&void 0===o?i.createElement("div",{className:"dropdown-divider"}):(!0===a&&(void 0!==r&&(r="fa-"+r),n=i.createElement(i.Fragment,null,i.createElement("i",{className:s()("fa",r,"fa-fw"),"aria-hidden":!0}),"\xa0 ")),void 0===u?i.createElement("h6",{className:"dropdown-header"},n," ",o):i.createElement("a",{className:"dropdown-item",key:e,href:"#",onClick:function(t){t.preventDefault(),u()}},n," ",o))})))}}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=n(1),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=this.props.date;if(!t)return null;var e="string"===typeof t?new Date(Date.parse(t)):t,n=new Date,r=n.getTime()-e.getTime(),i=n.getDate(),o=e.getDate(),s=e.getHours(),a=e.getMinutes(),u=e.getMonth()+1,c=s+(a<10?":0":":")+a;return r<-864e5?e.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5 "+c:r<864e5?o!==i?(r<0?"\u660e\u5929 ":"\u6628\u5929 ")+c:c:r<31536e6?u+"\u6708"+o+"\u65e5 ":e.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5"},e}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(2);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t,e=this.props,n=e.icon,r=e.main,o=e.discription,u=e.px,c=e.py;t="string"===typeof o?i.createElement("div",null,o):o;var l=s()("media",void 0===u?"px-0":"px-"+u,void 0===c?"py-2":"py-"+c);return i.createElement("div",{className:l},i.createElement(a.Image,{className:"mr-3 w-4c h-4c",src:n}),i.createElement("div",{className:"media-body"},i.createElement("h5",{className:"mt-0"},r),t))}}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(4),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key=null,e.onChange=function(t){e.key=t.target.value,void 0!==e.key&&(e.key=e.key.trim(),""===e.key&&(e.key=void 0)),!0!==e.props.allowEmptySearch&&(e.disabled=!e.key)},e.onSubmit=function(t){return r.b(e,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:if(t.preventDefault(),null===this.key&&(this.key=this.props.initKey||""),!0!==this.props.allowEmptySearch){if(!this.key)return[2];this.input&&(this.input.disabled=!0)}return[4,this.props.onSearch(this.key)];case 1:return e.sent(),this.input&&(this.input.disabled=!1),[2]}})})},e}return r.d(e,t),e.prototype.clear=function(){this.input&&(this.input.value="")},e.prototype.render=function(){var t,e,n=this,r=this.props,o=r.className,a=r.inputClassName,u=r.onFocus,c=r.label,l=r.placeholder,h=r.buttonText,d=r.maxLength;switch(r.size){default:case"sm":t="input-group-sm";break;case"md":t="input-group-md";break;case"lg":t="input-group-lg"}return void 0!==c&&(e=i.createElement("label",{className:"input-group-addon"},c)),i.createElement("form",{className:o,onSubmit:this.onSubmit},i.createElement("div",{className:s()("input-group",t)},e,i.createElement("input",{ref:function(t){return n.input=t},onChange:this.onChange,type:"text",name:"key",onFocus:u,className:s()("form-control",a||"border-primary"),placeholder:l,defaultValue:this.props.initKey,maxLength:d}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.disabled},i.createElement("i",{className:"fa fa-search"}),i.createElement("i",{className:"fa"}),h))))},r.c([a.l],e.prototype,"disabled",void 0),e}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(8),s=n.n(o),a=n(6),u=n.n(a),c=n(42),l=(function(t){function e(e){var n=t.call(this,e)||this;return n.values={},n.stepViews=[],n.state={topView:void 0,stepViews:[]},n.onPrev=n.onPrev.bind(n),n.onNext=n.onNext.bind(n),n}r.d(e,t),e.prototype.setStep=function(t){var e=this.props.steps[t];if(void 0!==e){var n,o;void 0!==this.topView&&this.stepViews.push(this.topView),this.stepViews.length>0&&(n=i.createElement(l,{prefix:"undo",text:"\u4e0a\u4e00\u6b65"}),o=this.onPrev);var s=this.props,a=(s.header,s.footer,void 0===e.next?{prefix:"cloud-upload",text:this.props.submitButton||"\u63d0\u4ea4"}:{suffix:"arrow-right",text:"\u4e0b\u4e00\u6b65"}),u={formRows:e.formRows,submitButton:i.createElement(l,r.a({},a)),onSubmit:this.onNext,otherButton:n,onOther:o};this.stepViews.length;this.topView={stepName:t,step:e,props:u},this.setState({topView:this.topView,stepViews:this.stepViews})}},e.prototype.componentWillMount=function(){this.setStep(this.props.first)},e.prototype.onPrev=function(t){s.a.assign(this.values,t),this.topView=this.stepViews.pop(),this.setState({topView:this.topView,stepViews:this.stepViews})},e.prototype.onNext=function(t){s.a.assign(this.values,t);var e,n=this.topView.step.next;if(void 0===n)return this.props.onSubmit(this.values);e="string"===typeof n?n:n(this.values),this.setStep(e)},e.prototype.render=function(){var t=this.props,e=t.className,n=t.header,o=t.footer,s=this.state,a=s.topView,u=s.stepViews,l=a.stepName,h=a.step,d=u.length+1;return i.createElement("div",{className:e},i.createElement("div",null,n&&n(h,d),i.createElement(c.TonvaForm,r.a({key:l,initValues:this.values},a.props)),o&&o(h,d)))}}(i.Component),function(t){var e,n,r=t.prefix,o=(t.text,t.suffix);return void 0!==r&&(e=i.createElement("i",{className:u()("fa","fa-"+r)})),void 0!==o&&(n=i.createElement("i",{className:u()("fa","fa-"+o)})),i.createElement(i.Fragment,null,e," ",t.text," ",n)})},function(t,e,n){"use strict";n(0),n(1),n(41)},function(t,e){},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(6),a=n.n(s),u=n(8),c=n.n(u),l=function(){return function(){}}(),h=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return r.d(e,t),e.prototype.check=function(t,e){var n=this.func(e);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void t.push(n);default:return void t.push.apply(t,n)}},e}(l),d=function(t){function e(e){var n=t.call(this)||this;return n.res=e,n}return r.d(e,t),e}(l),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.check=function(t,e){switch(typeof e){default:case"boolean":return;case"object":if(null!==e)return;break;case"string":if(e.trim().length>0)return;break;case"number":if(NaN!==e)return;break;case"undefined":}t.push(this.res.required)},e}(d),f=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.minMsg=c.a.template(e.min),i.maxMsg=c.a.template(e.max),i.min=n,i.max=r,i}return r.d(e,t),e.prototype.check=function(t,e){if(void 0!==e&&null!==e){var n=Number(e);NaN===n?t.push(this.res.number):this.checkMore(t,n)}},e.prototype.checkMore=function(t,e){void 0!==this.min&&Number(e)<this.min&&t.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(e)>this.max&&t.push(this.maxMsg({max:this.max}))},e}(d),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.checkMore=function(e,n){t.prototype.checkMore.call(this,e,n),!1===Number.isInteger(n)&&e.push(this.res.integer)},e}(f),v=n(5),b=function(){function t(t,e,n,r){var o=this;this.errors=[],this.contextErrors=[],this.onInputChange=function(t){o.changeValue(t.target.value,!0)},this.container=Object(v.a)(function(){if(!1===o.visible)return null;var t=o.context,e=t.form;if(!0===t.inNode)return o.render();var n=o.label;return!0===o.itemSchema.required&&!1!==e.props.requiredFlag&&null!==n&&(n=i.createElement(i.Fragment,null,n,"\xa0",i.createElement("span",{className:"text-danger"},"*"))),e.FieldContainer(n,o.render())}),this.context=t;var s=e.name;if(this.name=s,this.itemSchema=e,this.fieldProps=n,this.children=r,this.ui=t.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var a=this.ui,u=a.readOnly,c=a.disabled,l=a.visible;this.readOnly=!0===u,this.disabled=!0===c,this.visible=!(!1===l)}this.value=this.defaultValue=t.getValue(s),this.init()}return Object.defineProperty(t.prototype,"hasError",{get:function(){return this.errors.length+this.contextErrors.length>0},enumerable:!0,configurable:!0}),t.prototype.init=function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new p(this.context.form.res)),this.buildRules(),void 0!==this.ui){var t=this.ui.rules;if(void 0!==t)if(!1!==Array.isArray(t))for(var e=0,n=t;e<n.length;e++){var r=n[e];this.rules.push(new h(r))}else this.rules.push(new h(t))}},t.prototype.buildRules=function(){},t.prototype.checkRules=function(){for(var t,e=[],n=0,r=this.rules;n<r.length;n++){r[n].check(e,this.value)}0===e.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,e))},Object.defineProperty(t.prototype,"isOk",{get:function(){return 0===this.errors.length},enumerable:!0,configurable:!0}),t.prototype.setError=function(t){var e;void 0!==t&&("string"===typeof t?this.errors.push(t):(e=this.errors).push.apply(e,t))},t.prototype.setContextError=function(t){var e;void 0!==t&&("string"===typeof t?this.contextErrors.push(t):(e=this.contextErrors).push.apply(e,t))},t.prototype.clearError=function(){this.errors.splice(0)},t.prototype.clearContextError=function(){this.contextErrors.splice(0)},t.prototype.parse=function(t){return t},t.prototype.setElementValue=function(t){},t.prototype.setDataValue=function(t){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(t))},t.prototype.setValue=function(t){!0!==this.isChanging&&this.changeValue(t,!1)},t.prototype.getValue=function(){return this.context.getValue(this.name)},t.prototype.getReadOnly=function(){return this.readOnly},t.prototype.getDisabled=function(){return this.disabled},t.prototype.getVisible=function(){return this.visible},t.prototype.setReadOnly=function(t){this.readOnly=t},t.prototype.setDisabled=function(t){this.disabled=t},t.prototype.setVisible=function(t){this.visible=t},t.prototype.changeValue=function(t,e){var n,r,i=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var o=!0;void 0!==n&&(this.isChanging=!0,o=n(this.context,this.value,i),this.isChanging=!1),!0===o&&(this.setDataValue(t),!0!==e&&this.setElementValue(t),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,i),this.isChanging=!1))},Object.defineProperty(t.prototype,"className",{get:function(){var t;return!1===this.context.inNode&&(t="form-control"),a()(t,this.context.form.FieldClass,this.ui&&this.ui.className)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){var t;if(void 0===this.ui)t=this.name;else{var e=this.ui.label;t=null===e?null:e||this.name}return t},enumerable:!0,configurable:!0}),t.prototype.renderTemplet=function(){if(void 0!==this.children)return i.createElement(i.Fragment,null,this.children);if(void 0!==this.ui){var t=this.ui.Templet;return"function"===typeof t?t(this.value):t}},t.prototype.renderErrors=function(){var t=this.errors.concat(this.contextErrors);if(0===t.length)return null;var e=!0===this.context.inNode?"span":"div";return t.map(function(t){return i.createElement(e,{key:t,className:"text-danger d-inline-block my-2 ml-3"},i.createElement(i.Fragment,null,i.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t))})},r.c([o.l],t.prototype,"errors",void 0),r.c([o.l],t.prototype,"contextErrors",void 0),r.c([o.e],t.prototype,"hasError",null),r.c([o.l],t.prototype,"visible",void 0),r.c([o.e],t.prototype,"isOk",null),t}(),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="text",e.onKeyDown=function(t){return r.b(e,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return this.internalOnKeyDown(t),13!==t.keyCode?[2]:void 0===(e=this.context.form.props.onEnter)?[2]:(this.changeValue(t.currentTarget.value,!0),this.checkRules(),this.context.checkContextRules(),[4,e(this.name,this.context)]);case 1:return void 0!==(n=r.sent())&&this.context.setError(this.name,n),[2]}})})},e}return r.d(e,t),e.prototype.setElementValue=function(t){null!==this.input&&(this.input.value=t)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this.ui&&this.ui.placeholder||this.name},enumerable:!0,configurable:!0}),e.prototype.internalOnKeyDown=function(t){},e.prototype.onBlur=function(t){this.onInputChange(t),this.checkRules(),this.context.checkContextRules()},e.prototype.onFocus=function(t){this.clearError(),this.context.removeErrorWidget(this),this.context.removeErrors()},e.prototype.onChange=function(t){},e.prototype.setReadOnly=function(t){null!==this.input&&(this.input.readOnly=this.readOnly=t)},e.prototype.setDisabled=function(t){null!==this.input&&(this.input.disabled=this.disabled=t)},e.prototype.render=function(){var t=this,e=this.renderTemplet();if(void 0!==e)return e;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,i.createElement(i.Fragment,null,i.createElement("input",{ref:function(e){return t.input=e},className:a()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:function(e){return t.onChange(e)},placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:function(e){return t.onFocus(e)},onBlur:function(e){return t.onBlur(e)},maxLength:this.itemSchema.maxLength}),this.renderErrors())},e}(b),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setValue(t.currentTarget.value)},e}return r.d(e,t),e.prototype.setElementValue=function(t){this.input.value=t},e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this,e=this.renderTemplet();if(void 0!==e)return e;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,i.createElement("textarea",{ref:function(e){return t.input=e},className:a()(this.className,n),rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange})},e}(b),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="password",e}return r.d(e,t),e}(y),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="url",e}return r.d(e,t),e}(y),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="email",e}return r.d(e,t),e}(y),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e}return r.d(e,t),e.prototype.buildRules=function(){t.prototype.buildRules.call(this);var e=this.context.form.res,n=this.itemSchema,r=n.min,i=n.max;this.rules.push("integer"===this.itemSchema.type?new f(e,r,i):new m(e,r,i))},e.prototype.parse=function(t){if(void 0!==t&&null!==t)return Number(t)},e}(y),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="number",e}return r.d(e,t),e.prototype.isValidKey=function(t){return 46===t||8===t||37===t||39===t||t>=48&&t<=57||t>=96&&t<=105||109===t||189===t},e.prototype.internalOnKeyDown=function(t){var e=t.keyCode;event.returnValue=this.isValidKey(e)},e}(C),N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="date",e}return r.d(e,t),e}(y),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="datetime",e}return r.d(e,t),e}(y),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="time",e}return r.d(e,t),e}(y),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="month",e}return r.d(e,t),e}(y),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setDataValue(!0===t.target.checked?e.trueValue:e.falseValue)},e.onClick=function(){e.context.removeErrors()},e}return r.d(e,t),e.prototype.init=function(){if(t.prototype.init.call(this),void 0!==this.ui){var e=this.ui,n=e.trueValue,r=e.falseValue;this.trueValue=void 0===n||n,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1},e.prototype.setElementValue=function(t){this.input.checked=t===this.trueValue},e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this,e=a()(this.className,"form-check-inline p-0"),n=i.createElement("input",{ref:function(e){return t.input=e},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return!0===this.context.inNode?i.createElement("label",{className:e},n," ",this.ui&&this.ui.label||this.name):i.createElement("div",{className:e},i.createElement("label",{className:"w-100 h-100 mb-0 d-flex justify-content-center"},n))},e}(b),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onInputChange=function(t){e.setDataValue(t.target.value)},e}return r.d(e,t),e.prototype.setElementValue=function(t){this.select.value=t},e.prototype.setReadOnly=function(t){this.select.disabled=this.readOnly=!t},e.prototype.setDisabled=function(t){this.select.disabled=this.disabled=t},e.prototype.render=function(){var t=this;if(!0===this.readOnly){var e=this.ui.list.find(function(e){return e.value===t.value}),n=void 0===e?"(???)":e.title;return i.createElement("span",{className:"form-control w-min-6c"},n)}return i.createElement("select",{ref:function(e){return t.select=e},className:a()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map(function(t,e){var n=t.title,r=t.value;return i.createElement("option",{className:void 0,key:e,value:r},n||r)}))},r.c([o.l],e.prototype,"readOnly",void 0),e}(b),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputs={},e}return r.d(e,t),e.prototype.setElementValue=function(t){for(var e in this.inputs){var n=this.inputs[e];n.checked=t===n.value}},e.prototype.setReadOnly=function(t){for(var e in this.readOnly=t,this.inputs)this.inputs[e].readOnly=t},e.prototype.setDisabled=function(t){for(var e in this.disabled=t,this.inputs)this.inputs[e].disabled=t},e.prototype.render=function(){var t,e=this,n=this.ui,r=n.defaultValue,o=n.list,s=this.context,u=s.isRow;s.inNode;!0===u&&(t=this.context.rowKey);var c=a()(this.className,"form-radio-inline");return i.createElement("span",{className:c},o.map(function(n,o){var s=n.value,a=n.title,u=e.name;return void 0!==t&&(u+="-"+t),i.createElement("label",{key:o,className:"form-radio-inline"},i.createElement("input",{ref:function(t){return e.inputs[o]=t},type:"radio",name:u,value:s,defaultChecked:(e.defaultValue||r)===s}),a||s)}))},e}(b),I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="range",e}return r.d(e,t),e.prototype.setReadOnly=function(t){this.input.readOnly=this.readOnly=t},e.prototype.setDisabled=function(t){this.input.disabled=this.disabled=t},e.prototype.render=function(){var t=this,e=this.ui,n=e.min,r=e.max,o=e.step;return i.createElement(i.Fragment,null,i.createElement("input",{ref:function(e){return t.input=e},className:a()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:o}))},e}(b),A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return void 0===(t=this.ui&&this.ui.pickId)?(alert("no pickId defined!"),[2]):[4,t(this.context,this.name,this.value)];case 1:return e=n.sent(),this.setDataValue(e),this.clearError(),this.clearContextError(),this.checkRules(),[2]}})})},e}return r.d(e,t),e.prototype.setReadOnly=function(t){this.readOnly=t},e.prototype.setDisabled=function(t){this.disabled=t},e.prototype.render=function(){var t,e;void 0!==this.ui&&(t=this.ui.placeholder,e=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(n=t||"placeholder",r["text-muted"]=!0):n=void 0===e?i.createElement(i.Fragment,null,this.value):"function"===typeof e?e(this.value):e,i.createElement(i.Fragment,null,i.createElement("div",{className:a()(r),onClick:this.onClick},n),this.renderErrors())},r.c([o.l],e.prototype,"value",void 0),e}(b),j=function(t,e,n){return i.createElement("span",{className:"text-danger"},"!!data type ",t," only support ",(n||[]).join(", "),", can't use ui ",e,"!!")},q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i;return r.e(this,function(r){switch(r.label){case 0:return this.clearError(),this.clearContextError(),t=this.itemSchema,e=t.name,"submit"===t.type&&(this.context.checkRules(),!0===this.context.hasError)?[2]:void 0===(n=this.context.form.props.onButtonClick)?(alert("button "+e+" clicked. you should define form onButtonClick"),[2]):[4,n(e,this.context)];case 1:return void 0===(i=r.sent())?[2]:(this.context.setError(e,i),[2])}})})},e.observerRender=Object(v.a)(function(){var t,n,r,o=e.itemSchema,s=o.name,a=o.type;if(void 0!==e.ui){var u=e.ui.widget;if("button"!==u)return j(a,u,["button"]);t=e.ui.Templet,n=e.ui.className,r=e.ui.label}var c,l=e.context,h=l.form,d=l.hasError,p=e.context,f="submit"===a&&d;c=void 0!==e.children?e.children:"function"===typeof t?t():void 0!==t?t:r;var m=i.createElement("button",{className:n,type:"button",disabled:f,onClick:e.onClick},c||s);return!0===p.inNode?i.createElement(i.Fragment,null,m,e.renderErrors()):i.createElement("div",{className:h.ButtonClass},i.createElement("div",null,e.renderErrors()),m)}),e}return r.d(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.render=function(){return i.createElement(this.observerRender,null)},e}(b),R=function(){function t(t,e,n,r,o){var s,a=this;if(this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(v.a)(function(){var t=a.errors;return 0===t.length?null:i.createElement(i.Fragment,null,t.map(function(t){return i.createElement("span",{key:t,className:"text-danger inline-block my-1 ml-3"},i.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",t)}))}),this.form=t,this.uiSchema=e,this.initData=n,this.inNode=r,this.isRow=o,void 0!==e){var u=e.rules;void 0!==u&&(this.rules=[],!1===Array.isArray(u)?this.rules.push(u):(s=this.rules).push.apply(s,u))}}return t.prototype.getArrRowContexts=function(t){void 0===this.subContexts&&(this.subContexts={});var e=this.subContexts[name];return void 0===e&&(this.subContexts[name]=e={}),e},Object.defineProperty(t.prototype,"arrName",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.getValue=function(t){return this.initData[t]},t.prototype.setValue=function(t,e){this.initData[t]=e;var n=this.widgets[t];void 0!==n&&n.setValue(e)},t.prototype.getDisabled=function(t){var e=this.widgets[t];if(void 0!==e)return e.getDisabled()},t.prototype.setDisabled=function(t,e){var n=this.widgets[t];void 0!==n&&n.setDisabled(e)},t.prototype.getReadOnly=function(t){var e=this.widgets[t];void 0!==e&&e.getReadOnly()},t.prototype.setReadOnly=function(t,e){var n=this.widgets[t];void 0!==n&&n.setReadOnly(e)},t.prototype.getVisible=function(t){var e=this.widgets[t];void 0!==e&&e.getVisible()},t.prototype.setVisible=function(t,e){var n=this.widgets[t];void 0!==n&&n.setVisible(e)},t.prototype.checkFieldRules=function(){for(var t in this.widgets)this.widgets[t].checkRules();if(void 0!==this.subContexts)for(var t in this.subContexts){var e=this.subContexts[t];for(var n in e)e[n].checkFieldRules()}},t.prototype.checkContextRules=function(){var t;if(void 0!==this.rules){this.clearContextErrors();for(var e=0,n=this.rules;e<n.length;e++){var r=(0,n[e])(this);if(void 0!==r)if(!0===Array.isArray(r))(t=this.errors).push.apply(t,r);else if("string"===typeof r)this.errors.push(r);else for(var i in r)this.setError(i,r[i])}if(void 0!==this.subContexts)for(var i in this.subContexts){var o=this.subContexts[i];for(var s in o){var a=o[s];a.removeErrors(),a.checkContextRules()}}}},t.prototype.setError=function(t,e){var n=this.widgets[t];void 0!==n&&(n.setContextError(e),this.addErrorWidget(n))},t.prototype.clearContextErrors=function(){for(var t in this.widgets)this.widgets[t].clearContextError()},t.prototype.checkRules=function(){this.checkFieldRules(),this.checkContextRules()},t.prototype.addErrorWidget=function(t){this.errorWidgets.findIndex(function(e){return e===t})<0&&this.errorWidgets.push(t)},t.prototype.removeErrorWidget=function(t){var e=this.errorWidgets.findIndex(function(e){return e===t});e>=0&&this.errorWidgets.splice(e,1)},t.prototype.checkHasError=function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var t in this.subContexts){var e=this.subContexts[t];for(var n in e)if(!0===e[n].hasError)return!0}return!1},Object.defineProperty(t.prototype,"hasError",{get:function(){return this.checkHasError()},enumerable:!0,configurable:!0}),t.prototype.removeErrors=function(){for(var t in this.errors.splice(0),this.errorWidgets.splice(0),this.widgets){var e=this.widgets[t];void 0!==e&&e.clearContextError()}},r.c([o.l],t.prototype,"errors",void 0),r.c([o.l],t.prototype,"errorWidgets",void 0),r.c([o.e],t.prototype,"hasError",null),t}(),L=1,D=function(t){function e(e,n,r,i){var o,s=this,a=e.uiSchema;if(void 0!==a){var u=a.items;void 0!==u&&(o=u[n.name])}return(s=t.call(this,e.form,o,r,i,!0)||this).parentContext=e,s.arrSchema=n,s.rowKey=L++,s.data=r,s}return r.d(e,t),e.prototype.getItemSchema=function(t){return this.arrSchema.itemSchemas[t]},e.prototype.getUiItem=function(t){if(void 0!==this.uiSchema){var e=this.uiSchema.items;if(void 0!==e)return e[t]}},Object.defineProperty(e.prototype,"arrName",{get:function(){return this.arrSchema.name},enumerable:!0,configurable:!0}),e.prototype.removeErrors=function(){t.prototype.removeErrors.call(this),this.parentContext.removeErrors()},Object.defineProperty(e.prototype,"parentData",{get:function(){return this.parentContext.data},enumerable:!0,configurable:!0}),e}(R),U=function(t){function e(e,n){return t.call(this,e,e.uiSchema,e.data,n,!1)||this}return r.d(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.form.data},enumerable:!0,configurable:!0}),e.prototype.getItemSchema=function(t){return this.form.itemSchemas[t]},e.prototype.getUiItem=function(t){var e=this.form.uiSchema;if(void 0!==e){var n=e.items;if(void 0!==n)return n[t]}},e}(R),M=i.createContext({}),B=Object(v.a)(function(t){var e,n,r,o,s=t.parentContext,u=t.arrSchema,c=t.children,l=u.name,h=u.arr,d=s.initData[l],p=s.form,f=s.getArrRowContexts(l),m=s.getUiItem(l),b=l,y=p.ArrContainer,g=p.RowContainer,w=p.RowSeperator,E=p.uiSchema;if(void 0!==E){var k=E.selectable,C=E.deletable,P=E.restorable;!0!==n&&(n=k),!0!==r&&(r=C),!0!==o&&(o=P)}if(void 0!==m){var N=m.widget,S=m.label,x=m.selectable,F=m.deletable,T=m.restorable,O=m.ArrContainer,V=m.RowContainer,I=m.RowSeperator;if(void 0!==x&&(n=x),void 0!==F&&(r=F),void 0!==T&&(o=T),void 0!==O&&(y=O),void 0!==V&&(g=V),void 0!==I&&(w=I),e=m.Templet,"arr"!==N)return j(u.type,N,["arr"]);b=S||b}var A=!0;return y(b,i.createElement(i.Fragment,null,d.map(function(t,l){var p,m,b=void 0;if(!1===A?b=w:A=!1,void 0!==c)p=new D(s,u,t,!0),m=i.createElement(i.Fragment,null,c);else{var y=typeof e;"function"===y?(p=new D(s,u,t,!0),m=i.createElement(Object(v.a)(e),t)):"object"===y?(p=new D(s,u,t,!0),m=e):(p=new D(s,u,t,!1),m=i.createElement(i.Fragment,null,h.map(function(t,e){return i.createElement(i.Fragment,{key:t.name},z(p,t,void 0))})))}var E,k,C=p.rowKey;if(f[C]=p,!0===n){E=i.createElement("div",{className:"form-row-checkbox"},i.createElement("input",{type:"checkbox",onClick:function(e){var n=e.target.checked;t.$isSelected=n;var r=t.$source;void 0!==r&&(r.$isSelected=n),p.removeErrors()},defaultChecked:t.$isSelected}))}var P=!(void 0===t.$isDeleted||!1===t.$isDeleted);if(!0===r){var N=P?"fa-undo":"fa-trash";k=i.createElement("div",{className:"form-row-edit text-info",onClick:function(){if(!0===o){t.$isDeleted=!P;var e=t.$source;void 0!==e&&(e.$isDeleted=!P)}else{var n=d.indexOf(t);n>=0&&d.splice(n,1)}p.removeErrors()}},i.createElement("i",{className:a()("fa",N,"fa-fw")}))}var S=!0===n||!0===r?function(e){return i.createElement("fieldset",{disabled:P},i.createElement("div",{className:a()("d-flex",{deleted:P,"row-selected":t.$isSelected})},E,i.createElement("div",{className:!0===n&&!0===r?"form-row-content":"form-row-content-1"},e),k))}:function(t){return t};return i.createElement(M.Provider,{key:C,value:p},b,g(S(i.createElement(i.Fragment,null,i.createElement(p.renderErrors,null),m))))})))}),_=n(21),H=n(37),$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){return r.b(e,void 0,void 0,function(){var t,e;return r.e(this,function(n){switch(n.label){case 0:return[4,(t=new H.a(this.itemSchema,this.ui,this.ui.label,this.value)).start()];case 1:return null!==(e=n.sent())&&(this.setValue(e),this.imageSrc=e),[4,t.end()];case 2:return n.sent(),[2]}})})},e.observerRender=Object(v.a)(function(){var t,n=["bg-white p-1 d-flex justify-content-center"];return e.readOnly||e.disabled||(n.push("cursor-pointer"),t=e.onClick),i.createElement("div",{className:a()(n),onClick:t},i.createElement(_.a,{src:e.imageSrc,className:"w-4c h-4c"}))}),e}return r.d(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.imageSrc=this.value},e.prototype.render=function(){return i.createElement(this.observerRender,null)},r.c([o.l],e.prototype,"imageSrc",void 0),e}(b),W={id:{dataTypes:["id"],widget:A},text:{dataTypes:["integer","number","string"],widget:y},textarea:{dataTypes:["string"],widget:g},password:{dataTypes:["string"],widget:w},date:{dataTypes:["date"],widget:N},datetime:{dataTypes:["date"],widget:S},time:{dataTypes:["date"],widget:x},month:{dataTypes:["date"],widget:F},select:{dataTypes:["integer","number","string","date","boolean"],widget:O},url:{dataTypes:["string"],widget:E},email:{dataTypes:["string"],widget:k},number:{dataTypes:["integer","number"],widget:C},updown:{dataTypes:["integer","number"],widget:P},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:T},image:{dataTypes:["string"],widget:$},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:V},range:{dataTypes:["integer"],widget:I},button:{dataTypes:["button","submit"],widget:q}};function z(t,e,n,r){if(void 0===t)return null;if(void 0!==e){var o,s=e.name,a=e.type;switch(a){case"arr":var u=t.getItemSchema(s);return i.createElement(B,{parentContext:t,arrSchema:u,children:n})}var c=t.getUiItem(s);if(void 0===c)o=p(a);else{var l=c.widget;switch(l){default:if(void 0!==l)o=W[l].widget;void 0===o&&(o=p(a));break;case"custom":o=c.WidgetClass;break;case"group":return i.createElement("span",null,"impletment group")}}t.isRow;var h=t.widgets,d=new o(t,e,r,n);return h[s]=d,i.createElement(d.container,null)}function p(t){switch(t){default:return y;case"id":return A;case"integer":return P;case"number":return C;case"string":return y;case"date":return N;case"boolean":return T;case"button":case"submit":return q}}}n(60);var K={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},G=n(26),Q=function(t){function e(e){var n=t.call(this,e)||this;n.watch=function(){void 0!==n.props.formData&&n.calcSelectOrDelete()},n.DefaultContainer=function(t){return i.createElement("form",{className:a()(n.props.className)},t)},n.DefaultFieldContainer=function(t,e){var r=n.props.fieldLabelSize;if(r>0){var o=void 0;null===t?r=0:o=i.createElement("label",{className:a()("col-sm-"+r,"col-form-label")},t);var s="col-sm-"+(12-r);return i.createElement("div",{className:"form-group row"},o,i.createElement("div",{className:s},e))}return i.createElement("div",{className:"form-group"},null===t?null:i.createElement("label",{className:"col-form-label"},t),e)},n.DefaultFieldClass=void 0,n.DefaultButtonClass="text-center py-2",n.DefaultRes=Object(G.a)(K),n.ArrContainer=function(t,e){return i.createElement("div",null,i.createElement("div",{className:a()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},t),e)},n.RowContainer=function(t){var e=a()({"py-3":!0});return i.createElement("div",{className:e},t)},n.RowSeperator=i.createElement("div",{className:"border border-gray border-top"});var r=e.schema,s=e.uiSchema,u=(e.formData,e.Container),c=e.FieldContainer,l=e.FieldClass,h=e.ButtonClass,d=e.res;n.Container=u||n.DefaultContainer,n.FieldContainer=c||n.DefaultFieldContainer,n.FieldClass=void 0!==l&&""!==l&&null!==l?l:n.DefaultFieldClass,n.res=d||n.DefaultRes,n.ButtonClass=h||n.DefaultButtonClass,n.schema=r,n.itemSchemas={};for(var p=0,f=n.schema;p<f.length;p++){var m=f[p];n.itemSchemas[m.name]=m}return n.uiSchema=s,n.disposer=Object(o.d)(n.watch),n.data={},n}return r.d(e,t),e.prototype.renderContent=function(){var t=this;this.initData(this.props.formData);var e,n=this.props.children;return void 0!==n?(this.formContext=new U(this,!0),i.createElement(i.Fragment,null,n)):(void 0!==this.uiSchema&&(e=this.uiSchema.Templet),void 0!==e?(this.formContext=new U(this,!0),"function"===typeof e?e(this.data):e):(this.formContext=new U(this,!1),i.createElement(i.Fragment,null,this.schema.map(function(e,r){return i.createElement(i.Fragment,{key:r},z(t.formContext,e,n))}))))},e.prototype.initData=function(t){void 0===t&&(t={});for(var e=0,n=this.schema;e<n.length;e++){var r=n[e];this.initDataItem(r,this.data,t)}},e.prototype.initDataItem=function(t,e,n){var r=t.name,i=t.type;if("button"!==i)if("arr"===i){var s=t,a=s.arr;if(void 0!==a){for(var u=s.itemSchemas={},c=0,l=a;c<l.length;c++){u[(g=l[c]).name]=g}var h=n[r];void 0===h?h=[]:!1===Array.isArray(h)&&(h=[h]);for(var d=[],p=0,f=h;p<f.length;p++){for(var m=f[p],v={$source:m,$isSelected:m.$isSelected,$isDeleted:m.$isDeleted},b=0,y=a;b<y.length;b++){var g=y[b];this.initDataItem(g,v,m)}d.push(v)}e[r]=Object(o.l)(d)}}else e[r]=n[r]},e.prototype.calcSelectOrDelete=function(){for(var t=0,e=this.schema;t<e.length;t++){var n=e[t];this.arrItemOperated(n)}},e.prototype.arrItemOperated=function(t){var e=t.name;if("arr"===t.type&&void 0!==this.data){var n=this.data[e];if(void 0!==n)for(var r=t.arr,i=0,o=n;i<o.length;i++){var s=o[i],a=s.$source;if(void 0!==a){var u=a.$isSelected,c=a.$isDeleted;s.$isSelected=u,s.$isDeleted=c;for(var l=0,h=r;l<h.length;l++){var d=h[l];this.arrItemOperated(d)}}}}},e.prototype.componentDidMount=function(){var t=this.props.beforeShow;void 0!==t&&t(this.formContext)},e.prototype.componentWillUnmount=function(){void 0!==this.disposer&&this.disposer()},e.prototype.render=function(){var t=this.renderContent();return i.createElement(M.Provider,{value:this.formContext},i.createElement(this.formContext.renderErrors,null),this.Container(t))},e.prototype.buttonClick=function(t){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return this.formContext.checkRules(),!0===this.formContext.hasError?[2]:void 0===(e=this.formContext.form.props.onButtonClick)?(alert("you should define form onButtonClick"),[2]):[4,e(t,this.formContext)];case 1:return void 0===(n=r.sent())?[2]:(this.formContext.setError(t,n),[2])}})})},e}(i.Component);!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.name,n=t.children,r=this.context;if(void 0===r)return i.createElement("span",{className:"text-danger"},"!only in Form!");var o=r.getItemSchema(e),s=z(r,o,n,this.props);return void 0===s?i.createElement("span",{className:"text-danger"},"!!",e," is not defined!!"):s},e.contextType=M}(i.Component);n.d(e,"a",function(){return Q})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(5),s=n(6),a=n.n(s),u=(n(109),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t,e=this.props,n=e.className,r=e.badge,o=e.size,s=e.color,u=e.badgeAlign,c=e.badgeVertical,l=e.children,h=a()(n,"va-badge",o&&"va-badge-"+o,"va-badge-"+(s||"secondary"),u&&"va-badg-"+u,c&&"va-badg-"+c);return r&&(t=i.createElement("b",null,r)),i.createElement("div",{className:h},l,t)},e=r.c([o.a],e)}(i.Component),n(111),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t,e,n,r=this.props,o=r.className,a=r.left,u=r.children,c=r.right,l=r.onClick;return void 0!==a&&(t=i.createElement("header",null,a)),void 0!==c&&(e=i.createElement("footer",null,c)),void 0!==l&&(n="cursor-pointer"),i.createElement("div",{className:s("va-lmr",o,n),onClick:l},t,i.createElement("div",null,u),e)},e=r.c([o.a],e)}(i.Component)),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.name,n=t.className,r=t.size,o=t.spin,a=t.fixWidth,u=t.border,c=t.pull,l=t.pulse,h=t.rotate,d=t.flip,p=t.inverse,f=s(n,"fa",e&&"fa-"+e,r&&"fa-"+r,a&&"fa-fw",u&&"fa-border",c&&"fa-pull-"+c,o&&"fa-spin",l&&"fa-pulse",h&&"fa-rotate-"+h,d&&"fa-flip-"+d,p&&"fa-inverse");return i.createElement("i",{className:f})},e}(i.Component),l=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.className,n=t.size,r=t.children,o=s("fa-stack",e,n&&"fa-"+n);return i.createElement("span",{className:o},r)}}(i.Component),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.icon,n=t.iconClass,r=t.text,o=t.textClass;return i.createElement("div",{className:"py-2"},i.createElement(c,{className:n,name:e,fixWidth:!0}),i.createElement("span",{className:o},r))}}(i.Component),function(t){return i.createElement("small",{className:s("text-muted",t.className),style:t.style},t.children)});n.d(e,"b",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return l})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(5),u=n(4),c=function(){function t(t){this.list=t}return Object.defineProperty(t.prototype,"isPaged",{get:function(){var t=this.list.props.items;return null!==t&&void 0!==t&&!1===Array.isArray(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this.list.props.items;return null===t?null:void 0!==t?!0===Array.isArray(t)?t:t.items:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loading",{get:function(){var t=this.list.props.items;if(null===t)return!1;if(void 0===t)return!0;var e=t;return void 0!==e.items&&e.loading},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItems",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.updateProps=function(t){},t.prototype.renderContent=function(t,e){var n=this.list.props.item.render;return void 0===n?i.createElement("div",{className:"px-3 py-2"},JSON.stringify(t)):n(t,e)},r.c([u.e],t.prototype,"loading",null),t}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t,e){var n=this.list.props.item,r=n.className,s=n.key,a=n.onClick;return i.createElement("li",{key:void 0===s?e:s(t),className:o("va-row-clickable",r),onClick:function(){return a(t)}},this.renderContent(t,e))},e}(c),h=n(20),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t,e){var n=this.list.props.item,r=n.className,s=n.key;n.render;if("string"===typeof t){var a=o("va-list-gap","px-3","pt-1");return i.createElement("li",{key:Object(h.a)(),className:a},t)}return i.createElement("li",{key:void 0===s?e:s(t),className:o(r)},this.renderContent(t,e))},e}(c),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.buildItems=function(){console.log("buildItems in selectable.tsx");var t,e=this.list.props,n=e.items,r=e.selectedItems,i=e.compare;return void 0===n?this._items=void 0:null===n?this._items=null:(t=!0===Array.isArray(n)?n:n.items,this._selectedItems=r,this._items=void 0===r?t.map(function(t){return{selected:!1,item:t,labelId:Object(h.a)()}}):void 0===i?t.map(function(t){return{selected:void 0!==r.find(function(e){return e===t}),item:t,labelId:Object(h.a)()}}):t.map(function(t){return{selected:void 0!==r.find(function(e){return i(t,e)}),item:t,labelId:Object(h.a)()}}))},Object.defineProperty(e.prototype,"items",{get:function(){return this.buildItems(),this._items},enumerable:!0,configurable:!0}),e.prototype.updateProps=function(t){t.selectedItems!==this._selectedItems&&this.buildItems()},e.prototype.onSelect=function(t,e){t.selected=e;var n=this._items.some(function(t){return t.selected});this.list.props.item.onSelect(t.item,e,n)},Object.defineProperty(e.prototype,"selectedItems",{get:function(){return this._items.filter(function(t){return!0===t.selected}).map(function(t){return t.item})},enumerable:!0,configurable:!0}),e.prototype.render=function(t,e){var n=this,r=this.list.props.item,s=r.className,a=r.key,u=(r.render,r.onSelect,t.labelId),c=t.selected;return i.createElement("li",{key:void 0===a?e:a(t),className:o(s)},i.createElement("div",{className:"d-flex align-items-center px-3"},i.createElement("input",{ref:function(t){t&&(n.input=t,t.checked=c)},className:"",type:"checkbox",value:"",id:u,defaultChecked:c,onChange:function(e){n.onSelect(t,e.target.checked)}}),i.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:u},this.renderContent(t.item,e))))},r.c([u.e],e.prototype,"items",null),e}(c);n(107);n.d(e,"a",function(){return f});var f=function(t){function e(e){var n=t.call(this,e)||this;n._$scroll=function(t){console.log("############### items scroll to "+t)};var r=n.props.item,i=r.onClick,o=r.onSelect;return n.listBase=void 0!==o?new p(n):void 0!==i?new l(n):new d(n),n}return r.d(e,t),e.prototype.componentWillUpdate=function(t,e,n){this.listBase.updateProps(t)},Object.defineProperty(e.prototype,"selectedItems",{get:function(){return this.listBase.selectedItems},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this,e=this.props,n=e.className,r=e.header,o=e.footer,a=e.before,u=e.loading,c=e.none;e.item,e.selectedItems;void 0===a&&(a="before"),void 0===u&&(u="loading"),void 0===c&&(c="none");var l,h=this.listBase,d=(h.isPaged,h.items);h.loading;function p(t,e){if(t)switch(typeof t){default:case"string":return i.createElement("li",{className:"va-list-"+e},t);case"function":return i.createElement("li",{className:"va-list-"+e},t());case"object":return i.createElement("li",null,t)}}return l=null===d?p(a,"before"):void 0===d?p(u,"loading"):0===d.length?p(c,"none"):d.map(function(e,n){return t.listBase.render(e,n)}),i.createElement("ul",{className:s()("va-list",n)},p(r,"header"),l,p(o,"footer"))},e=r.c([a.a],e)}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=function(){function t(){}return t.prototype.setValues=function(t){},t}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(t){return i.createElement("div",{key:"_b_"+t,className:""},i.createElement("div",{className:"col-sm-12"},i.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))},e}(s),u=function(t){function e(e){var n=t.call(this)||this;return n.param=e,n}return r.d(e,t),e.prototype.render=function(t){var e;switch(this.param){default:e="py-2";break;case"=":e="py-1";break;case"-":e="pb-1"}var n=o(e);return i.createElement("div",{key:"_g_"+t,className:n,style:{backgroundColor:"#f0f0f0"}})},e}(s),c=function(t){function e(e,n){var r=t.call(this)||this;return r.gridProps=e,r.prop=n,r}return r.d(e,t),e.prototype.render=function(t){var e=this.prop,n=e.onClick,r=e.bk,s=o({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return i.createElement("div",{key:t,className:s,onClick:n},this.renderLabel(),this.renderProp())},e.prototype.renderLabel=function(){var t=this.prop.label;return void 0===t?null:i.createElement("label",{className:"col-sm-2 col-form-label"},t)},e.prototype.renderProp=function(){var t,e,n=this.prop,r=n.label,s=n.full;switch(this.gridProps.alignValue){case"left":t="justify-content-start";break;case"center":t="justify-content-center";break;case"right":t="justify-content-end"}switch(this.prop.vAlign){case"top":e="align-items-start";break;default:case"center":e="align-items-center";break;case"bottom":e="align-items-end";break;case"stretch":e="align-items-stretch"}var a=o(t,e,!0!==s?void 0===r?"col-sm-12":"col-sm-10":"w-100","d-flex");return i.createElement("div",{className:a},this.renderPropBody())},e.prototype.renderPropBody=function(){return i.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())},e.prototype.renderPropContent=function(){return this.content},e}(s),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setValues=function(t){this.content=void 0===t?void 0:t[this.prop.name]},e}(c),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setValues=function(t){this.content=void 0===t?void 0:t[this.prop.name]},e}(c),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.setValues=function(t){if(void 0===t)this.content=void 0;else{var e=this.prop.list;this.content="string"===typeof e?t[e]:void 0}},e.prototype.renderPropBody=function(){var t=this.prop,e=t.list,n=t.row,r="string"===typeof e?this.content:e;return void 0===r?i.createElement("div",null):i.createElement("div",{className:"w-100"},r.map(function(t,e){return i.createElement(i.Fragment,{key:e},0===e?null:i.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),i.createElement(n,t))}))},e}(c),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.renderPropBody=function(){return this.prop.component},e}(c),f=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(t){return i.createElement("div",{className:"bg-white"},i.createElement("label",{className:"col-sm-2 col-form-label"},"AAABBBCCC"),i.createElement("div",{className:"col-sm-10"},i.createElement("div",{className:"form-control-plaintext"},"dsfasfa sdf asdf a")))}}(s),function(){function t(t,e){this.gridProps=t,this.props=e,this.buildRows()}return t.prototype.buildRows=function(){this.rows=[];for(var t=!0,e=0,n=this.props;e<n.length;e++){var r=n[e];if("string"===typeof r)this.rows.push(new u(r)),t=!0;else{t||this.rows.push(new a);var i=void 0;switch(r.type){default:continue;case"string":i=new l(this.gridProps,r);break;case"number":i=new h(this.gridProps,r);break;case"list":i=new d(this.gridProps,r);break;case"component":i=new p(this.gridProps,r)}this.rows.push(i),t=!1}}},t.prototype.setValues=function(t){for(var e=0,n=this.rows;e<n.length;e++){n[e].setValues(t)}},t.prototype.render=function(){return this.rows.map(function(t,e){return t.render(String(e))})},t}()),m=n(5),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.className,n=t.rows,r=t.values,s=new f(this.props,n);s.setValues(r);var a=o("container-fluid",e);return i.createElement("div",{className:a},s.render())},e=r.c([m.a],e)}(i.Component);n.d(e,"a",function(){return v})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n(5),a=(n(113),function(t){function e(e){var n=t.call(this,e)||this;return n.state={pressed:!1},n}return r.d(e,t),e.prototype.render=function(){var t,e,n,r,s,a,u=this.props,c=(u.date,u.main),l=u.vice,h=u.middle,d=u.midSize,p=u.icon,f=u.unread,m=u.right,v=u.onClick;if(void 0!==f){var b=void 0;(b="number"===typeof f?f:f.get())>0?n=i.createElement("b",null,b):b<0&&(n=i.createElement("b",{className:"dot"}))}switch(typeof p){case"object":t=i.createElement("header",null,p,n),e=!1;break;case"string":t=i.createElement("header",{className:"icon"},i.createElement("img",{src:p}),n),e=!0}if(void 0!==h)switch(typeof h){case"string":r=i.createElement("div",{style:{flex:d}},h);break;default:r=h}void 0!==m&&(s="string"===typeof m?i.createElement("footer",null,i.createElement("small",{className:"text-muted"},m)):i.createElement("footer",null,m)),void 0!==l&&(a=i.createElement("span",null,l));var y=o("va-row",{icon:e,pressed:this.state.pressed},{"va-action":void 0!==v});return i.createElement("li",{className:y,onClick:v},t,i.createElement("div",null,i.createElement("div",null,c),a),r,s)},e=r.c([s.a],e)}(i.Component));!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.d(e,t),e.prototype.render=function(){var t,e,n=this,s=this.props,u=s.header,c=s.items,l=s.beforeLoad,h=s.none,d=s.renderRow,p=s.className,f=s.footer,m=s.itemClick,v=s.converter,b=o(p,"va-list");return t=void 0===c?null===l?null:i.createElement("li",{className:"empty"},l||"..."):0===c.length?i.createElement("li",{className:"empty"},h||"[none]"):void 0!==d?c.map(function(t,e){return d(t,e,n.props.ex)}):c.map(function(t,e){var n,o=t.onClick;if(void 0===o&&void 0!==m&&(o=function(){return m(t)}),void 0!==v){if(void 0===(n=v(t)))return null}else n=r.a({},t);return void 0===n.key&&(n.key=n.main),i.createElement(a,r.a({onClick:o},n))}),void 0!==u&&(e="string"===typeof u?i.createElement("div",{className:"va-list-header"},u):u),i.createElement("div",{className:b},e,i.createElement("ul",null,t),f)},e=r.c([s.a],e)}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(5),s=n(9),a=n(19),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!=n},e.page=Object(o.a)(function(t){var n=t.resolve,r=(t.reject,i.createElement("button",{className:"btn btn-sm btn-success",disabled:!e.isChanged,onClick:function(){return n(e.newValue)}},"\u4fdd\u5b58"));return i.createElement(a.a,{header:"\u66f4\u6539"+e.label,right:r},i.createElement("div",{className:"m-3"},i.createElement("input",{type:"text",onChange:e.onChange,className:"form-control",defaultValue:e.value}),e.uiItem&&i.createElement("div",{className:"small muted m-2"},e.uiItem.placeholder)))}),e}return r.d(e,t),e.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var t=this;return r.e(this,function(e){return[2,new Promise(function(e,n){var r=i.createElement(t.page,{resolve:e,reject:n});s.c.push(r,n)})]})})},e}(n(53).a),c=n(37),l=n(21),h=function(t){function e(e){var n=t.call(this,e)||this;n.defaultSepClassName="border-top edit-sep-light-gray",n.defaultRowContainerClassName="d-flex px-3 py-2 cursor-pointer bg-white align-items-center",n.rowClick=function(t,e,i,o){return r.b(n,void 0,void 0,function(){var n,s,a,l,h;return r.e(this,function(r){switch(r.label){case 0:return n=this.props,s=n.onItemChanged,void 0===(a=n.onItemClick)?[3,2]:[4,a(t,e,o)];case 1:return r.sent(),[2];case 2:h=function(t,e,n,r){var i;if(void 0!==e)switch(e.widget){case"text":i=u;break;case"image":i=c.a}else switch(t.type){case"string":i=u;break;case"image":i=c.a}if(void 0===i)return;return new i(t,e,n,r)}(t,e,i,o),r.label=3;case 3:return r.trys.push([3,9,,10]),[4,h.start()];case 4:return(l=r.sent())==o?[3,7]:void 0!==s?[3,5]:(alert(t.name+" value changed, new: "+l+", pre: "+o),[3,7]);case 5:return[4,s(t,l,o)];case 6:r.sent(),r.label=7;case 7:return[4,h.end()];case 8:return r.sent(),[3,10];case 9:return r.sent(),console.log("no value changed"),[3,10];case 10:return[2]}})})};var o=e.topBorderClassName,s=e.bottomBorderClassName,a=e.sepClassName,l=e.rowContainerClassName,h=e.uiSchema;return n.topBorder=i.createElement("div",{className:o||n.defaultSepClassName}),n.bottomBorder=i.createElement("div",{className:s||n.defaultSepClassName}),n.rowContainerClassName=l||n.defaultRowContainerClassName,n.sep=i.createElement("div",{className:a||n.defaultSepClassName}),n.uiSchema=h&&h.items||{},n}return r.d(e,t),e.prototype.render=function(){var t=[],e=this.props.schema,n=e.length;t.push(this.topBorder);for(var r=0;r<n;r++)r>0&&t.push(this.sep),t.push(this.renderRow(e[r]));return t.push(this.bottomBorder),i.createElement("div",null,t.map(function(t,e){return i.createElement(i.Fragment,{key:e},t)}))},e.prototype.renderRow=function(t){var e,n=this,o=t.name,s=t.type,a=this.uiSchema[o],u=a&&a.label||o,c=this.props.data[o];switch(s){default:e=c?i.createElement("b",null,c):i.createElement("small",{className:"text-muted"},"(\u65e0)");break;case"image":e=i.createElement(l.a,{className:"w-4c h-4c",src:c})}return i.createElement("div",{className:this.rowContainerClassName,onClick:function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.rowClick(t,a,u,c)];case 1:return[2,e.sent()]}})})}},i.createElement("div",{className:"w-6c"},u),i.createElement("div",{className:"flex-fill d-flex justify-content-end"},e),i.createElement("div",{className:"w-2c text-right"},i.createElement("i",{className:"fa fa-chevron-right"})))},e=r.c([o.a],e)}(i.Component);n.d(e,"a",function(){return h})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(5),a=n(6),u=n.n(a),c=function(){function t(){}return Object.defineProperty(t.prototype,"content",{get:function(){return!0!==this.selected?this._content:void 0!==this._content?this._content:this._content=this.contentBuilder()},enumerable:!0,configurable:!0}),r.c([o.l],t.prototype,"selected",void 0),t}(),l=function(t,e,n){return i.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},i.createElement("div",null,i.createElement("i",{className:"fa fa-lg fa-"+e})),i.createElement("small",null,t))},h=function(t){function e(e){var n,r=t.call(this,e)||this;r.tabs=[],r.tabClick=function(t){r.selectedTab.selected=!1,t.selected=!0,r.selectedTab=t};var i=r.props,o=i.size,s=i.tabs,a=i.tabBack,u=i.contentBack,l=i.sep,h=i.selected;switch(o){default:case"md":r.size="3.2rem";break;case"sm":r.size="4rem";break;case"lg":r.size="2.5rem"}return(n=r.tabs).push.apply(n,s.map(function(t){var e=new c;return e.name=t.name,e.selected=!1,e.caption=t.caption,e.contentBuilder=t.content,e.notify=t.notify,e})),r.tabBack=a||"bg-light",r.contentBack=u,r.sep=l||"border-top border-gray",void 0!==h&&(r.selectedTab=r.tabs.find(function(t){return t.name===h})),void 0===r.selectedTab&&(r.selectedTab=r.tabs[0]),r.selectedTab.selected=!0,r}return r.d(e,t),e.prototype.showTab=function(t){var e=this.tabs.find(function(e){return e.name===t});void 0!==e&&(void 0!==this.selectedTab&&(this.selectedTab.selected=!1),e.selected=!0,this.selectedTab=e)},e.prototype.render=function(){var t=this;return i.createElement("div",{className:"tab"},i.createElement("div",{className:this.contentBack,style:{height:"calc(100% - "+this.size+")"}},this.tabs.map(function(t,e){var n={display:!0===t.selected?void 0:"none"};return i.createElement("div",{key:e,style:n},t.content)})),i.createElement("div",{className:u()(this.tabBack,this.sep),style:{height:this.size}},this.tabs.map(function(e,n){var r,o=e.selected,s=e.caption,a=e.notify;if(void 0!==a){var u=a.get();void 0!==u&&(u>0?r=i.createElement("u",null,u>99?"99+":u):u<0&&(r=i.createElement("u",{className:"dot"})))}return i.createElement("div",{key:n,className:"",onClick:function(){return t.tabClick(e)}},i.createElement("div",{className:"align-self-center"},r,s(o)))})))},r.c([o.l],e.prototype,"selectedTab",void 0),r.c([o.l],e.prototype,"tabs",void 0),e=r.c([s.a],e)}(i.Component);n.d(e,"a",function(){return l}),n.d(e,"b",function(){return h})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(14),a=n(56);!function(t){function e(e){var n=t.call(this,e)||this;n.schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],n.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},n.onItemChanged=function(t,e,i){return r.b(n,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return n=t.name,[4,a.a.userSetProp(n,e)];case 1:return r.sent(),this.data[n]=e,s.nav.user[n]=e,s.nav.saveLocalUser(),[2]}})})};var i=s.nav.user,o=i.nick,u=i.icon;return n.data={nick:o,icon:u},n}r.d(e,t),e.prototype.render=function(){return i.createElement(s.Page,{header:"\u4e2a\u4eba\u4fe1\u606f"},i.createElement(s.Edit,{schema:this.schema,uiSchema:this.uiSchema,data:this.data,onItemChanged:this.onItemChanged}))},r.c([o.l],e.prototype,"data",void 0)}(i.Component)},function(t,e,n){"use strict";var r=n(0),i=n(1),o=n(10),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.reApi=function(){return r.b(e,void 0,void 0,function(){var t,e,n,i,s,a;return r.e(this,function(r){switch(r.label){case 0:return this.props.clearError(),t=this.props,e=t.channel,n=t.url,i=t.options,s=t.resolve,a=t.reject,[4,Object(o.n)(e,n,i,s,a)];case 1:return r.sent(),[2]}})})},e.close=function(){return r.b(e,void 0,void 0,function(){return r.e(this,function(t){return this.props.clearError(),[2]})})},e}return r.d(e,t),e.prototype.render=function(){var t,e=this.props,n=e.error,r=e.url;if("object"===typeof n){var o=[];for(var s in n)o.push(i.createElement("li",{key:s},i.createElement("label",null,s),i.createElement("div",null,n[s])));t=i.createElement("ul",null,o)}else t=i.createElement("div",null,n);return i.createElement("li",null,i.createElement("article",{className:"page-container"},i.createElement("section",null,i.createElement("div",{className:"va-error"},i.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),i.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),i.createElement("div",null,"url: ",r),t,i.createElement("div",{className:"p-3"},i.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),i.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))},e}(i.Component);e.a=s},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(){function t(t){this.name=t}return t.prototype.get=function(){if(void 0!==this.value)return this.value;var t=localStorage.getItem(this.name);return this.value=null===t?void 0:JSON.parse(t)},t.prototype.set=function(t){t?(this.value=t,localStorage.setItem(this.name,JSON.stringify(t))):this.clear()},t.prototype.clear=function(){this.value=void 0,localStorage.removeItem(this.name)},t}(),i=function(){function t(){this.user=new r("user"),this.guest=new r("guest"),this.unit=new r("unit"),this.homeTabCur=new r("homeTabCur")}return t.prototype.logoutClear=function(){[this.user,this.unit,this.homeTabCur].map(function(t){return t.clear()})},t}()},,function(t,e,n){},function(t,e,n){t.exports=n.p+"static/media/logo.ee7cd8ed.svg"},function(t,e,n){t.exports=n(121)},,,,,function(t,e,n){},,,,,,,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,function(t,e,n){},,,,,,function(t,e,n){},,function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(29),o=n(0),s=(n(96),n(2)),a=n(13),u={tuid:{salestask:{content:function(t){var e=t.desciption,n=t.customer,i=t.type,o=t.sourceid;return r.createElement(r.Fragment,null,Object(a.tv)(e),Object(a.tv)(n),Object(a.tv)(i),Object(a.tv)(o))}}}},c=n(6),l=n.n(c),h=n(3),d=n(5),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onScrollBottom=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){return[2]})})},e.onSalesTaskClick=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){return this.controller.showSalesTaskDetail(t),[2]})})},e.onSalesTaskAdd=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.createTask()];case 1:return t.sent(),[2]}})})},e.renderSalesTask=function(t,n){t.description;var i=t.deadline,o=(t.createTime,t.customer),s=t.type,u=t.typeName,c=t.priorty,d=l()({"my-1 mr-3":!0,"text-danger":c>0,"text-info":!(c>0)});1==c&&r.createElement(h.FA,{name:"circle",className:"text-danger"},"  ");var p=r.createElement("div",{className:d},e.controller.taskIcon(u)),f=r.createElement("div",{className:"text-right"},r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement(h.EasyDate,{date:i}))));return r.createElement(h.LMR,{className:"px-3 py-2",left:p,right:f},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-sm-8 font-weight-bold"},Object(a.tv)(o,function(t){return r.createElement(r.Fragment,null,t.name)})),r.createElement("small",{className:"text-muted ml-3"},Object(a.tv)(s,function(t){return r.createElement(r.Fragment,null,t.name)}))))},e.page=Object(d.a)(function(){var t=e.controller.tasks;e.tasklist=t;var n=r.createElement("div",{className:"my-3 mx-2 text-muted"},"\u65e0\u4efb\u52a1"),i=r.createElement("div",{onClick:e.onSalesTaskAdd,className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),o=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:i},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u9500\u552e\u52a9\u624b"));return r.createElement(s.Page,{header:o,onScrollBottom:e.onScrollBottom},r.createElement(h.List,{before:"",none:n,items:e.controller.tasks,item:{render:e.renderSalesTask,onClick:e.onSalesTaskClick}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return[2]})})},e.prototype.render=function(t){return r.createElement(this.page,null)},e}(s.VPage),f=n(4),m=[{name:"resulttype",type:"id",required:!1},{name:"result",type:"string",required:!0}],v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiSchema={items:{resulttype:{visible:!1},result:{widget:"textarea",label:"\u7ed3\u679c",placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u7ed3\u679c\uff01",rows:12},submit:{widget:"button",label:"\u63d0\u4ea4"}}},e.onCompletionTask=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return t.sent(),[2]}})})},e.onFormButtonClick=function(t,n){return o.b(e,void 0,void 0,function(){var t,e,r;return o.e(this,function(i){switch(i.label){case 0:return t=n.form.data,e=t.result,r=t.resulttype,[4,this.controller.completionTask(this.taskid,e,r)];case 1:return i.sent(),this.closePage(2),[2]}})})},e.page=Object(d.a)(function(t){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:e.onCompletionTask},"\u5b8c\u7ed3");return r.createElement(s.Page,{header:"\u5b8c\u7ed3\u4efb\u52a1",footer:n},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{ref:function(t){return e.form=t},className:"my-3",schema:m,uiSchema:e.uiSchema,onButtonClick:e.onFormButtonClick})))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.taskid=t.id,this.openPage(this.page,t),[2]})})},e}(s.VPage),b=[{name:"resulttype",type:"string",required:!1},{name:"result",type:"string",required:!0},{name:"date",type:"date",required:!0}],y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiSchema={items:{resulttype:{visible:!1},result:{widget:"textarea",label:"\u539f\u56e0",placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u7ed3\u679c\uff01",rows:12},date:{widget:"date",label:"\u65e5\u671f",placeholder:"\u8bf7\u8f93\u5165\u65e5\u671f\uff01"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},e.onExtensionTask=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return t.sent(),[2]}})})},e.onFormButtonClick=function(t,n){return o.b(e,void 0,void 0,function(){var t,e,r,i;return o.e(this,function(o){switch(o.label){case 0:return t=n.form.data,e=t.result,r=t.resulttype,i=t.date,[4,this.controller.extensionTask(this.taskid,e,r,i)];case 1:return o.sent(),this.closePage(2),[2]}})})},e.page=Object(d.a)(function(t){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:e.onExtensionTask},"\u5b8c\u7ed3");return r.createElement(s.Page,{header:"\u5ef6\u671f\u4efb\u52a1",footer:n},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{ref:function(t){return e.form=t},className:"my-3",schema:b,uiSchema:e.uiSchema,onButtonClick:e.onFormButtonClick})))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.taskid=t.id,this.openPage(this.page,t),[2]})})},e}(s.VPage),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){var n=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u65e0\u8bb0\u5f55\uff01");return r.createElement(s.Page,{header:"\u8be6\u60c5"},r.createElement(h.List,{before:"",none:n,items:e.salestask,item:{render:e.renderSalesTask}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.salestask=t,this.openPage(this.page,t),[2]})})},e.prototype.renderSalesTask=function(t,e){var n=t.description,i=t.deadline,o=t.DATE,s=t.result;t.type,r.createElement("div",{className:"text-right"},r.createElement("div",null,r.createElement("small",{className:"text-muted"},"\u9884\u5b9a\uff1a",r.createElement(h.EasyDate,{date:i}))),r.createElement("div",null,r.createElement("small",{className:"text-muted"},"\u5b8c\u6210\uff1a")));return r.createElement("div",{className:"d-block px-3 py-2"},r.createElement("div",null,r.createElement("span",{className:"small text-muted"},r.createElement(h.EasyDate,{date:o}))," ",n),r.createElement("div",null,s))},e}(s.VPage),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.render=function(t){var e=this,n=this.controller.cSalesTask,i=n.showCustomerDetail,s=n.showSalesTaskHistory,u=(t.type,t.customer),c=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 pb-3",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,i(u.id)];case 1:return[2,t.sent()]}})})},left:r.createElement("div",{className:"mr-2"}," ",r.createElement(h.FA,{name:"user",className:"text-info mr-2 pt-1 "})," "),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))},Object(a.tv)(u,function(t){return r.createElement(r.Fragment,null,t.name)})),label:""},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,s(u.id)];case 1:return[2,t.sent()]}})})},left:r.createElement("span",null,r.createElement(h.FA,{className:"text-warning",name:"hand-o-right"})," \xa0 \u8be6\u60c5"),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))})}];return r.createElement(h.PropGrid,{className:"my-2",rows:c,values:t})},e}(s.View),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.render=function(t){var e=this,n=this.controller.cSalesTask.showCustomerDetail,i=(t.type,t.customer),s=(this.controller.cSalesTask.cApp.cCustomer,[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,n(i.id)];case 1:return[2,t.sent()]}})})},left:r.createElement("div",{className:"mr-2"}," ",r.createElement(h.FA,{name:"user",className:"text-info mr-2 pt-1 "})," "),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))},Object(a.tv)(i,function(t){return r.createElement(r.Fragment,null,t.name)})),label:""}]);return r.createElement(h.PropGrid,{className:"my-2",rows:s,values:t})},e}(s.View),k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon="plus",e}return o.d(e,t),e.prototype.showDetail=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openPage(r.createElement(s.Page,{header:t.typeName},"\u6ca1\u6709\u7ee7\u627f\u54e6\uff01")),[2]})})},e.prototype.showCreate=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openPage(r.createElement(s.Page,{header:t.typeName},"\u6ca1\u6709\u7ee7\u627f\u54e6\uff01")),[2]})})},e.prototype.renderDetailTop=function(t){return this.renderView(w,t)},e.prototype.renderCreateTop=function(t){return this.renderView(E,t)},e}(s.Controller),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){return e.render(t)}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.controller.cSalesTask.loadSalesTaskDetail(t.id)];case 1:return e=n.sent(),this.openPage(this.page,e),[2]}})})},e.prototype.itemrender=function(t){var e,n=t.deadline,i=t.description;1==t.priorty&&(e=r.createElement(h.FA,{name:"circle",className:"text-danger"}));var o=r.createElement("div",{className:"text-right"},r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement("small",null,e),r.createElement(h.EasyDate,{date:n}))));return r.createElement(h.LMR,{className:"cursor-pointer w-100",right:o,left:"\u5185\u5bb9"},i)},e.prototype.render=function(t){var e=this,n=this.controller.cSalesTask,i=n.showSalesTaskComplet,a=n.showSalesTaskExtension,u=n.onInvalidTask,c=(n.showCustomerDetail,n.showSalesTaskHistory,t.deadline),l=(t.description,t.priorty,[{type:"component",name:"description",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-2",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"newspaper-o"}," "),"  ")," \xa0\xa0\u63cf\u8ff0 "),right:r.createElement("div",null," ",r.createElement("small",{className:"text-muted"},r.createElement("small",null),r.createElement(h.EasyDate,{date:c})))})},{type:"string",name:"description"}]),d=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-primary px-4 ",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,i(t)];case 1:return[2,e.sent()]}})})}},"\u5904\u7406")),p=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2 ",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,a(t)];case 1:return[2,e.sent()]}})})}},"\u63a8\u8fdf"),r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2 ",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,u(t)];case 1:return[2,e.sent()]}})})}},"\u62d2\u7edd")),f=r.createElement(h.LMR,{className:"px-1",left:d,right:p});return r.createElement(s.Page,{header:this.controller.caption,footer:f},this.controller.renderDetailTop(t),r.createElement(h.PropGrid,{rows:l,values:t}))},e}(s.VPage),P=[{name:"id",type:"id",required:!1},{name:"customer",type:"id",required:!1},{name:"type",type:"id",required:!1},{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!0}],N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiSchema={items:{id:{visible:!1},customer:{visible:!1},type:{visible:!1},description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},e.onAddSalesTask=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return t.sent(),[2]}})})},e.onFormButtonClick=function(t,n){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.cSalesTask.addSalesTask(n.form.data,this.task)];case 1:return t.sent(),this.closePage(1),[2]}})})},e.page=Object(d.a)(function(t){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:e.onAddSalesTask},"\u4fdd\u5b58");return r.createElement(s.Page,{header:e.controller.caption,footer:n},r.createElement("div",{className:"App-container container text-left"},e.controller.renderCreateTop(t),r.createElement(s.Form,{ref:function(t){return e.form=t},className:"my-3",schema:P,uiSchema:e.uiSchema,onButtonClick:e.onFormButtonClick,requiredFlag:!1})))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.task=t,this.openPage(this.page,t),[2]})})},e}(s.VPage),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=r.createElement(h.FA,{name:"flask",size:"lg"}),e}return o.d(e,t),e.prototype.internalStart=function(t){},e.prototype.showDetail=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openVPage(C,t),[2]})})},e.prototype.showCreate=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openVPage(N,t),[2]})})},e}(k),x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){var n=e.controller.cSalesTask,i=n.showSalesTaskComplet,u=n.showSalesTaskExtension,c=n.onInvalidTask,l=n.showCustomerDetail,d=(n.showSalesTaskHistory,t.type),p=t.customer,f=t.deadline,m=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,l(p.id)];case 1:return[2,t.sent()]}})})},right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))},Object(a.tv)(p,function(t){return r.createElement(r.Fragment,null,t.name)})),label:"\u5ba2\u6237"},{type:"component",name:"type",component:r.createElement(h.LMR,{className:"cursor-pointer w-100"},Object(a.tv)(d,function(t){return r.createElement(r.Fragment,null,t.name)})),label:"\u7c7b\u578b"},{type:"string",name:"description",label:"\u5185\u5bb9"},{type:"string",name:"priorty",label:"\u91cd\u8981\u6027"},{type:"component",name:"deadline",component:r.createElement(h.EasyDate,{date:f}),label:"\u8981\u6c42\u5b8c\u6210\u65e5\u671f"}],v=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-primary px-5",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,i(t)];case 1:return[2,e.sent()]}})})}},"\u5904\u7406")),b=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-outline-info ml-3",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,u(t)];case 1:return[2,e.sent()]}})})}},"\u63a8\u8fdf"),r.createElement("button",{type:"button",className:"btn btn-outline-info ml-3",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,c(t)];case 1:return[2,e.sent()]}})})}},"\u62d2\u7edd")),y=r.createElement(h.LMR,{className:"px-1",left:v,right:b});return r.createElement(s.Page,{header:"\u4efb\u52a1\u8be6\u60c5",footer:y},r.createElement(h.PropGrid,{rows:m,values:t}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.controller.cSalesTask.loadSalesTaskDetail(t.id)];case 1:return e=n.sent(),this.openPage(this.page,e),[2]}})})},e}(s.VPage),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.internalStart=function(t){},e.prototype.showDetail=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openVPage(x,t),[2]})})},e}(k),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){return e.render(t)}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.controller.cSalesTask.loadSalesTaskDetail(t.id)];case 1:return e=n.sent(),this.openPage(this.page,e),[2]}})})},e.prototype.itemrender=function(t){var e,n=t.deadline,i=t.description;1==t.priorty&&(e=r.createElement(h.FA,{name:"circle",className:"text-danger"}));var o=r.createElement("div",{className:"text-right"},r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement("small",null,e),r.createElement(h.EasyDate,{date:n}))));return r.createElement(h.LMR,{className:"cursor-pointer w-100",right:o},i)},e.prototype.render=function(t){var e=this,n=this.controller.cSalesTask,i=n.showSalesTaskComplet,a=n.showSalesTaskExtension,u=n.onInvalidTask,c=(n.showCustomerDetail,n.showSalesTaskHistory,t.deadline),l=(t.description,t.priorty,[{type:"component",name:"description",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-2",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"newspaper-o"}," "),"  ")," \xa0\xa0\u63cf\u8ff0 "),right:r.createElement("div",null," ",r.createElement("small",{className:"text-muted"},r.createElement("small",null),r.createElement(h.EasyDate,{date:c})))})},{type:"string",name:"description"}]),d=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-primary px-4",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,i(t)];case 1:return[2,e.sent()]}})})}},"\u5904\u7406")),p=r.createElement("span",null,r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,a(t)];case 1:return[2,e.sent()]}})})}},"\u63a8\u8fdf"),r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2",onClick:function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,u(t)];case 1:return[2,e.sent()]}})})}},"\u62d2\u7edd")),f=r.createElement(h.LMR,{className:"px-1",left:d,right:p});return r.createElement(s.Page,{header:this.controller.caption,footer:f},this.controller.renderDetailTop(t),r.createElement(h.PropGrid,{rows:l,values:t}))},e}(s.VPage),O=[{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!0}],V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiSchema={items:{description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},e.onAddSalesTask=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return t.sent(),[2]}})})},e.onFormButtonClick=function(t,n){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.cSalesTask.addSalesTask(n.form.data,this.salestask)];case 1:return t.sent(),this.closePage(1),[2]}})})},e.page=Object(d.a)(function(t){return e.render(t)}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.salestask=t,this.openPage(this.page,t),[2]})})},e.prototype.render=function(t){var e=this,n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:this.onAddSalesTask},"\u4fdd\u5b58");return r.createElement(s.Page,{header:this.controller.caption,footer:n},r.createElement("div",{className:"App-container container text-left"},this.controller.renderCreateTop(t),r.createElement(s.Form,{ref:function(t){return e.form=t},className:"my-3",schema:O,uiSchema:this.uiSchema,onButtonClick:this.onFormButtonClick,requiredFlag:!1})))},e}(s.VPage),I={typeA:F,"\u8bd5\u5242\u62a5\u4ef7\u8ddf\u8e2a":S,"\u5927\u5305\u88c5\u62a5\u4ef7\u8ddf\u8e2a":function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=r.createElement(h.FA,{name:"flask",size:"lg"}),e.caption="\u5927\u5305\u88c5\u62a5\u4ef7\u8ddf\u8e2a",e}return o.d(e,t),e.prototype.internalStart=function(t){},e.prototype.showDetail=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openVPage(T,t),[2]})})},e.prototype.showCreate=function(t){return o.b(this,void 0,Promise,function(){return o.e(this,function(e){return this.openVPage(V,t),[2]})})},e}(k)};var A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickTaskType=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.selectTaskType(t)];case 1:return e.sent(),this.ceasePage(1),[2]}})})},e.page=Object(d.a)(function(t){var n=e.controller,i=n.tasktypelist,o=(n.selectTaskType,r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u62b1\u6b49\uff0c\u672a\u627e\u5230\u76f8\u5173\u4ea7\u54c1\uff0c\u8bf7\u91cd\u65b0\u641c\u7d22\uff01"));return r.createElement(s.Page,{header:"\u9009\u62e9\u4efb\u52a1\u7c7b\u578b"},r.createElement(h.List,{before:"",none:o,items:i,item:{render:e.renderList,onClick:e.onClickTaskType}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e.prototype.renderList=function(t,e){var n=t.description,i=t.name,o=r.createElement("small",{className:"text-muted"},n);return r.createElement(h.LMR,{className:"px-3 py-2",right:o},r.createElement("div",{className:"font-weight-bold"},i))},e}(s.VPage),j=function(t){function e(e,n){var r=t.call(this,n)||this;r.selectTaskType=function(t){return o.b(r,void 0,Promise,function(){return o.e(this,function(e){return this.returnCall(t),[2]})})},r.cSalesTask=e;var i=r.cSalesTask.cApp.cUqSalesTask;return r.tuidTaskType=i.tuid("tasktype"),r}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.customerid=t,[4,this.searchByKey(null)];case 1:return e.sent(),this.openVPage(A,t),[2]}})})},e.prototype.searchByKey=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return e=this,[4,this.tuidTaskType.search(t,0,100)];case 1:return e.tasktypelist=n.sent(),[2]}})})},o.c([f.l],e.prototype,"tasktypelist",void 0),e}(s.Controller),q=(function(t){function e(e){var n=t.call(this)||this;return n.firstSize=n.pageSize=10,n.searchsalestskQuery=e,n}o.d(e,t),e.prototype.load=function(t,e,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===e&&(e=0),[4,this.searchsalestskQuery.page(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id}}(s.PageItems),function(t){function e(e,n){var i=t.call(this,n)||this;i.taskTypes={},i.searchByKey=function(t){return o.b(i,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return[4,this.qeuryGettask.table({})];case 1:return t=e.sent(),this.tasks=t,[2]}})})},i.searchSalesTaskHistory=function(t){return o.b(i,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.qeurySearchHistory.table({customerid:t})];case 1:return e=n.sent(),this.tasks=e,[2]}})})},i.showSalesTaskHistory=function(t){return o.b(i,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return{customerid:t},[4,this.qeurySearchHistory.table({customerid:t})];case 1:return e=n.sent(),this.openVPage(g,e),[2]}})})},i.showSalesTaskDetail=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.getCTaskType(t.typeName).showDetail(t),[2]})})},i.loadSalesTaskDetail=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.taskTuid.load(t)];case 1:return[2,e.sent()]}})})},i.showSalesTaskComplet=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.openVPage(v,t),[2]})})},i.showSalesTaskExtension=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.openVPage(y,t),[2]})})},i.onInvalidTask=function(t){return o.b(i,void 0,void 0,function(){var e,n;return o.e(this,function(r){switch(r.label){case 0:return e={taskid:t.id,result:"\u65e0\u6548\u4efb\u52a1"},[4,this.completionTaskAction.submit(e)];case 1:return r.sent(),(n=this.tasks.findIndex(function(e){return e.id===t.id}))>=0&&this.tasks.splice(n,1),this.closePage(1),[2]}})})},i.createTask=function(){return o.b(i,void 0,void 0,function(){var t,e,n,r;return o.e(this,function(i){switch(i.label){case 0:return[4,this.selectCustomer()];case 1:return t=i.sent(),[4,this.selectTaskType()];case 2:return e=i.sent(),n=e.name,r={id:null,type:e,typeName:n,customer:t},this.getCTaskType(n).showCreate(r),[2]}})})},i.selectCustomer=function(){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.cApp.cCustomer.call()];case 1:return[2,t.sent()]}})})},i.selectTaskType=function(){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.cSalesTaskType.call()];case 1:return[2,t.sent()]}})})},i.addSalesTask=function(t,e){return o.b(i,void 0,void 0,function(){var n,r,i,s,a,u,c,l,h;return o.e(this,function(o){switch(o.label){case 0:return n=t.description,r=t.priorty,i=t.deadline,s=e.customer,a=e.type,u=s.id,c=a.id,l={id:void 0,description:n,customer:u,type:c,sourceID:"",sourceType:"",sourceNo:"",priorty:r=r?1:0,deadline:i},[4,this.addTaskAction.submit(l)];case 1:return h=o.sent(),l.id=h.id,[4,this.searchByKey(t)];case 2:return o.sent(),[2]}})})},i.showCustomerDetail=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.cApp.cCustomer.showCustomerDetail(t),[2]})})},i.render=Object(d.a)(function(){return i.renderView(p)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=e,i.cSalesTaskType=new j(i,void 0);var s=i.cApp,a=s.cUqSalesTask,u=s.cUqCustomer;return i.taskTuid=a.tuid("task"),i.tuidCustomer=u.tuid("customer"),i.taskTypeTuid=a.tuid("tasktype"),i.taskBook=a.book("taskbook"),i.completionTaskAction=a.action("CompletionTask"),i.extensionTaskAction=a.action("ExtensionTask"),i.addTaskAction=a.action("AddTask"),i.qeuryGettask=a.query("Gettask"),i.qeurySearchHistory=a.query("searchhistorytask"),i.taskTypes=function(t){var e={};for(var n in I){var r=e[n]=new I[n](void 0);r.cSalesTask=t,r.caption||(r.caption=n)}return e}(i),i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.searchByKey(t)];case 1:return e.sent(),[2]}})})},e.prototype.taskIcon=function(t){var e=this.taskTypes[t];if(void 0===e)throw t+" is not defined";return e.icon},e.prototype.getCTaskType=function(t){var e=this.taskTypes[t];if(void 0===e)throw t+" is not defined";return e},e.prototype.completionTask=function(t,e,n){return o.b(this,void 0,void 0,function(){var n,r;return o.e(this,function(i){switch(i.label){case 0:return n={taskid:t,result:e},[4,this.completionTaskAction.submit(n)];case 1:return i.sent(),(r=this.tasks.findIndex(function(e){return e.id===t}))>=0&&this.tasks.splice(r,1),this.closePage(2),[2]}})})},e.prototype.extensionTask=function(t,e,n,r){return o.b(this,void 0,void 0,function(){var n;return o.e(this,function(i){switch(i.label){case 0:return n={taskid:t,result:e,deadline:r},[4,this.extensionTaskAction.submit(n)];case 1:return i.sent(),[2]}})})},o.c([f.l],e.prototype,"tasks",void 0),e}(s.Controller)),R="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask",L="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customer",D="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/product",U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickCustomer=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.selectCustomer(t)];case 1:return e.sent(),this.ceasePage(),[2]}})})},e.page=Object(d.a)(function(t){var n=e.controller.pageCustomer,i=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u8bf7\u641c\u7d22\u5ba2\u6237\uff01");return r.createElement(s.Page,{header:"\u9009\u62e9\u5ba2\u6237"},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2",size:"sm",onSearch:function(t){return e.controller.searchByKey(t)},placeholder:"\u641c\u7d22\u5ba2\u6237\u59d3\u540d\u3001\u5355\u4f4d"}),r.createElement(h.List,{before:"",none:i,items:n,item:{render:e.renderCustomer,onClick:e.onClickCustomer}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e.prototype.renderCustomer=function(t,e){var n=t.name;return r.createElement(h.LMR,{className:"px-3 py-2 ",left:r.createElement(h.FA,{name:"user",className:" my-2 mr-3 text-info"})},r.createElement("div",{className:"font-weight-bold"}),r.createElement("div",null,n))},e}(s.VPage),M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){var e=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"university",className:"text-info"}))," \xa0\u5317\u4eac\u5927\u5b66"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"string",name:"no",label:"\u7f16\u53f7"},{type:"string",name:"name",label:"\u59d3\u540d"},{type:"string",name:"gender",label:"\u6027\u522b"},{type:"string",name:"birthday",label:"\u751f\u65e5"},{type:"string",name:"birthday",label:"\u9886\u57df"},{type:"string",name:"birthday",label:"TOP\u5355\u4f4d"}];return r.createElement(s.Page,{header:"\u5ba2\u6237\u8be6\u60c5"},r.createElement(h.PropGrid,{rows:e,values:t,alignValue:"right"}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e}(s.VPage),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickCustomer=function(t){return o.b(e,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.showCustomerDetail(t.id)];case 1:return e.sent(),[2]}})})},e.page=Object(d.a)(function(t){var n=e.controller,i=(n.showCustomerDetail,n.pageCustomer),o=r.createElement("div",{className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),a=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u8bf7\u641c\u7d22\u5ba2\u6237\uff01");r.createElement("br",null);var u=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:o},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u5ba2\u6237"));return r.createElement(s.Page,{header:u},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2 ",size:"sm",onSearch:function(t){return e.controller.searchByKey(t)},placeholder:"\u641c\u7d22\u5ba2\u6237\u59d3\u540d\u3001\u5355\u4f4d"}),r.createElement(h.List,{before:"",none:a,items:i,item:{render:e.renderCustomer,onClick:e.onClickCustomer}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e.prototype.render=function(t){return r.createElement(this.page,null)},e.prototype.renderCustomer=function(t,e){var n=t.name;return r.createElement(h.LMR,{className:"px-3 py-2 ",left:r.createElement(h.FA,{name:"user",className:" my-2 mr-3 text-info"})},r.createElement("div",{className:"font-weight-bold"}),r.createElement("div",null,n))},o.c([f.l],e.prototype,"tasks",void 0),e}(s.VPage),_=function(t){function e(e){var n=t.call(this)||this;return n.firstSize=n.pageSize=10,n.searchCustomerQuery=e,n}return o.d(e,t),e.prototype.load=function(t,e,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===e&&(e=0),[4,this.searchCustomerQuery.page(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(s.PageItems),H=function(t){function e(e,n){var i=t.call(this,n)||this;i.searchByKey=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.pageCustomer=new _(this.querySearchCustomer),this.pageCustomer.first({key:t}),[2]})})},i.loadCustomerDetail=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.tuidCustomer.load(t)];case 1:return[2,e.sent()]}})})},i.showCustomerDetail=function(t){return o.b(i,void 0,void 0,function(){var e;return o.e(this,function(n){switch(n.label){case 0:return[4,this.loadCustomerDetail(t)];case 1:return e=n.sent(),this.openVPage(M,e),[2]}})})},i.selectCustomer=function(t){return o.b(i,void 0,Promise,function(){return o.e(this,function(e){return this.returnCall(t),[2]})})},i.render=Object(d.a)(function(){return i.pageCustomer=null,i.renderView(B)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=e;var s=i.cApp,a=s.cUqSalesTask,u=s.cUqCustomer;return i.tuidCustomer=a.tuid("customer"),i.querySearchCustomer=u.query("searchcustomer"),i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.pageCustomer=null,this.openVPage(U,t),[2]})})},o.c([f.l],e.prototype,"pageCustomer",void 0),e}(s.Controller),$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.page=Object(d.a)(function(t){var n=e.controller.pageProduct,i=r.createElement("div",{className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),o=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u8bf7\u641c\u7d22\u5ba2\u6237\uff01");r.createElement("br",null);var a=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:i},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u4ea7\u54c1"));return r.createElement(s.Page,{header:a},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2 ",size:"sm",onSearch:function(t){return e.controller.searchByKey(t)},placeholder:"\u641c\u7d22\u54c1\u540d\u3001\u7f16\u53f7\u3001CAS\u3001MDL\u7b49"}),r.createElement(h.List,{before:"",none:o,items:n,item:{render:e.renderProduct,onClick:null}}))}),e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.page,t),[2]})})},e.prototype.render=function(t){return r.createElement(this.page,null)},e.prototype.renderProduct=function(t,e){var n=t.description;return r.createElement(h.LMR,{className:"px-3 py-2"},r.createElement("div",{className:"font-weight-bold"}),r.createElement("div",null,n))},o.c([f.l],e.prototype,"tasks",void 0),e}(s.VPage),W=function(t){function e(e){var n=t.call(this)||this;return n.firstSize=n.pageSize=10,n.searchProductQuery=e,n}return o.d(e,t),e.prototype.load=function(t,e,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===e&&(e=0),[4,this.searchProductQuery.page(t,e,n)];case 1:return[2,r.sent()]}})})},e.prototype.setPageStart=function(t){this.pageStart=void 0===t?0:t.id},e}(s.PageItems),z=function(t){function e(e,n){var i=t.call(this,n)||this;i.searchByKey=function(t){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){return this.pageProduct=new W(this.querySearchProduct),this.pageProduct.first({key:t}),[2]})})},i.render=Object(d.a)(function(){return i.renderView($)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=e;var s=i.cApp;s.cUqSalesTask,s.cUqCustomer,s.cUqProduct;return i.pageProduct=null,i}return o.d(e,t),e.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openVPage(null,t),[2]})})},o.c([f.l],e.prototype,"pageProduct",void 0),o.c([f.l],e.prototype,"customerlist",void 0),e}(s.Controller),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(n){switch(n.label){case 0:return this.cUqSalesTask=this.getCUq(R),this.cUqCustomer=this.getCUq(L),this.cUqProduct=this.getCUq(D),this.cCustomer=new H(this,void 0),this.cProduct=new z(this,void 0),this.cSalesTask=new q(this,void 0),this.cSalesTask.start(),[4,t.prototype.internalStart.call(this,e)];case 1:return n.sent(),[2]}})})},e}(a.CApp),G=function(t){return!0===t?"text-primary":"text-muted"},Q={appName:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask",CApp:K,main:function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.render=function(t){var n=e.controller,i=n.cSalesTask,o=n.cCustomer,a=n.cProduct,u=[{name:"home",label:"\u4efb\u52a1",content:i.tab,icon:"home",notify:void 0},{name:"member",label:"\u5ba2\u6237",content:o.tab,icon:"vcard"},{name:"member",label:"\u4ea7\u54c1",content:a.tab,icon:"flask"},{name:"member",label:"\u6211",content:i.tab,icon:"user"}].map(function(t){var e=t.name,n=t.label,r=t.icon;return{name:e,caption:function(t){return Object(s.TabCaptionComponent)(n,r,G(t))},content:t.content,notify:t.notify}});return r.createElement(s.Page,{header:!1},r.createElement(s.Tabs,{tabs:u}))},e}return o.d(e,t),e.prototype.open=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.render),[2]})})},e}(s.VPage),uqs:{"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask":u}},J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onLogined=function(){return o.b(e,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,Object(a.startApp)(Q)];case 1:return t.sent(),[2]}})})},e}return o.d(e,t),e.prototype.render=function(){return r.createElement(s.NavView,{onLogined:this.onLogined,notLogined:this.onLogined})},e}(r.Component),Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function X(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e&&(e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(t){console.error("Error during service worker registration:",t)})}n(117),n(119);i.render(r.createElement(J,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="./service-worker.js";Y?(function(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):X(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):X(t)})}}()}],[[91,4,3]]]);
//# sourceMappingURL=main.9ffdb1fa.chunk.js.map