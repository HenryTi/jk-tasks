(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(e,t,n){"use strict";n(58),n(23);var r=n(11);n.d(t,"CenterApi",function(){return r.a}),n.d(t,"UnitxApi",function(){return r.c}),n.d(t,"UqApi",function(){return r.d}),n.d(t,"appInFrame",function(){return r.f}),n.d(t,"getExHash",function(){return r.g}),n.d(t,"loadAppUqs",function(){return r.k}),n.d(t,"postWsToTop",function(){return r.m});var i=n(14);n.o(i,"Controller")&&n.d(t,"Controller",function(){return i.Controller}),n.o(i,"Form")&&n.d(t,"Form",function(){return i.Form}),n.o(i,"Image")&&n.d(t,"Image",function(){return i.Image}),n.o(i,"NavView")&&n.d(t,"NavView",function(){return i.NavView}),n.o(i,"Page")&&n.d(t,"Page",function(){return i.Page}),n.o(i,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",function(){return i.TabCaptionComponent}),n.o(i,"Tabs")&&n.d(t,"Tabs",function(){return i.Tabs}),n.o(i,"VPage")&&n.d(t,"VPage",function(){return i.VPage}),n.o(i,"View")&&n.d(t,"View",function(){return i.View}),n.o(i,"nav")&&n.d(t,"nav",function(){return i.nav}),n.o(i,"resLang")&&n.d(t,"resLang",function(){return i.resLang});n(25);var o=n(66);n.d(t,"PageItems",function(){return o.a});n(67),n(86)},function(e,t,n){"use strict";var r=n(43);n.o(r,"EasyDate")&&n.d(t,"EasyDate",function(){return r.EasyDate}),n.o(r,"FA")&&n.d(t,"FA",function(){return r.FA}),n.o(r,"LMR")&&n.d(t,"LMR",function(){return r.LMR}),n.o(r,"List")&&n.d(t,"List",function(){return r.List}),n.o(r,"Muted")&&n.d(t,"Muted",function(){return r.Muted}),n.o(r,"PropGrid")&&n.d(t,"PropGrid",function(){return r.PropGrid}),n.o(r,"SearchBox")&&n.d(t,"SearchBox",function(){return r.SearchBox});var i=n(82);n.d(t,"List",function(){return i.a});n(72);var o=n(73);n.d(t,"EasyDate",function(){return o.a});var s=n(83);n.d(t,"PropGrid",function(){return s.a});var a=n(80);n.d(t,"FA",function(){return a.a}),n.d(t,"LMR",function(){return a.b}),n.d(t,"Muted",function(){return a.c});n(74),n(84);var u=n(75);n.d(t,"SearchBox",function(){return u.a});n(76),n(20)},,,,function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return u});var r=n(0),i=n(2),o=n(28),s=n(45),a=function(e){function t(t,n,r,i){var o=e.call(this,t,i)||this;Object.setPrototypeOf(o.x,t.x);var a=n.name,u=n.typeName;return o.entity=n,o.ui=r,o.label=o.res.label||a,o.icon=s.a[u],o}return r.d(t,e),t.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.loadSchema()];case 1:return e.sent(),[2,!0]}})})},t.prototype.createForm=function(e,t,n){var r=this.buildFormOptions(n),i=new o.b(r,e);return i.setValues(t),i},t.prototype.buildFormOptions=function(e){var t,n,r,i,s,a=this.entity,u=a.fields,c=a.arrFields;void 0!==this.res&&(t=this.res.none,n=this.res.submit,r=this.res.arrNew,i=this.res.arrEdit,s=this.res.arrTitleNewButton),void 0===t&&(t=this.cUq.res.none||"none"),void 0===n&&(n=this.cUq.res.submit||"Submit"),void 0===r&&(r=this.cUq.res.arrNew||"New"),void 0===i&&(i=this.cUq.res.arrEdit||"Edit"),void 0===s&&(s=this.cUq.res.arrTitleNewButton),void 0===e&&(e=o.a.new);var l=this.ui.form;return{fields:u,arrs:c,ui:l,res:this.res||{},inputs:this.buildInputs(l),none:t,submitCaption:n,arrNewCaption:r,arrEditCaption:i,arrTitleNewButton:s,mode:e}},t.prototype.buildInputs=function(e){var t=this.entity,n=t.fields,r=t.arrFields,i={};if(this.buildFieldsInputs(i,n,void 0,e),void 0!==r)for(var o=0,s=r;o<s.length;o++){var a=s[o],u=a.name,c=a.fields,l=e&&e.items;this.buildFieldsInputs(i,c,u,l&&l[u])}return i},t.prototype.buildFieldsInputs=function(e,t,n,r){if(void 0!==n){var i=e[n];void 0===i&&(e[n]=i={},e=i)}for(var o=0,s=t;o<s.length;o++){var a=s[o],u=a.name,c=a._tuid;if(void 0!==c){var l=r&&r.items&&r.items[u];e[u]={select:this.buildSelect(a,n,l),content:this.buildContent(a,n),placeHolder:this.cUq.getTuidPlaceHolder(c)}}}},t.prototype.buildSelect=function(e,t,n){var i=this;return function(e,t,o){return r.b(i,void 0,Promise,function(){var i,o,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return i=t._tuid,o=t._ownerField,[4,i.cSelectFrom()];case 1:return s=r.sent(),a=void 0,void 0!==o&&(a=e.getValue(o.name)),n&&!0===n.autoList&&(console.log("select search set param=empty string"),a=""),[4,s.call(a)];case 2:return u=r.sent(),s.removeCeased(),void 0===u?[2,void 0]:(c=s.idFromItem(u),i.useId(c),[2,c])}})})}},t.prototype.buildContent=function(e,t){},t.prototype.cQuerySelect=function(e){return this.cUq.cQuerySelect(e)},t}(n(46).a),u=function(e){function t(t){var n=e.call(this,t)||this;return n.entity=t.entity,n.ui=t.ui,n}return r.d(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this.controller.label},enumerable:!0,configurable:!0}),t.prototype.createForm=function(e,t,n){return this.controller.createForm(e,t,n)},t}(i.VPage)},,function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return v}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return w});var r,i=n(0),o=n(1),s=n(4),a=n(16),u=n(55),c=n(87),l=n(15),h=n(88),d=n(11),p=n(19),f=n(27),m=n(40),v=(n(60),n(90),n(104),n(106),new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent)?{minHeight:"3em"}:void 0),b=(n(91),[]),y=1,g=function(t){function n(e){var n=t.call(this,e)||this;return n.waitCount=0,n.isHistoryBack=!1,n.clearError=function(){n.setState({fetchError:void 0})},n.back=n.back.bind(n),n.navBack=n.navBack.bind(n),n.stack=[],n.state={stack:n.stack,wait:0,fetchError:void 0},n}return i.d(n,t),n.prototype.componentWillMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){return window.addEventListener("popstate",this.navBack),[2]})})},n.prototype.componentDidMount=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return w.set(this),[4,w.start()];case 1:return e.sent(),[2]}})})},Object.defineProperty(n.prototype,"level",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),n.prototype.startWait=function(){var t=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=e.setTimeout(function(){t.waitTimeHandler=void 0,t.setState({wait:2})},1e3)),++this.waitCount,this.setState({fetchError:void 0})},n.prototype.endWait=function(){var e=this;setTimeout(function(){--e.waitCount,0===e.waitCount&&(void 0!==e.waitTimeHandler&&(clearTimeout(e.waitTimeHandler),e.waitTimeHandler=void 0),e.setState({wait:0}))},100)},n.prototype.onError=function(e){return i.b(this,void 0,void 0,function(){var t;return i.e(this,function(n){switch(n.label){case 0:return void 0===(t=e.error)||!0!==t.unauthorized?[3,2]:[4,w.showLogin(void 0)];case 1:return n.sent(),[2];case 2:return this.setState({fetchError:e}),[2]}})})},n.prototype.show=function(e,t){return this.clear(),this.push(e,t)},n.prototype.push=function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=y++;return this.stack.push({key:n,view:e,ceased:!1,disposer:t}),this.refresh(),n},n.prototype.replace=function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var i=y++;return this.stack.push({key:i,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh(),i},n.prototype.ceaseTop=function(e){void 0===e&&(e=1);for(var t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){this.stack[t].ceased=!0}},n.prototype.pop=function(e){void 0===e&&(e=1);var t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,i=0;i<e&&0!==t.length;i++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}},n.prototype.popTo=function(e){if(void 0!==e&&void 0!==this.stack.find(function(t){return t.key===e}))for(;this.stack.length>0;){var t=this.stack.length;if(this.stack[t-1].key===e)break;this.pop()}},n.prototype.topKey=function(){var e=this.stack.length;if(0!==e)return this.stack[e-1].key},n.prototype.removeCeased=function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()},n.prototype.popAndDispose=function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}},n.prototype.dispose=function(e){void 0!==e&&(void 0===this.stack.find(function(t){return t.disposer===e})&&e())},n.prototype.clear=function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose()},n.prototype.regConfirmClose=function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)},n.prototype.navBack=function(){w.log("backbutton pressed - nav level: "+this.stack.length),this.isHistoryBack=!0,this.back(!0),this.isHistoryBack=!1},n.prototype.back=function(e){return void 0===e&&(e=!0),i.b(this,void 0,void 0,function(){var t,n,r;return i.e(this,function(i){switch(i.label){case 0:return t=this.stack,0===(n=t.length)?[2]:1===n?(self!=window.top&&window.top.postMessage({type:"pop-app"},"*"),[2]):(r=t[n-1],!0===e&&r.confirmClose?[4,r.confirmClose()]:[3,2]);case 1:return!0===i.sent()&&this.pop(),[3,3];case 2:this.pop(),i.label=3;case 3:return[2]}})})},n.prototype.confirmBox=function(e){return window.confirm(e)},n.prototype.render=function(){var e=this.state,t=e.wait,n=e.fetchError,r=this.state.stack,s=r.length-1,a=null,u=null;switch(t){case 1:a=o.createElement("li",{className:"va-wait va-wait1"});break;case 2:a=o.createElement("li",{className:"va-wait va-wait2"},o.createElement(m.a,null))}return n&&(u=o.createElement(c.a,i.a({clearError:this.clearError},n))),o.createElement("ul",{className:"va"},r.map(function(e,t){var n=e.key,r=e.view;return o.createElement("li",{key:n,style:t<s?{visibility:"hidden"}:void 0},r)}),a,u)},n.prototype.refresh=function(){this.setState({stack:this.stack})},n}(o.Component),w=new(function(){function e(){this.local=new h.a,this.user=void 0;var e=f.b.lang,t=f.b.district;this.language=e,this.culture=t}return Object.defineProperty(e.prototype,"guest",{get:function(){var e=this.local.guest;if(void 0===e)return 0;var t=e.get();return void 0===t?0:t.guest},enumerable:!0,configurable:!0}),e.prototype.set=function(e){this.nav=e},e.prototype.registerReceiveHandler=function(e){if(void 0!==this.ws)return this.ws.onWsReceiveAny(e)},e.prototype.unregisterReceiveHandler=function(e){void 0!==this.ws&&void 0!==e&&this.ws.endWsReceive(e)},e.prototype.onReceive=function(e){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return void 0===this.ws?[2]:[4,this.ws.receive(e)];case 1:return t.sent(),[2]}})})},e.prototype.getPredefinedUnitName=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,fetch("unit.json",{})];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().unit];case 3:return e.sent(),this.local.unit.clear(),[2];case 4:return[2]}})})},e.prototype.loadPredefinedUnit=function(){return i.b(this,void 0,void 0,function(){var e,t,n,r;return i.e(this,function(i){switch(i.label){case 0:return void 0!==(e=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UNIT)?[2,Number(e)]:void 0===(n=this.local.unit.get())?[3,2]:!0!==d.j?[2,n.id]:[4,this.getPredefinedUnitName()];case 1:return void 0===(t=i.sent())?[2]:n.name===t?[2,n.id]:[3,4];case 2:return[4,this.getPredefinedUnitName()];case 3:if(void 0===(t=i.sent()))return[2];i.label=4;case 4:return[4,d.h.unitFromName(t)];case 5:return void 0!==(r=i.sent())&&this.local.unit.set({id:r,name:t}),[2,r]}})})},e.prototype.setSettings=function(e){this.navSettings=e},e.prototype.start=function(){return i.b(this,void 0,void 0,function(){var e,t,n,r,o,s,a,u,c,h,f;return i.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,11,12,13]),void 0!==(e=document.location.hash)&&e.length>0&&((t=Object(l.f)())<0&&(t=void 0),this.hashParam=e.substring(1,t)),w.clear(),this.startWait(),[4,d.i.start()];case 1:return i.sent(),n=d.i.url,r=d.i.ws,o=d.i.resHost,this.centerHost=n,this.resUrl="http://"+o+"/res/",this.wsHost=r,Object(d.p)(n),void 0!==(s=this.local.guest.get())?[3,3]:[4,d.h.guest()];case 2:s=i.sent(),i.label=3;case 3:return w.setGuest(s),a=Object(l.e)(),u=Object(l.i)(a),void 0!==a&&window!==window.parent&&void 0!==u?(this.ws=p.d,console.log("this.ws = wsBridge in sub frame"),self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:u.hash},"*"),[2]):[4,this.loadPredefinedUnit()];case 4:return c=i.sent(),u.predefinedUnit=c,void 0!==(h=this.local.user.get())?[3,9]:void 0===(f=this.nav.props.notLogined)?[3,6]:[4,f()];case 5:return i.sent(),[3,8];case 6:return[4,w.showLogin(void 0)];case 7:i.sent(),i.label=8;case 8:return[2];case 9:return[4,w.logined(h)];case 10:return i.sent(),[3,13];case 11:return i.sent(),[3,13];case 12:return this.endWait(),[7];case 13:return[2]}})})},e.prototype.showAppView=function(){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(t){switch(t.label){case 0:return void 0===(e=this.nav.props.onLogined)?(w.push(o.createElement("div",null,"NavView has no prop onLogined")),[2]):(w.clear(),[4,e()]);case 1:return t.sent(),console.log("logined: AppView shown"),[2]}})})},e.prototype.setGuest=function(e){this.local.guest.set(e),u.a.set(0,e.token)},e.prototype.saveLocalUser=function(){this.local.user.set(this.user)},e.prototype.logined=function(e,t){return i.b(this,void 0,void 0,function(){return i.e(this,function(n){switch(n.label){case 0:return Object(d.l)(),(this.ws=new d.e(this.wsHost,e.token)).connect(),console.log("logined: %s",JSON.stringify(e)),this.user=e,this.saveLocalUser(),u.a.set(e.id,e.token),void 0===t?[3,1]:(t(e),[3,3]);case 1:return[4,this.showAppView()];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.loginTop=function(e){return this.navSettings&&this.navSettings.loginTop||e},e.prototype.showLogin=function(e,t){return i.b(this,void 0,void 0,function(){var r,s;return i.e(this,function(i){switch(i.label){case 0:return[4,n.e(1).then(n.bind(null,124))];case 1:return r=i.sent(),s=o.createElement(r.default,{withBack:t,callback:e}),!0!==t&&(this.nav.clear(),this.pop()),this.nav.push(s),[2]}})})},e.prototype.showLogout=function(e){return i.b(this,void 0,void 0,function(){var t=this;return i.e(this,function(n){return w.push(o.createElement(a.a,{header:"\u5b89\u5168\u9000\u51fa",back:"close"},o.createElement("div",{className:"m-5 border border-info bg-white rounded p-3 text-center"},o.createElement("div",null,"\u9000\u51fa\u5f53\u524d\u8d26\u53f7\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5386\u53f2\u6570\u636e\uff0c\u4e0b\u6b21\u767b\u5f55\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u672c\u8d26\u53f7"),o.createElement("div",{className:"mt-3"},o.createElement("button",{className:"btn btn-danger",onClick:function(){return t.logout(e)}},"\u9000\u51fa"))))),[2]})})},e.prototype.logout=function(e){return i.b(this,void 0,void 0,function(){var t;return i.e(this,function(n){switch(n.label){case 0:return d.f.unit=void 0,this.local.logoutClear(),this.user=void 0,Object(d.l)(),t=this.local.guest.get(),Object(d.o)(0,t&&t.token),this.ws=void 0,void 0!==e?[3,2]:[4,w.start()];case 1:return n.sent(),[3,4];case 2:return[4,e()];case 3:n.sent(),n.label=4;case 4:return[2]}})})},e.prototype.changePassword=function(){return i.b(this,void 0,void 0,function(){var e;return i.e(this,function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,123))];case 1:return e=t.sent(),w.push(o.createElement(e.ChangePasswordPage,null)),[2]}})})},Object.defineProperty(e.prototype,"level",{get:function(){return this.nav.level},enumerable:!0,configurable:!0}),e.prototype.startWait=function(){this.nav.startWait()},e.prototype.endWait=function(){this.nav.endWait()},e.prototype.onError=function(e){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return[4,this.nav.onError(e)];case 1:return t.sent(),[2]}})})},e.prototype.show=function(e,t){this.nav.show(e,t)},e.prototype.push=function(e,t){this.nav.push(e,t)},e.prototype.replace=function(e,t){this.nav.replace(e,t)},e.prototype.pop=function(e){void 0===e&&(e=1),this.nav.pop(e)},e.prototype.topKey=function(){return this.nav.topKey()},e.prototype.popTo=function(e){this.nav.popTo(e)},e.prototype.clear=function(){this.nav.clear()},e.prototype.navBack=function(){this.nav.navBack()},e.prototype.ceaseTop=function(e){this.nav.ceaseTop(e)},e.prototype.removeCeased=function(){this.nav.removeCeased()},e.prototype.back=function(e){return void 0===e&&(e=!0),i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return[4,this.nav.back(e)];case 1:return t.sent(),[2]}})})},e.prototype.regConfirmClose=function(e){this.nav.regConfirmClose(e)},e.prototype.confirmBox=function(e){return this.nav.confirmBox(e)},e.prototype.navToApp=function(e,t,n,r,s){return i.b(this,void 0,Promise,function(){var a=this;return i.e(this,function(i){return[2,new Promise(function(i,u){var c=!0===a.centerHost.includes("http://localhost:")?"sheet_debug":"sheet",h=void 0===s?Object(l.c)(e,t):Object(l.c)(e,t,c,[n,r,s]);console.log("navToApp: %s",JSON.stringify(h)),w.push(o.createElement("article",{className:"app-container"},o.createElement("span",{id:h.hash,onClick:function(){return a.back()},style:v},o.createElement("i",{className:"fa fa-arrow-left"})),o.createElement("iframe",{src:h.url})),function(){i()})})]})})},e.prototype.navToSite=function(e){window.open(e)},Object.defineProperty(e.prototype,"logs",{get:function(){return b},enumerable:!0,configurable:!0}),e.prototype.log=function(e){b.push(e)},e.prototype.logMark=function(){var e=new Date;r=e.getTime(),b.push("log-mark: "+e.toTimeString())},e.prototype.logStep=function(e){b.push(e+": "+((new Date).getTime()-r))},i.c([s.l],e.prototype,"user",void 0),e}())}).call(this,n(39))},function(e,t,n){"use strict";n.d(t,"startApp",function(){return a});var r=n(0),i=n(1),o=n(31);n(33);n.o(o,"CApp")&&n.d(t,"CApp",function(){return o.CApp}),n.o(o,"tv")&&n.d(t,"tv",function(){return o.tv});n(47);var s=n(13);function a(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return function e(t){for(var n in t){var r=t[n];if(t[n.toLowerCase()]=r,"object"===typeof r&&!i.isValidElement(r))if(!0===Array.isArray(r))for(var o=0,s=r;o<s.length;o++)e(s[o]);else e(r)}}(e),[4,new(e&&e.CApp||o.CApp)(e).start()];case 1:return t.sent(),[2]}})})}n.d(t,"tv",function(){return s.b})},function(e,t,n){"use strict";var r=n(19),i=n(35),o=n(0),s=n(23),a=n(17),u=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.guest=function(){return o.b(this,void 0,Promise,function(){var e;return o.e(this,function(t){switch(t.label){case 0:return[4,this.get("",{})];case 1:switch(typeof(e=t.sent())){default:return[2];case"string":return[2,Object(s.a)(e)];case"object":return[2,Object(s.a)(e.token)]}return[2]}})})},t.prototype.unitFromName=function(e){return o.b(this,void 0,Promise,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.get(e)];case 1:return[2,(t=n.sent())&&t.unit]}})})},t}(a.a))("tv/guest/",void 0),c=n(15),l=n(22);n(29);n.d(t,"e",function(){return r.a}),n.d(t,"m",function(){return r.b}),n.d(t,"n",function(){return i.b}),n.d(t,"h",function(){return u}),n.d(t,"l",function(){return a.h}),n.d(t,"d",function(){return a.d}),n.d(t,"c",function(){return a.c}),n.d(t,"p",function(){return a.j}),n.d(t,"o",function(){return a.i}),n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return a.b}),n.d(t,"k",function(){return a.g}),n.d(t,"f",function(){return c.a}),n.d(t,"g",function(){return c.e}),n.d(t,"j",function(){return l.b}),n.d(t,"i",function(){return l.a})},function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return c});var r=n(1),i=n(5),o=n(13),s=function(){function e(){}return e.prototype.render=function(e){return void 0===this.view?r.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):r.createElement(this.view,{vm:this,className:e})},e}(),a=function(e,t){return r.createElement(r.Fragment,null,"content: ",Object(o.a)(e))},u=Object(i.a)(a),c=function(e){return r.createElement("div",{className:"px-3 py-2"},Object(o.a)(e))}},function(e,t,n){"use strict";function r(e,t){switch(e.substr(0,1)){default:return t;case"$":case"_":return}}function i(e){return JSON.stringify(e,r," ")}var o=n(1),s=n(5),a=n(31),u=n(3);var c=Object(s.a)(function(e){var t=e.tuidValue,n=e.ui,r=e.x,i=e.nullUI;if(void 0===t)return void 0===i?o.createElement(o.Fragment,null,"[undefined]"):i();if(null===t)return void 0===i?o.createElement(o.Fragment,null,"[null]"):i();var s=typeof t;switch(s){default:if(void 0===n)return o.createElement(o.Fragment,null,s,"-",t);var c=n(t,r);return void 0!==c?c:o.createElement(o.Fragment,null,t);case"object":var l=function(e,t,n){if("number"===typeof e)return o.createElement(o.Fragment,null,e);var r=e,i=r.id,s=r._$tuid,c=r._$com;if(void 0!==i&&null!==i){var l=s;if(void 0===l)return void 0!==t?t(e,n):Object(a.PureJSONContent)(e,n);var h=t||c;void 0===h&&(h=e._$com=l.getTuidContent());var d=l.valueFromId(i);if(void 0===d)return o.createElement(o.Fragment,null,"[",o.createElement(u.FA,{className:"text-danger",name:"bug"})," no ",l.name," on id=",i,"]");switch(typeof d){case"number":d={id:d}}if(void 0!==t){var p=t(d,n);return void 0!==p?p:o.createElement(o.Fragment,null,i)}return o.createElement(h,d)}}(t,n,r);return void 0!==l?l:i();case"number":return o.createElement(o.Fragment,null,"id...",t)}}),l=function(e,t,n,r){return o.createElement(c,{tuidValue:e,ui:t,x:n,nullUI:r})};n.d(t,"a",function(){return i}),n.d(t,"b",function(){return l})},function(e,t,n){"use strict";var r=n(9);n.d(t,"NavView",function(){return r.a}),n.d(t,"nav",function(){return r.c});n(36);var i=n(16);n.d(t,"Page",function(){return i.a});var o=n(61);n.d(t,"Controller",function(){return o.a}),n.d(t,"VPage",function(){return o.b}),n.d(t,"View",function(){return o.c});var s=n(62);n.o(s,"Edit")&&n.d(t,"Edit",function(){return s.Edit}),n.o(s,"Form")&&n.d(t,"Form",function(){return s.Form}),n.o(s,"Image")&&n.d(t,"Image",function(){return s.Image}),n.o(s,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",function(){return s.TabCaptionComponent}),n.o(s,"Tabs")&&n.d(t,"Tabs",function(){return s.Tabs}),n.o(s,"emailRegex")&&n.d(t,"emailRegex",function(){return s.emailRegex}),n.o(s,"mobileRegex")&&n.d(t,"mobileRegex",function(){return s.mobileRegex}),n.o(s,"resLang")&&n.d(t,"resLang",function(){return s.resLang});var a=n(79);n.d(t,"Form",function(){return a.a});var u=n(81);n.d(t,"Edit",function(){return u.a});var c=n(27);n.d(t,"resLang",function(){return c.a});var l=n(85);n.d(t,"TabCaptionComponent",function(){return l.a}),n.d(t,"Tabs",function(){return l.b});n(40);var h=n(21);n.d(t,"Image",function(){return h.a});n(41);var d=n(65);n.d(t,"emailRegex",function(){return d.a}),n.d(t,"mobileRegex",function(){return d.b})},function(e,t,n){"use strict";n.d(t,"h",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"i",function(){return g}),n.d(t,"f",function(){return w}),n.d(t,"e",function(){return E}),n.d(t,"c",function(){return k}),n.d(t,"b",function(){return N}),n.d(t,"d",function(){return S});var r=n(0),i=n(8),o=n.n(i),s=n(14),a=n(25),u=n(17),c=n(19),l=n(22),h={};function d(){for(var e in h)h[e]=void 0}var p={},f=new(function(){function e(){}return Object.defineProperty(e.prototype,"unit",{get:function(){return this._unit},set:function(e){this._unit=e},enumerable:!0,configurable:!0}),e}());function m(){return self!==window.parent}function v(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return console.log("initSubWin: set nav.user",e),t=s.nav.user=e,Object(u.i)(t.id,t.token),[4,s.nav.showAppView()];case 1:return n.sent(),[2]}})})}function b(e,t){return r.b(this,void 0,Promise,function(){var n,i,o;return r.e(this,function(r){switch(r.label){case 0:return void 0===p[e]?[2,{name:t,url:void 0,urlDebug:void 0,token:void 0}]:(n=C(),i=t.split("/"),[4,u.k.uq({unit:n,uqOwner:i[0],uqName:i[1]})]);case 1:return o=r.sent(),[2,{name:t,url:o.url,urlDebug:o.urlDebug,token:o.token}]}})})}function y(e){return r.b(this,void 0,void 0,function(){var t,n,i,o,s,a;return r.e(this,function(r){if(t=e.apiName,n=e.url,i=e.urlDebug,o=e.token,void 0===(s=h[t]))throw"error app api return";return a=l.a.getUrlOrDebug(n,i),console.log("onAppApiReturn(message:any): url="+n+", debug="+i+", real="+a),s.url=a,s.token=o,s.resolve(s),[2]})})}function g(e){if(e){var t=e.split("-"),n=t.length;if(n>0){var r=1;f.hash=t[r++],n>0&&(f.unit=Number(t[r++])),n>1&&(f.page=t[r++]),n>2&&(f.param=t.slice(r++))}}return f}function w(){var e=document.location.hash;if(void 0!==e&&e.length>0){var t=e.lastIndexOf("#tv-");return t<0&&(t=e.lastIndexOf("#tvdebug-")),t}return-1}function E(){var e=w();if(!(e<0))return document.location.hash.substring(e)}function k(e,t,n,r){for(var i;;){if(i=Object(a.a)(),void 0===p[i]){p[i]={hash:i,unit:t};break}}if(e+="#tv-"+i+"-"+t,void 0!==n&&(e+="-"+n,void 0!==r))for(var o=0;o<r.length;o++)e+="-"+r[o];return{url:e,hash:i}}function C(){var e=f.unit,t=f.predefinedUnit,n=e||t;if(void 0===n)throw"no unit defined in unit.json or not logined in";return n}function N(e,t,n){return r.b(this,void 0,Promise,function(){var i,o,s,a,c,d=this;return r.e(this,function(p){switch(p.label){case 0:return void 0!==(i=h[e])?[2,i]:m()?[3,2]:(o=C(),[4,u.k.uq({unit:o,uqOwner:t,uqName:n})]);case 1:return void 0===(i=p.sent()).token&&(i.token=u.f),s=i.url,a=i.urlDebug,c=l.a.getUrlOrDebug(s,a),console.log("realUrl: %s",c),i.url=c,h[e]=i,[2,i];case 2:return console.log("appApi parent send: %s",f.hash),i={name:e,url:void 0,urlDebug:void 0,token:void 0,resolve:void 0,reject:void 0},h[e]=i,[2,new Promise(function(t,n){i.resolve=function(e){return r.b(d,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),console.log("return from parent window: %s",JSON.stringify(n)),i.url=n.url,i.urlDebug=n.urlDebug,i.token=n.token,t(i),[2]}})})},i.reject=n,(window.opener||window.parent).postMessage({type:"app-api",apiName:e,hash:f.hash},"*")})]}})})}window.addEventListener("message",function(e){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:switch(t=e.data,t.type){case"sub-frame-started":return[3,1];case"ws":return[3,2];case"init-sub-win":return[3,4];case"pop-app":return[3,6];case"center-api":return[3,7];case"center-api-return":return[3,9];case"app-api":return[3,10];case"app-api-return":return[3,12]}return[3,14];case 1:return function(e){var t=e.data,n=e.source;Object(c.c)(n),r=t.hash,i=document.getElementById(r),void 0!==i&&(i.hidden=!0);var r,i;var a=o.a.clone(s.nav.user);a.type="init-sub-win",n.postMessage(a,"*")}(e),[3,15];case 2:return[4,s.nav.onReceive(t.msg)];case 3:return r.sent(),[3,15];case 4:return[4,v(t)];case 5:return r.sent(),[3,15];case 6:return s.nav.navBack(),[3,15];case 7:return[4,x(e.source,t)];case 8:return r.sent(),[3,15];case 9:return function(e){var t=e.callId,n=e.result,r=P[t];if(void 0===r)return;P[t]=void 0,r.resolve(n)}(t),[3,15];case 10:return console.log("receive PostMessage: %s",JSON.stringify(t)),[4,b(t.hash,t.apiName)];case 11:return n=r.sent(),console.log("onReceiveAppApiMessage: %s",JSON.stringify(n)),e.source.postMessage({type:"app-api-return",apiName:t.apiName,url:n.url,urlDebug:n.urlDebug,token:n.token},"*"),[3,15];case 12:return console.log("app-api-return: %s",JSON.stringify(t)),console.log("await onAppApiReturn(message);"),[4,y(t)];case 13:return r.sent(),[3,15];case 14:return this.console.log("message: %s",JSON.stringify(t)),[3,15];case 15:return[2]}})})});var P={};function S(e,t,n){return r.b(this,void 0,Promise,function(){var i=this;return r.e(this,function(o){switch(o.label){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",e,t),[4,new Promise(function(o,s){return r.b(i,void 0,void 0,function(){var i;return r.e(this,function(r){for(;;)if(i=Object(a.a)(),void 0===P[i]){P[i]={id:i,resolve:o,reject:s};break}return(window.opener||window.parent).postMessage({type:"center-api",callId:i,url:e,method:t,body:n},"*"),[2]})})})];case 1:return[2,o.sent()]}})})}function x(e,t){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=t.callId,i=t.url,o=t.method,s=t.body,[4,u.e.directCall(i,o,s)];case 1:return a=r.sent(),e.postMessage({type:"center-api-return",callId:n,result:a},"*"),[2]}})})}},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),i=n(1),o=n(5),s=n(6),a=n.n(s),u=n(8),c=n.n(u),l=n(36),h=100,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bottomTime=0,t.topTime=0,t.onScroll=function(e){return r.b(t,void 0,void 0,function(){var t,n,i,o,s,a,u;return r.e(this,function(r){return t=this.props,n=t.onScroll,i=t.onScrollTop,o=t.onScrollBottom,n&&this.props.onScroll(e),(s=e.target).scrollTop<30&&void 0!==i&&(a=(new Date).getTime())-this.topTime>h&&(this.topTime=a,i()),s.scrollTop+s.offsetHeight>s.scrollHeight-30&&void 0!==o&&(u=(new Date).getTime())-this.bottomTime>h&&(this.bottomTime=u,o()),[2]})})},t}return r.d(t,e),t.prototype.eachChild=function(e,t){var n=this,r=e.props;if(void 0!==r){var o=r.children;void 0!==o&&i.Children.forEach(o,function(e,r){var i=e._$scroll;i&&i(t),console.log(e.toString()),n.eachChild(e,t)})}},t.prototype.render=function(){return i.createElement("main",{className:this.props.className,onScroll:this.onScroll},this.props.children)},t}(i.Component),p=function(e){function t(t){var n,r=e.call(this,t)||this,i=t.tabs;if(void 0===i||0===i.length)return r;r.tabs=i;for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s],l=c.a.clone(u);void 0===n&&!0===l.isSelected?n=l:l.isSelected=!1,l.isMounted=!1,o.push(l)}return r.state={cur:n,tabs:o},r}return r.d(t,e),t.prototype.componentDidMount=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return void 0===this.tabs?[2]:void 0===(e=this.state.tabs[0])?[2]:[4,this.onTabClick(e)];case 1:return t.sent(),[2]}})})},t.prototype.onTabClick=function(e){return r.b(this,void 0,void 0,function(){var t,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:if(!0===e.isSelected)return[2];for(n=this.state.tabs,i=0,o=n;i<o.length;i++)(s=o[i])===e?(s.isSelected=!0,t=s):s.isSelected=!1;return!0===t.isMounted?[3,2]:void 0===(a=t.load)?[3,2]:[4,a()];case 1:r.sent(),r.label=2;case 2:return this.setState({cur:t,tabs:n}),[2]}})})},t.prototype.onTouchStart=function(e){},t.prototype.renderTabs=function(e){var t,n=this,r=this.props,o=r.header,s=r.back,u=r.right,c=r.keepHeader,h=this.state.cur,p=i.createElement("div",null,this.state.tabs.map(function(e,t){var r,o,s,u=e.icon,c=e.isSelected,l=e.title,h=e.redDot;if(void 0!==u&&(r=i.createElement("img",{src:u})),void 0!==h){var d=h.get();d<0?(s=a()("red-dot"),o=i.createElement("u",null)):d>0&&(s=a()("red-dot","num"),o=i.createElement("u",null,d))}return i.createElement("div",{key:t,className:a()("va-tab",{cur:c}),onClick:function(){return n.onTabClick(e)}},r,i.createElement("div",{className:s},l,o))}));return!1!==o&&(t=i.createElement(l.a,{back:s,center:!0===c?o:h&&(h.header||h.title),right:u})),i.createElement("article",{className:"page-container"},t,i.createElement("section",{className:"position-relative"},this.props.sideBar,this.state.tabs.map(function(e,t){var n=e.isSelected,r=e.isMounted,o=e.content;if(!0===n||!0===r)return e.isMounted=!0,i.createElement(d,{key:t,className:a()({invisible:!1===n}),onScroll:e.onScroll,onScrollTop:e.onScrollTop,onScrollBottom:e.onScrollBottom},"function"===typeof o?o():o)})),p,e)},t.prototype.renderSingle=function(e){var t,n=this.props,r=n.back,o=n.header,s=n.right,a=n.onScroll,u=n.onScrollTop,c=n.onScrollBottom,h=n.children;return!1!==o&&(t=i.createElement(l.a,{back:r,center:o,right:s,logout:this.props.logout})),i.createElement("article",{className:"page-container",onTouchStart:this.onTouchStart},t,i.createElement("section",{className:"position-relative"},this.props.sideBar,i.createElement(d,{onScroll:a,onScrollTop:u,onScrollBottom:c},h)),e)},t.prototype.render=function(){var e,t=this.props.footer;return void 0!==t&&(e=i.createElement("footer",null,t)),void 0!==this.tabs?this.renderTabs(e):this.renderSingle(e)},t=r.c([o.a],t)}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(29),a=n(9),u=function(){function e(){}return e.prototype.startWait=function(){a.c.startWait()},e.prototype.endWait=function(){a.c.endWait()},e.prototype.showError=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return a.c.endWait(),[4,a.c.onError(e)];case 1:return t.sent(),[2]}})})},e}(),c=n(15),l=n(35),h=n(22),d=n(14);n.d(t,"h",function(){return m}),n.d(t,"d",function(){return b}),n.d(t,"c",function(){return w}),n.d(t,"j",function(){return E}),n.d(t,"f",function(){return N}),n.d(t,"i",function(){return S}),n.d(t,"a",function(){return x}),n.d(t,"k",function(){return F}),n.d(t,"e",function(){return T}),n.d(t,"b",function(){return V}),n.d(t,"g",function(){return I});var p={},f={};function m(){p={},f={},y={},Object(c.h)()}var v=new(function(){function e(){}return e.prototype.loadAccess=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,s,a,u,c,l,h,d,p,f;return r.e(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),t=e.uqOwner,n=e.uqName,void 0===this.local&&null!==(i=localStorage.getItem("uqLocalEntities"))&&(this.local=JSON.parse(i)),void 0!==this.local)if(s=this.local,a=s.user,u=s.uqs,a!==P||void 0===u)this.local=void 0;else for(c in u)u[c].isNet=void 0;return void 0===this.local&&(this.local={user:P,unit:void 0,uqs:{}}),l=void 0,h=t+"/"+n,void 0!==(d=this.local.uqs[h])&&(p=d.value,l=p),void 0!==l?[3,2]:[4,e.__loadAccess()];case 1:l=r.sent(),this.saveLocal(h,l),r.label=2;case 2:return[2,o.a.cloneDeep(l)];case 3:throw f=r.sent(),this.local=void 0,localStorage.removeItem("uqLocalEntities"),f;case 4:return[2]}})})},e.prototype.saveLocal=function(e,t){this.local.uqs[e]={value:t,isNet:!0};var n=JSON.stringify(this.local);localStorage.setItem("uqLocalEntities",n)},e.prototype.checkAccess=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return t=e.uqOwner,n=e.uqName,i=t+"/"+n,void 0===(s=this.local.uqs[i])?[2,!1]:(a=s.isNet,u=s.value,!0===a?[2,!0]:[4,e.__loadAccess()]);case 1:return c=r.sent(),!1===o.a.isMatch(u,c)?(this.saveLocal(i,c),[2,!1]):(s.isNet=!0,[2,!0])}})})},e}()),b=function(e){function t(t,n,r,i,o){var s=e.call(this,t,o)||this;return r&&(s.uqOwner=n,s.uqName=r,s.uq=n+"/"+r),s.access=i,s.showWaiting=o,s}return r.d(t,e),t.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i;return r.e(this,function(r){switch(r.label){case 0:return!0===this.showWaiting||void 0===this.showWaiting?(e=p,t=new u):e=f,void 0!==(n=e[this.uq])?[2,n]:[4,Object(c.b)(this.uq,this.uqOwner,this.uqName)];case 1:return i=r.sent(),this.token=i.token,n=new s.a(!1,i.url,i.token,t),[2,e[this.uq]=n]}})})},t.prototype.update=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("update")];case 1:return[2,e.sent()]}})})},t.prototype.__loadAccess=function(){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return e=void 0===this.access?"":this.access.join("|"),[4,this.get("access",{acc:e})];case 1:return[2,t.sent()]}})})},t.prototype.loadAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,v.loadAccess(this)];case 1:return[2,e.sent()]}})})},t.prototype.loadEntities=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("entities")];case 1:return[2,e.sent()]}})})},t.prototype.checkAccess=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,v.checkAccess(this)];case 1:return[2,e.sent()]}})})},t.prototype.schema=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("schema/"+e)];case 1:return[2,t.sent()]}})})},t.prototype.schemas=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.post("schema",e)];case 1:return[2,t.sent()]}})})},t.prototype.tuidGet=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("tuid/"+e+"/"+t)];case 1:return[2,n.sent()]}})})},t.prototype.tuidGetAll=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("tuid-all/"+e+"/")];case 1:return[2,t.sent()]}})})},t.prototype.tuidSave=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("tuid/"+e,t)];case 1:return[2,n.sent()]}})})},t.prototype.tuidSearch=function(e,t,n,i,o,s){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuids/"+e,{arr:t,owner:n,key:i,pageStart:o,pageSize:s})];case 1:return[2,r.sent()]}})})},t.prototype.tuidArrGet=function(e,t,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr/"+e+"/"+n+"/"+t+"/"+i)];case 1:return[2,r.sent()]}})})},t.prototype.tuidArrGetAll=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("tuid-arr-all/"+e+"/"+n+"/"+t+"/")];case 1:return[2,r.sent()]}})})},t.prototype.tuidArrSave=function(e,t,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr/"+e+"/"+n+"/"+t+"/",i)];case 1:return[2,r.sent()]}})})},t.prototype.tuidArrPos=function(e,t,n,i,o){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("tuid-arr-pos/"+e+"/"+n+"/"+t+"/",{id:i,$order:o})];case 1:return[2,r.sent()]}})})},t.prototype.tuidIds=function(e,t,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuidids/"+e+"/",i+=void 0!==t?t:"$",[4,this.post(i,n)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},t.prototype.proxied=function(e,t,n){return r.b(this,void 0,Promise,function(){var i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),i="tuid-proxy/"+e+"/"+t+"/"+n,[4,this.get(i)];case 1:return[2,r.sent()];case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})},t.prototype.sheetSave=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+e,t)];case 1:return[2,n.sent()]}})})},t.prototype.sheetAction=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.put("sheet/"+e,t)];case 1:return[2,n.sent()]}})})},t.prototype.stateSheets=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+e+"/states",t)];case 1:return[2,n.sent()]}})})},t.prototype.stateSheetCount=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("sheet/"+e+"/statecount")];case 1:return[2,t.sent()]}})})},t.prototype.mySheets=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+e+"/my-sheets",t)];case 1:return[2,n.sent()]}})})},t.prototype.getSheet=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+e+"/get/"+t)];case 1:return[2,n.sent()]}})})},t.prototype.sheetArchives=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("sheet/"+e+"/archives",t)];case 1:return[2,n.sent()]}})})},t.prototype.sheetArchive=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("sheet/"+e+"/archive/"+t)];case 1:return[2,n.sent()]}})})},t.prototype.action=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("action/"+e,t)];case 1:return[2,n.sent()]}})})},t.prototype.page=function(e,t,n,i){return r.b(this,void 0,Promise,function(){var s;return r.e(this,function(r){switch(r.label){case 0:switch(typeof i){case"undefined":s={key:""};break;default:s=o.a.clone(i)}return s.$pageStart=t,s.$pageSize=n,[4,this.post("query-page/"+e,s)];case 1:return[2,r.sent()]}})})},t.prototype.query=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("query/"+e,t)];case 1:return[2,n.sent()]}})})},t.prototype.user=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.get("user")];case 1:return[2,e.sent()]}})})},t}(l.a),y={};var g,w=function(e){function t(t){var n=e.call(this,"tv/",void 0,void 0,void 0,!0)||this;return n.unitId=t,n}return r.d(t,e),t.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){var e,t,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(e=y[this.unitId])?[2,e]:(t=y,n=this.unitId,[4,this.buildChannel()]);case 1:return[2,t[n]=r.sent()]}})})},t.prototype.buildChannel=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i,o,a;return r.e(this,function(r){switch(r.label){case 0:return e=new u,[4,new V("tv/",void 0).unitxUq(this.unitId)];case 1:return t=r.sent(),n=t.token,i=t.url,o=t.urlDebug,a=h.a.getUrlOrDebug(i,o),this.token=n,[2,new s.a(!1,a,n,e)]}})})},t}(b);function E(e){console.log("setCenterUrl %s",e),g=e,N=void 0,C=void 0,k=void 0}var k,C,N=void 0,P=0;function S(e,t){P=e,N=t,console.log("setCenterToken %s",t),C=void 0,k=void 0}var x=function(e){function t(t,n){return e.call(this,t,n)||this}return r.d(t,e),t.prototype.getHttpChannel=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return[2,!0===this.showWaiting||void 0===this.showWaiting?void 0!==k?k:k=new s.a(!0,g,N,new u):void 0!==C?C:C=new s.a(!0,g,N)]})})},t}(l.a),F=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.uq=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,s,a,u,c,l,h,d,p,f,m,v,b,y;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.unit,n=e.uqOwner,i=e.uqName,void 0===this.local&&null!==(s=localStorage.getItem("uqTokens"))&&(this.local=JSON.parse(s)),void 0!==this.local&&(a=this.local,m=a.unit,u=a.user,m===t&&u===P||(this.local=void 0)),void 0===this.local&&(this.local={user:P,unit:e.unit,uqs:{}}),c=n+"/"+i,l=(new Date).getTime(),void 0!==(h=this.local.uqs[c])&&(d=h.tick,void 0!==(p=h.value)&&l-d<864e5)?[2,o.a.clone(p)]:[4,this.get("app-uq",e)];case 1:if(void 0===(f=r.sent()))throw m=e.unit,v=e.uqOwner,b=e.uqName,"center get app-uq(unit="+m+", '"+v+"/"+b+"') - not exists or no unit-service";return this.local.uqs[c]={tick:l,value:f},localStorage.setItem("uqTokens",JSON.stringify(this.local)),[2,o.a.clone(f)];case 2:throw y=r.sent(),this.local=void 0,localStorage.removeItem("uqTokens"),y;case 3:return[2]}})})},t}(x))("tv/tie/",void 0),T=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.directCall=function(e,t,n){return this.call(e,t,n)},t}(x))("",void 0),O="appUqs",V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.uqs=function(e,t){return r.b(this,void 0,Promise,function(){var n,i,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:return null!==(i=localStorage.getItem(O))&&(s=JSON.parse(i),a=s.appOwner,u=s.appName,c=s.value,e===a&&t===u&&(n=c)),void 0!==n?[3,2]:[4,this.uqsPure(e,t)];case 1:n=r.sent(),l={appOwner:e,appName:t,value:n},localStorage.setItem(O,JSON.stringify(l)),r.label=2;case 2:return[2,this.cachedUqs=o.a.cloneDeep(n)]}})})},t.prototype.uqsPure=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.get("tie/app-uqs",{appOwner:e,appName:t})];case 1:return[2,n.sent()]}})})},t.prototype.checkUqs=function(e,t){return r.b(this,void 0,Promise,function(){var n,i,s,a,u,c,l,h;return r.e(this,function(r){switch(r.label){case 0:return[4,this.uqsPure(e,t)];case 1:if(n=r.sent(),i=this.cachedUqs,s=i.id,a=i.uqs,u=n.id,c=n.uqs,s!==u)return[2,!1];if(a.length!==c.length)return[2,!1];for(l=a.length,h=0;h<l;h++)if(!1===o.a.isMatch(a[h],c[h]))return[2,!1];return[2,!0]}})})},t.prototype.unitxUq=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("tie/unitx-uq",{unit:e})];case 1:return[2,t.sent()]}})})},t.prototype.changePassword=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.post("tie/reset-password",e)];case 1:return[2,t.sent()]}})})},t}(x);function I(e,t){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return[4,(n=new V("tv/",void 0)).uqs(e,t)];case 1:return i=r.sent(),n.checkUqs(e,t).then(function(e){!1===e&&(localStorage.removeItem(O),d.nav.start())}),[2,i]}})})}},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=function(e){function t(t){var n=e.call(this)||this;return n.onClick=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.controller.start()];case 1:return e.sent(),[2]}})})},n.controller=t,n.icon=t.icon,n.label=t.label,n}return r.d(t,e),t.prototype.render=function(e){return i.createElement("div",{className:s()("px-3","py-2","align-items-center","cursor-pointer",e),onClick:this.onClick},this.icon," \xa0 ",this.label)},t}(function(){return function(){}}());n.d(t,"a",function(){return a})},function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return l});var r,i=n(0);function o(e){r=e}function s(e){window.top.postMessage({type:"ws",msg:e},"*")}var a=function(){function e(){this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return e.prototype.onWsReceiveAny=function(e){var t=this.handlerSeed++;return this.anyHandlers[t]=e,t},e.prototype.onWsReceive=function(e,t){var n=this.handlerSeed++;return this.msgHandlers[n]={type:e,handler:t},n},e.prototype.endWsReceive=function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]},e.prototype.receive=function(e){return i.b(this,void 0,void 0,function(){var t,n,r,o,s,a,u,c,l,h,d;return i.e(this,function(i){switch(i.label){case 0:for(r in t=e.$type,n=[],this.anyHandlers)n.push(r);o=0,i.label=1;case 1:return o<n.length?(c=n[o],[4,this.anyHandlers[c](e)]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:for(a in s=[],this.msgHandlers)s.push(a);u=0,i.label=5;case 5:return u<s.length?(c=s[u],l=this.msgHandlers[c],h=l.type,d=l.handler,h!==t?[3,7]:[4,d(e)]):[3,8];case 6:i.sent(),i.label=7;case 7:return u++,[3,5];case 8:return[2]}})})},e}(),u=1,c=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wsBaseId="WsBridge seed "+u++,t}return i.d(t,e),t}(a)),l=function(e){function t(t,n){var r=e.call(this)||this;return r.wsBaseId="WSChannel seed "+u++,r.wsHost=t,r.token=n,r}return i.d(t,e),t.setCenterToken=function(e){t.centerToken=e},t.prototype.connect=function(){var e=this;if(void 0===this.ws){var n=this;return new Promise(function(r,o){var s=new WebSocket(e.wsHost,e.token||t.centerToken);console.log("connect webSocket %s",e.wsHost),s.onopen=function(t){console.log("webSocket connected %s",e.wsHost),n.ws=s,r()},s.onerror=function(e){o("webSocket can't open!")},s.onmessage=function(t){return i.b(e,void 0,void 0,function(){return i.e(this,function(e){switch(e.label){case 0:return[4,n.wsMessage(t)];case 1:return[2,e.sent()]}})})},s.onclose=function(e){n.ws=void 0,console.log("webSocket closed!")}})}},t.prototype.close=function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)},t.prototype.wsMessage=function(e){return i.b(this,void 0,Promise,function(){var t,n;return i.e(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),console.log("websocket message: %s",e.data),function(e){void 0!==r&&r.postMessage({type:"ws",msg:e},"*")}(t=JSON.parse(e.data)),[4,this.receive(t)];case 1:return i.sent(),[3,3];case 2:return n=i.sent(),console.log("ws msg error: ",n),[3,3];case 3:return[2]}})})},t.prototype.sendWs=function(e){var t=this;this.connect().then(function(){t.ws.send(e)})},t}(a)},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function o(){for(var e=r.length,t="",n=0;n<i;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),i=n(6),o=n.n(i),s=n(9);function a(e){var t=e.className,n=e.style,i=e.src,a=e.altImage;return i?(!0===i.startsWith(":")&&(i=s.c.resUrl+i.substr(1)),r.createElement("img",{src:i,className:t,style:n,onError:function(e){return e.currentTarget.src=a}})):r.createElement("div",{className:o()(t,"image-none"),style:n},r.createElement("i",{className:"fa fa-file-o"}))}},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u});var r=n(0),i=!1,o=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_RES_HOST||"101.200.46.56",s={centerhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_CENTER_DEBUG_HOST||"localhost:3000",local:!1},reshost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_RES_DEBUG_HOST||"localhost:3015",local:!1},uqhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},unitxhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_HOST||"localhost:3015",local:!1},"uq-build":{value:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56"}).REACT_APP_UQ_DEBUG_BUILDER_HOST||"localhost:3009",local:!1}};var a={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},u=new(function(){function e(){}return e.prototype.start=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return!0!==i?[3,2]:[4,this.tryLocal()];case 1:t.sent(),t.label=2;case 2:return e=this.getCenterHost(),this.url=function(e){return"http://"+e+"/"}(e),this.ws=function(e){return"ws://"+e+"/tv/"}(e),this.resHost=this.getResHost(),[2]}})})},e.prototype.debugHostUrl=function(e){return"http://"+e+"/hello"},e.prototype.tryLocal=function(){return r.b(this,void 0,void 0,function(){var e,t,n,i,o,a,u,c,l,d,p,f,m,v;return r.e(this,function(r){switch(r.label){case 0:for(d in e=[],t=[],n=function(e){var n=s[e].value;t.findIndex(function(e){return e===n})<0&&t.push(n)},s)n(d);for(i=0,o=t;i<o.length;i++)a=o[i],u=this.debugHostUrl(a),e.push(h(u));return[4,Promise.all(e)];case 1:for(c=r.sent(),l=t.length,d=0;d<l;d++)for(m in p=c[d],f=t[d],s)(v=s[m]).value===f&&(v.local=p);return[2]}})})},e.prototype.getCenterHost=function(){var e=s.centerhost,t=e.value,n=e.local;return!0===document.location.hash.includes("sheet_debug")?t:!0===i&&!0===n?t:"101.200.46.56"},e.prototype.getResHost=function(){var e=s.reshost,t=e.value,n=e.local;return!0===document.location.hash.includes("sheet_debug")?t:!0===i&&!0===n?t:o},e.prototype.getUrlOrDebug=function(e,t){if(!0!==i)return e;if(!t)return e;for(var n in s){var r=s[n],o=r.value,a=r.local,u="://"+n+"/";if(t.indexOf(u)>0)return!1===a?e:t=t.replace(u,"://"+o+"/")}return e},e.prototype.localCheck=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,h(e)];case 1:return[2,t.sent()]}})})},e}()),c=200;function l(e){return new Promise(function(t,n){fetch(e,a).then(function(e){e.text().then(t).catch(n)}).catch(n);var r=new Error("Connection timed out");setTimeout(n,c,r)})}function h(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,l(e)];case 1:return t.sent(),[2,!0];case 2:return t.sent(),[2,!1];case 3:return[2]}})})}},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});var r=n(54),i=n.n(r);function o(e){var t=i()(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function s(e){return{id:0,guest:i()(e).guest,token:e}}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=n(9),o=n(4),s=function(){function e(e,t,n,r){this.isChanged=!1,this.itemSchema=e,this.uiItem=t,this.value=r;var i=e.name;this.name=i,this.label=n}return e.prototype.start=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.internalStart()];case 1:return[2,e.sent()]}})})},e.prototype.end=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.internalEnd()];case 1:return e.sent(),[2]}})})},e.prototype.internalEnd=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return i.c.pop(),[2]})})},e.prototype.verifyValue=function(){if(void 0!==this.uiItem){var e=this.uiItem.rules;if(void 0!==e){var t=this.newValue;if(Array.isArray(e))for(var n=0,r=e;n<r.length;n++){var i=o(r[n]);if(void 0!==i){this.error=i;break}}else this.error=o(e)}}function o(e,n){var r=e(t);if(void 0!==r)return"object"!==typeof r?r:JSON.stringify(r)}},r.c([o.l],e.prototype,"error",void 0),r.c([o.l],e.prototype,"isChanged",void 0),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=8;function o(){for(var e=r.length,t="",n=0;n<i;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(7),a=n(1),u=n.n(a),c=n(3),l=n(2),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onNew=function(){return t.event("new")},t.onList=function(){return t.event("list")},t.onSearch=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){return[2,this.event("list",e)]})})},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t.prototype.entityRender=function(e,t){return e.render()},t.prototype.entityClick=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,e.onClick()];case 1:return t.sent(),[2]}})})},Object.defineProperty(t.prototype,"view",{get:function(){var e,t,n=this.controller,r=n.label,i=n.proxyLinks;if(!1===n.isFrom&&(e=a.createElement("button",{className:"btn btn-outline-success ml-2",onClick:this.onNew},"\u65b0\u589e")),void 0===i){var o=a.createElement(a.Fragment,null,e,a.createElement("button",{className:"btn btn-outline-info ml-2",onClick:this.onList},"\u5168\u90e8"));t=a.createElement(c.LMR,{className:"m-3",right:o},a.createElement(c.SearchBox,{className:"w-100",size:"md",onSearch:this.onSearch,placeholder:"\u641c\u7d22"+r}))}else t=a.createElement(c.List,{className:"my-2",header:a.createElement(c.Muted,null,r," \u4ee3\u7406\u4e0b\u5217Tuid"),items:i,item:{render:this.entityRender,onClick:this.entityClick}});return function(){return a.createElement(l.Page,{header:r},t)}},enumerable:!0,configurable:!0}),t}(s.b),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.next=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return this.vForm.reset(),this.closePage(),[2]})})},t.finish=function(){t.closePage(2),t.event("edit-end")},t.onSubmit=function(){return r.b(t,void 0,void 0,function(){var e,t,n,i,o,s,u;return r.e(this,function(r){switch(r.label){case 0:return e=this.vForm.getValues(),[4,this.controller.entity.save(this.id,e)];case 1:if(t=r.sent(),(n=t.id)<0){if(void 0!==(i=this.controller.entity.unique))for(o=0,s=i;o<s.length;o++)u=s[o],this.vForm.setError(u,"\u4e0d\u80fd\u91cd\u590d");return[2]}return this.controller.isCalling?(this.returnCall(n),this.closePage(),[2]):(this.openPageElement(a.createElement(l.Page,{header:this.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.FA,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement("button",{className:"btn btn-primary mr-3",onClick:this.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement("button",{className:"btn btn-outline-primary",onClick:this.finish},"\u4e0d\u7ee7\u7eed"))))),this.event("item-changed",{id:this.id,values:e}),[2])}})})},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.vForm=this.createForm(this.onSubmit,e),void 0!==e&&(this.id=e.id),this.openPage(this.editView),[2]})})},Object.defineProperty(t.prototype,"editView",{get:function(){var e=this;return function(){return a.createElement(l.Page,{header:(void 0===e.id?"\u65b0\u589e":"\u7f16\u8f91")+" - "+e.label},e.vForm.render("py-3"))}},enumerable:!0,configurable:!0}),t.prototype.resetForm=function(){this.vForm.reset()},t}(s.b),p=n(12),f=n(5),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainView=Object(f.a)(function(){var e=u.a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:t.onSearchMain,placeholder:"\u641c\u7d22"+t.label});return u.a.createElement(l.Page,{header:e,back:"close"},u.a.createElement(c.List,{items:t.controller.PageItems.items,item:{render:t.renderMainRow,onClick:t.clickMainRow},before:"\u641c\u7d22"+t.label+"\u8d44\u6599"}))}),t.onSearchMain=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.searchMain(e)];case 1:return t.sent(),[2]}})})},t.renderMainRow=function(e,n){return u.a.createElement(t.mainRowContent,r.a({},e))},t.clickMainRow=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.ceasePage(),void 0===this.controller.entity.owner?(this.returnCall(e),[2]):[4,this.showDiv(this.entity.getIdFromObj(e))];case 1:return t.sent(),[2]}})})},t.divView=function(e){return u.a.createElement(l.Page,{header:"\u9009\u62e9Div"},u.a.createElement(c.List,{items:e.items,item:{render:t.renderDivRow,onClick:t.clickDivRow}}))},t.renderDivRow=function(e,n){return u.a.createElement(t.divRowContent,r.a({},e))},t.clickDivRow=function(e){t.ceasePage(),t.returnCall(e)},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0!==e?[3,2]:[4,this.showMain(e)];case 1:return t.sent(),[3,4];case 2:return[4,this.showDiv(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},t.prototype.showMain=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.mainRowContent=this.ui.rowContent||p.c,[4,this.controller.searchMain(e)];case 1:return t.sent(),this.openPage(this.mainView),[2]}})})},t.prototype.showDiv=function(e){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return void 0!==(t=this.ui.divs)&&(this.divRowContent=t[this.entity.name].rowContent),void 0===this.divRowContent&&(this.divRowContent=p.c),[4,this.controller.getDivItems(e)];case 1:return n=r.sent(),this.openPage(this.divView,{items:n}),[2]}})})},t}(s.b),v=n(13),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.next=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return this.vForm.reset(),this.closePage(),[2]})})},t.finish=function(){t.closePage(2)},t.onSubmit=function(){return r.b(t,void 0,void 0,function(){var e,t,n=this;return r.e(this,function(r){switch(r.label){case 0:return e=this.vForm.getValues(),[4,this.entity.save(this.id,e)];case 1:return(t=r.sent())&&alert("\u8fd9\u91cc\u8fd8\u8981\u5224\u65ad\u8fd4\u56de\u503c\uff0c\u5148\u4e0d\u5904\u7406\u4e86 \n"+Object(v.a)(t)),this.openPage(function(){return a.createElement(l.Page,{header:n.label+"\u63d0\u4ea4\u6210\u529f",back:"none"},a.createElement("div",{className:"m-3"},a.createElement("span",{className:"text-success"},a.createElement(c.FA,{name:"check-circle",size:"lg"})," \u6210\u529f\u63d0\u4ea4\uff01"),a.createElement("div",{className:"mt-5"},a.createElement("button",{className:"btn btn-primary mr-3",onClick:n.next},"\u7ee7\u7eed\u5f55\u5165"),a.createElement("button",{className:"btn btn-outline-primary",onClick:n.finish},"\u4e0d\u7ee7\u7eed"))))}),[2]}})})},t.view=function(){return a.createElement(l.Page,{header:t.label},t.vForm.render("py-3"))},t}return r.d(t,e),t.prototype.buildForm=function(e){this.vForm=this.createForm(void 0,e)},t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.buildForm(e),this.openPage(this.view),[2]})})},t.prototype.render=function(e){return this.buildForm(e),this.vForm.render()},t.prototype.loadId=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.id=e,[2]})})},t.prototype.resetForm=function(){this.vForm.reset()},t}(s.b)),y=function(e){function t(t){var n=e.call(this,!0)||this;return n.tuid=t,n}return r.d(t,e),t.prototype.load=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tuid.search(e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.setPageStart=function(e){this.pageStart=void 0===e?0:e.id},t}(l.PageItems),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.onSelected=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return!1===this.controller.isFrom?this.event("edit",e.id):this.event("info",e.id),[2]})})},t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.searchMain(e)];case 1:return t.sent(),[2]}})})},t.renderRow=function(e,n){return a.createElement(t.rowContent,r.a({},e))},t.clickRow=function(e){t.callOnSelected(e)},t.rowKey=function(e){return e.id},t.view=Object(f.a)(function(){var e,n=a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:t.onSearch,placeholder:"\u641c\u7d22"+t.label}),r=t.entity.owner;if(void 0!==r){var i=r.valueFromId(t.ownerId);e=a.createElement("div",null,"owner: ",Object(v.a)(i))}return a.createElement(l.Page,{header:n},e,a.createElement(c.List,{items:t.controller.PageItems.items,item:{render:t.renderRow,onClick:t.clickRow,key:t.rowKey},before:"\u641c\u7d22"+t.label+"\u8d44\u6599"}))}),t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.rowContent=this.ui.rowContent||p.c,void 0!==this.entity.owner&&(this.ownerId=Number(e)),[4,this.controller.searchMain("")];case 1:return t.sent(),this.openPage(this.view),[2]}})})},t.prototype.callOnSelected=function(e){void 0!==this.onSelected?this.onSelected(e):alert("onSelect is undefined")},t}(s.b)),w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.onSelected=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.event("edit",e.id),[2]})})}}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.searchMain(e)];case 1:return t.sent(),[2]}})})},t.renderRow=function(e,t){return a.createElement("div",{className:"px-3 py-2"},Object(v.a)(e))},t.clickRow=function(e){t.callOnSelected(e)},t.view=Object(f.a)(function(){var e,n=a.createElement(c.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:t.onSearch,placeholder:"\u641c\u7d22"+t.label}),r=t.entity.owner;if(void 0!==r){var i=r.valueFromId(t.ownerId);e=a.createElement("div",null,"owner: ",Object(v.a)(i))}return a.createElement(l.Page,{header:n},e,a.createElement(c.List,{items:t.controller.PageItems.items,item:{render:t.renderRow,onClick:t.clickRow},before:"\u641c\u7d22"+t.label+"\u8d44\u6599"}))}),t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0!==this.entity.owner&&(this.ownerId=Number(e)),[4,this.controller.searchMain("")];case 1:return t.sent(),this.openPage(this.view),[2]}})})},t.prototype.callOnSelected=function(e){void 0!==this.onSelected?this.onSelected(e):alert("onSelect is undefined")},t}(s.b)),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.buildPageItems=function(){return new y(this.entity.owner||this.entity)},t.prototype.searchMain=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0===e?[3,2]:[4,this.PageItems.first(e)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.getDivItems=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.searchArr(e,void 0,0,1e3)];case 1:return[2,t.sent()]}})})},t}(s.a)),E=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;if(void 0!==o.proxies)for(var s in o.proxyLinks=[],o.proxies){var a=o.cUq.linkFromName("tuid",s);o.proxyLinks.push(a)}return o}return r.d(t,e),t.prototype.from=function(){var e=this.entity.cFrom();return void 0===e?this:e},t.prototype.cUqFrom=function(){return this.entity.cUqFrom()},t.prototype.cEditFrom=function(){return this.entity.cUqFrom().cTuidEditFromName(this.entity.name)},t.prototype.cInfoFrom=function(){return this.entity.cUqFrom().cTuidInfoFromName(this.entity.name)},t.prototype.cSelectFrom=function(){return this.entity.cUqFrom().cTuidSelectFromName(this.entity.name)},t.prototype.getLable=function(e){if(e===this.entity)return this.label;var t=e.name,n=this.res.arrs;if(void 0!==n){var r=n[t];if(void 0!==r){var i=r.label;if(void 0!==i)return i}}return t},Object.defineProperty(t.prototype,"VTuidMain",{get:function(){return h},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VTuidEdit",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VTuidList",{get:function(){return g},enumerable:!0,configurable:!0}),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidMain)];case 1:return e.sent(),[2]}})})},t.prototype.onEvent=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:switch(e){case"new":return[3,2];case"list":return[3,4];case"edit":return[3,6];case"item-changed":return[3,8];case"info":return[3,9]}return[3,1];case 1:return[2];case 2:return[4,this.onNew()];case 3:return n.sent(),[3,11];case 4:return[4,this.onList()];case 5:return n.sent(),[3,11];case 6:return[4,this.onEdit(t)];case 7:return n.sent(),[2];case 8:return this.itemChanged(t),[2];case 9:return[4,new S(this.cUq,this.entity,this.ui,this.res).start(t)];case 10:return n.sent(),[2];case 11:return[2]}})})},t.prototype.edit=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return void 0!==(t=this.ui&&this.ui.CTuidEdit)?[3,2]:[4,this.openVPage(this.VTuidEdit,e)];case 1:return n.sent(),[3,4];case 2:return[4,new t(this.cUq,this.entity,this.ui,this.res).start(e)];case 3:n.sent(),n.label=4;case 4:return[2]}})})},t.prototype.onNew=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.edit(void 0)];case 1:return e.sent(),[2]}})})},t.prototype.onList=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return void 0!==(e=this.ui&&this.ui.CTuidList)?[3,2]:[4,this.openVPage(this.VTuidList,void 0)];case 1:return t.sent(),[3,4];case 2:return[4,new e(this.cUq,this.entity,this.ui,this.res).start(void 0)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},t.prototype.onEdit=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return t=void 0,void 0===e?[3,2]:[4,this.entity.load(e)];case 1:t=n.sent(),n.label=2;case 2:return this.edit(t),[2]}})})},t.prototype.itemChanged=function(e){var t=e.id,n=e.values;if(void 0!==this.PageItems){var r=this.PageItems.items.find(function(e){return e.id===t});void 0!==r&&o.a.merge(r,n)}},t}(w),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidMain)];case 1:return e.sent(),[2]}})})},t}(E),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,"number"!==typeof e?[3,2]:[4,this.onEdit(e)];case 1:return t.sent(),[3,4];case 2:return[4,this.edit(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},t.prototype.edit=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VTuidEdit,e)];case 1:return t.sent(),[2]}})})},t}(E),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return this.isFrom=void 0!==this.entity.schemaFrom,[4,this.openVPage(this.VTuidList)];case 1:return e.sent(),[2]}})})},t}(E),P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return alert("tuid div: "+this.entity.name),[2]})})}}(w),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VTuidSelect,e)];case 1:return t.sent(),[2]}})})},t.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entity.loadSchema()];case 1:return e.sent(),void 0!==this.PageItems&&this.PageItems.reset(),[2,!0]}})})},Object.defineProperty(t.prototype,"VTuidSelect",{get:function(){return m},enumerable:!0,configurable:!0}),t.prototype.idFromItem=function(e){return e.id},t}(w)),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.entity.load(e)];case 1:return t=n.sent(),[4,this.openVPage(this.VTuidInfo,t)];case 2:return n.sent(),[2]}})})},Object.defineProperty(t.prototype,"VTuidInfo",{get:function(){return b},enumerable:!0,configurable:!0}),t}(w);n.d(t,"d",function(){return k}),n.d(t,"a",function(){return C}),n.d(t,"c",function(){return N}),n.d(t,"e",function(){return P}),n.d(t,"b",function(){return S})},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});var r=n(8),i=n.n(r),o={lang:void 0,district:void 0};function s(e){var t=o.lang,n=o.district,r={};if(void 0===e)return r;i.a.merge(r,e._);var s=e[t];if(void 0===s)return r;i.a.merge(r,s._);var a=s[n];if(void 0===a)return r;i.a.merge(r,a);var u=r.entity;if(void 0!==u)for(var c in u)u[c.toLowerCase()]=u[c];return r}!function(){var e,t,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");e=r[0],r.length>1&&(t=r[1])}else e="zh",t="CN";!function(e,t){o.lang=e,o.district=t}(e,t)}()},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n.n(i),s=n(5),a=function(){function e(e){this.view=function(){return i.createElement("div",null)},this.label=e}return e.prototype.render=function(){return i.createElement("div",{key:this.key,className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.label),i.createElement("div",{className:"col-sm-10"},this.renderContent())))},e.prototype.setAddRow=function(e){},Object.defineProperty(e.prototype,"key",{get:function(){return this.label},enumerable:!0,configurable:!0}),e.prototype.getVFields=function(){},e.prototype.getVArr=function(){},e.prototype.getVSubmit=function(){},e.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"content")},e}(),u=function(e){function t(t,n){var r=e.call(this,t)||this;return r.vField=n,r}return r.d(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.vField.name},enumerable:!0,configurable:!0}),t.prototype.getVFields=function(){return[this.vField]},t.prototype.renderContent=function(){return this.vField.render()},t}(a),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.vArr=n,r}return r.d(t,e),t.prototype.setAddRow=function(e){this.vArr.setAddRow(e)},Object.defineProperty(t.prototype,"key",{get:function(){return this.vArr.name},enumerable:!0,configurable:!0}),t.prototype.getVArr=function(){return this.vArr},t.prototype.render=function(){return i.createElement(i.Fragment,{key:this.key},this.vArr&&this.vArr.render())},t}(a),l=(function(e){function t(t,n){var r=e.call(this,t)||this;return r.vFields=n,r}r.d(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.vFields[0].name},enumerable:!0,configurable:!0}),t.prototype.getVFields=function(){return this.vFields},t.prototype.renderContent=function(){return i.createElement("div",{className:"form-control form-control-plaintext bg-white border border-info rounded "},"fields")}}(a),function(e){function t(t){var n=e.call(this,void 0)||this;return n.vSubmit=t,n}return r.d(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return"$submit"},enumerable:!0,configurable:!0}),t.prototype.getVSubmit=function(){return this.vSubmit},t.prototype.render=function(){return i.createElement("div",{key:"$submit",className:"px-3"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"offset-sm-2 col-sm-10"},this.vSubmit.render())))},t}(a)),h=n(12),d=n(4),p=function(e){function t(t){var n=e.call(this)||this;return n.onClickSubmit=function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(e){return this.vForm.submit(),[2]})})},n.view=Object(s.a)(function(){var e=n.vForm.isOk;return i.createElement("button",{type:"button",onClick:n.onClickSubmit,className:n.className,disabled:!1===e},n.caption)}),n.vForm=t,n.caption=n.vForm.submitCaption,n.className="btn btn-primary w-25",n}return r.d(t,e),r.c([d.l],t.prototype,"caption",void 0),r.c([d.l],t.prototype,"className",void 0),t}(h.d),f=n(6),m=n.n(f),v=n(3),b=function(){return function(){}}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.check=function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push("\u4e0d\u80fd\u4e3a\u7a7a")},t}(b),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.check=function(e,t){void 0!==t&&null!==t&&(NaN===Number(t)&&e.push("\u5fc5\u987b\u662f\u6570\u5b57"))},t}(b),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.check=function(e,t){if(void 0!==t&&null!==t){var n=Number(t);!0!==Number.isNaN(n)&&!1!==Number.isInteger(n)||e.push("\u5fc5\u987b\u662f\u6574\u6570")}},t}(b),E=function(e){function t(t){var n=e.call(this)||this;return n.min=t,n}return r.d(t,e),t.prototype.check=function(t,n){e.prototype.check.call(this,t,n),Number(n)<this.min&&t.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.min)},t}(g),k=function(e){function t(t){var n=e.call(this)||this;return n.max=t,n}return r.d(t,e),t.prototype.check=function(t,n){e.prototype.check.call(this,t,n),Number(n)>this.max&&t.push("\u4e0d\u80fd\u5c0f\u4e8e"+this.max)},t}(g),C=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.form=t,o.field=n,o.name=n.name,o.fieldUI=r||{},o.fieldRes=i||{},o.init(),o}return r.d(t,e),t.prototype.init=function(){this.buildRules()},t.prototype.buildRules=function(){this.rules=[],(!0===this.fieldUI.required||void 0!==this.field&&!1===this.field.null)&&this.rules.push(new y)},Object.defineProperty(t.prototype,"checkRules",{get:function(){for(var e=[],t=0,n=this.rules;t<n.length;t++){n[t].check(e,this.value)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOk",{get:function(){return 0===this.rules.length||0===this.checkRules.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.form.values[this.name]},enumerable:!0,configurable:!0}),t.prototype.setValue=function(e){this.form.values[this.name]=e},Object.defineProperty(t.prototype,"error",{get:function(){return this.form.errors[this.name]},set:function(e){this.form.errors[this.name]=e},enumerable:!0,configurable:!0}),t.prototype.parse=function(e){return e},Object.defineProperty(t.prototype,"readonly",{get:function(){var e=this.form.mode;return e===q.readonly||e===q.edit&&!1===this.fieldUI.editable},enumerable:!0,configurable:!0}),r.c([d.e],t.prototype,"checkRules",null),r.c([d.e],t.prototype,"isOk",null),r.c([d.e],t.prototype,"value",null),t}(h.d),N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){return i.createElement("input",{type:"text",className:"form-control form-control-plaintext border border-info rounded bg-light",placeholder:"unkown control: -"})},t}r.d(t,e)}(C),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderError=function(e){var n=t.form.errors[t.name];if(void 0!==n)return i.createElement("div",{className:e},i.createElement(v.FA,{name:"exclamation-circle"})," ",n)},t.ref=function(e){t.input=e,t.setInputValue()},t.onFocus=function(){t.error=void 0},t.onBlur=function(){var e=t.checkRules;e.length>0&&(t.error=e[0]),t.form.computeFields()},t.onChange=function(e){var n=t.parse(e.currentTarget.value);null!==n&&t.setValue(n)},t.view=Object(s.a)(function(){var e,n,r,o=t.fieldUI.required,s=t.fieldRes,a=s.placeHolder,u=s.suffix,c=["form-control","form-control-input"];return!0===t.readonly?n=i.createElement("input",{className:m()(c,"bg-light"),ref:t.ref,type:t.inputType,readOnly:!0}):(n=i.createElement("input",{className:m()(c),ref:t.ref,type:t.inputType,onFocus:t.onFocus,onBlur:t.onBlur,onChange:t.onChange,placeholder:a,readOnly:!1,maxLength:t.maxLength,onKeyPress:t.onKeyPress}),!0!==o&&!1!==t.field.null||(e=i.createElement(P,null))),r=void 0===u?n:i.createElement("div",{className:"input-group"},n,i.createElement("div",{className:"input-group-append"},i.createElement("span",{className:"input-group-text"},u))),i.createElement(i.Fragment,null,e,r,t.renderError("text-danger small mt-1 mx-2"))}),t}return r.d(t,e),Object.defineProperty(t.prototype,"maxLength",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.setValue=function(t){e.prototype.setValue.call(this,t),this.setInputValue()},t.prototype.setInputValue=function(){if(this.input){var e=this.value;this.input.value=null===e||void 0===e?"":e}},t}(C)),P=function(){return i.createElement("b",{style:{color:"red",position:"absolute",left:"0.1em",top:"0.5em"}},"*")},S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="text",t}return r.d(t,e),Object.defineProperty(t.prototype,"maxLength",{get:function(){return this.field.size},enumerable:!0,configurable:!0}),t}(N),x=45,F=46,T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="number",t.onKeyPress=function(e){var n=e.charCode;if(!(8===n||0===n||13===n||n>=48&&n<=57))if(void 0!==t.extraChars&&t.extraChars.indexOf(n)>=0)switch(n){case F:t.onKeyDot();break;case x:t.onKeyNeg(),e.preventDefault()}else e.preventDefault()},t}return r.d(t,e),t.prototype.init=function(){if(e.prototype.init.call(this),this.extraChars=[],void 0!==this.fieldUI){var t=this.fieldUI,n=t.min;t.max;void 0!==n?n<0&&this.extraChars.push(x):this.extraChars.push(x)}switch(this.field.type){case"dec":case"bigint":case"int":case"smallint":case"tinyint":this.extraChars.push(F)}},t.prototype.buildRules=function(){e.prototype.buildRules.call(this),this.rules.push(new g);var t=this.fieldUI,n=t.min,r=t.max;void 0!==n&&this.rules.push(new E(n)),void 0!==r&&this.rules.push(new k(r))},t.prototype.parse=function(e){try{if(0===e.trim().length)return;var t=Number(e);return NaN===t?null:t}catch(n){return null}},t.prototype.setInputValue=function(){if(this.input){var e=this.value;this.parse(this.input.value)!=e&&(this.input.value=null===e||void 0===e?"":e)}},t.prototype.onKeyDot=function(){var e=this.input.value;e.indexOf(".")>=0&&(this.input.value=e.replace(".",""))},t.prototype.onKeyNeg=function(){var e=this.input.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.input.value=e},t}(N),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.buildRules=function(){e.prototype.buildRules.call(this),this.rules.push(new w)},t}(T),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(T),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(S),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(S),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(S);var q,R=function(e){function t(t,n,r){var i=e.call(this,t,n,void 0,r)||this;return i.view=Object(s.a)(function(){var e=i.form.values[i.field.name],t=i.fieldRes,n=t.placeHolder,r=t.suffix;null===e&&(e="");var s=o.a.createElement("input",{className:"form-control form-control-input bg-light",type:"text",placeholder:n,readOnly:!0,value:e});return void 0===r?s:o.a.createElement("div",{className:"input-group"},s,o.a.createElement("div",{className:"input-group-append"},o.a.createElement("span",{className:"input-group-text"},r)))}),i}return r.d(t,e),t}(C),L=n(8),D=n.n(L),U=n(2),B=function(e){function t(t,n,o){var s=e.call(this)||this;s.rowPage=function(){return i.createElement(U.Page,{header:s.label,back:"close"},s.vForm.render("py-3"))},s.onSubmit=function(){return r.b(s,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return e=this.vForm.valueBoxs,[4,this.onRowChanged(e)];case 1:return t.sent(),[2]}})})},s.onRowChanged=function(e){return r.b(s,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0!==this.rowValues?[3,4]:(e.$owner=this.ownerForm.values,this.list.push(e),void 0!==this.onEditRow?[3,1]:(this.vForm.reset(),[3,3]));case 1:return[4,this.onEditRow(void 0,this.onRowChanged)];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:D.a.merge(this.rowValues,e),void 0===this.onEditRow&&U.nav.pop(),t.label=5;case 5:return[2]}})})},s.renderItem=function(e,t){return void 0===s.rowContent?i.createElement("div",{className:"px-3 py-2"},i.createElement(h.a,r.a({},e))):i.createElement(s.rowContent,r.a({},e))},s.showRow=function(e){return r.b(s,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0===this.onEditRow?[3,2]:[4,this.onEditRow(e,this.onRowChanged)];case 1:return t.sent(),[2];case 2:return this.vForm.reset(),void 0!==e&&this.vForm.setValues(e),U.nav.push(i.createElement(this.rowPage,null)),[2]}})})},s.editRow=function(e){return r.b(s,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return this.rowValues=e,void 0!==(t=this.vForm.vSubmit)&&(t.caption=this.editSubmitCaption,t.className="btn btn-outline-success"),this.vForm.mode=this.ownerForm.mode,[4,this.showRow(e)];case 1:return n.sent(),[2]}})})},s.internalAddRow=function(){return r.b(s,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return this.rowValues=void 0,(e=this.vForm.vSubmit).caption=this.newSubmitCaption,e.className="btn btn-outline-success",this.vForm.reset(),this.vForm.mode=q.new,[4,this.showRow(void 0)];case 1:return t.sent(),[2]}})})},s.view=function(){var e;void 0===s.addRow&&s.mode===q.readonly||(e=i.createElement("button",{onClick:s.addRow||s.internalAddRow,type:"button",className:"btn btn-link p-0"},s.ownerForm.arrTitleNewButton));var t=s.header||i.createElement("div",{className:"px-3 bg-light small",style:{paddingTop:"1px",paddingBottom:"1px"}},i.createElement("div",{className:"flex-fill align-self-center"},s.label),e);return i.createElement(v.List,{className:"pb-3",header:t,none:i.createElement(v.Muted,{className:"px-3 py-2"},s.none),items:s.list,item:{render:s.renderItem,onClick:s.editRow}})},s.ownerForm=t;var a=n.name,u=n.fields;s.name=a;var c=t.ui,l=t.res,d=t.mode,p=t.inputs,f=t.values,m=l.arrs,b=void 0!==m?m[a]:{},y=b.label,g=b.none,w=b.newSubmit,E=b.editSubmit;s.none=g||t.none,s.newSubmitCaption=w||t.arrNewCaption,s.editSubmitCaption=E||t.arrEditCaption,s.label=y||a;var k=c&&c.items[a]||{};return s.rowContent=k.rowContent,s.mode=d,void 0===s.onEditRow?s.vForm=new W({fields:u,arrs:void 0,ui:k,res:b,inputs:p[a],none:t.none,submitCaption:"submit",arrNewCaption:void 0,arrEditCaption:void 0,arrTitleNewButton:void 0,mode:d},d===q.readonly?void 0:s.onSubmit):s.onEditRow=o,s.list=f[a],s}return r.d(t,e),t.prototype.reset=function(){this.vForm.reset(),this.list.clear()},t.prototype.setAddRow=function(e){this.addRow=e},t}(h.d),M=n(13),_={textAlign:"left",paddingLeft:"0.75rem",paddingRight:"0.75rem",overflow:"hidden"},H=function(e){function t(t,n,o,a){var u=e.call(this,t,n,o,a)||this;return u.onClick=function(){return r.b(u,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return!0!==this.readonly?[3,2]:this.value?[4,this.tuid.showInfo(this.value.id)]:[2];case 1:return t.sent(),[2];case 2:return void 0===this.input?[3,4]:[4,this.input.select(this.vForm,this.field,this.vForm.getValues())];case 3:return e=t.sent(),[3,5];case 4:alert("call undefined"),e=0,t.label=5;case 5:return this.setValue(this.tuid.boxId(e)),[2]}})})},u.view=Object(s.a)(function(){var e,t,n=u.fieldRes.placeHolder,r=!1,o=u.field._ownerField;if(void 0!==o){var s=o.name;o.arr;r=null===u.vForm.getValue(s)}if(null===u.value)e=i.createElement(i.Fragment,null,n||u.input.placeHolder);else if("object"===typeof u.value)e=Object(M.b)(u.value);else{var a=u.tuid.boxId(u.value);e=Object(M.b)(a)}return!0===u.readonly?i.createElement("div",{className:"form-control form-control-plaintext border border-info rounded bg-light cursor-pointer",onClick:u.onClick},e):(!0!==u.fieldUI.required&&!1!==u.field.null||(t=i.createElement(P,null)),i.createElement(i.Fragment,null,t,i.createElement("button",{className:"form-control btn btn-outline-info",type:"button",disabled:r,style:_,onClick:u.onClick},e)))}),u.tuid=n._tuid,u.vForm=t,u.input=t.inputs[n.name],u}return r.d(t,e),t}(C),$=function(){function e(e,t,n){this.vForm=e,this.onSubmit=n;var r=t.fields,i=t.arrs,o=t.ui,s=t.res;if(this.fields=r,this.arrs=i,void 0!==o){var a=o.items,u=o.layout;this.formItems=a,this.layout=u}this.res=s}return e.prototype.build=function(){return void 0===this.layout?this.bandsOnFly():this.bandsFromLayout()},e.prototype.resFromName=function(e,t){if(void 0!==t){var n=t.fields;if(void 0!==n)return n[e]||e}},e.prototype.bandsOnFly=function(){var e=[];if(this.bandsFromFields(e,this.fields,this.res),void 0!==this.arrs)for(var t=0,n=this.arrs;t<n.length;t++){var r=n[t];e.push(this.bandFromArr(r))}return void 0!==this.onSubmit&&e.push(new l(new p(this.vForm))),e},e.prototype.bandsFromFields=function(e,t,n){if(void 0!==t)for(var r=0,i=t;r<i.length;r++){var o=i[r];e.push(this.bandFromField(o,n))}},e.prototype.bandsFromLayout=function(){return[]},e.prototype.bandFromField=function(e,t){var n,r,i,o,s=e.name,a=this.resFromName(s,t);return"object"===typeof a?(r=a.label,n=a):(r=a,n=void 0),void 0!==this.formItems&&(o=this.formItems[s]),void 0===(i="function"===typeof o?new R(this.vForm,e,n):function(e,t,n,r){var i;switch(t.type){default:return;case"tinyint":case"smallint":case"int":i=O;break;case"bigint":if(void 0!==t._tuid)return;i=O;break;case"dec":i=V;break;case"char":i=S;break;case"text":i=I;break;case"datetime":i=A;break;case"date":i=j}return new i(e,t,n,r)}(this.vForm,e,o,n))&&(i=new H(this.vForm,e,o,n)),new u(r||s,i)},e.prototype.bandFromArr=function(e){var t=e.name,n=(e.fields,new B(this.vForm,e));return new c(t,n)},e}();!function(e){e[e.new=0]="new",e[e.edit=1]="edit",e[e.readonly=2]="readonly"}(q||(q={}));var W=function(){function e(e,t){var n=this;this.vFields={},this.vArrs={},this.onFormSubmit=function(e){return e.preventDefault(),!1},this.view=Object(s.a)(function(e){var t=e.className;return i.createElement("form",{className:t,onSubmit:n.onFormSubmit},n.bands.map(function(e){return e.render()}))});var r=e.fields,o=e.arrs,a=e.ui,u=e.res,c=e.inputs,l=e.none,h=e.submitCaption,d=e.arrNewCaption,p=e.arrEditCaption,f=e.arrTitleNewButton,m=e.mode;this.fields=r,this.arrs=o,this.ui=a,void 0!==this.ui&&(this.formItems=this.ui.items),this.res=u,this.inputs=c,this.none=l,this.submitCaption=h,this.arrNewCaption=d,this.arrEditCaption=p,this.arrTitleNewButton=f||i.createElement("small",null,i.createElement(v.FA,{name:"plus"})," \u65b0\u589e"),this.mode=void 0===t?q.readonly:m,this.buildFormValues(),this.buildBands(e,t),this.onSubmit=t}return e.prototype.buildBands=function(e,t){this.bandColl={};var n=new $(this,e,t);this.bands=n.build();for(var r=0,i=this.bands;r<i.length;r++){var o=i[r];this.bandColl[o.key]=o;var s=o.getVFields();if(void 0!==s)for(var a=0,u=s;a<u.length;a++){var c=u[a];this.vFields[c.name]=c}var l=o.getVArr();void 0!==l&&(this.vArrs[l.name]=l);var h=o.getVSubmit();void 0!==h&&(this.vSubmit=h)}},e.prototype.getBand=function(e){return this.bandColl[e]},e.prototype.computeFields=function(){if(void 0!==this.formItems){var e=this.values;for(var t in this.formItems){var n=this.formItems[t];"function"===typeof n&&(e[t]=n.call(this,e))}}},e.prototype.submit=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return void 0===this.onSubmit?[2]:[4,this.onSubmit()];case 1:return e.sent(),[2]}})})},e.prototype.getValues=function(){for(var e={},t=this.values,n=0,r=this.fields;n<r.length;n++){var i=t[u=r[n].name];e[u]=null!==i&&"object"===typeof i?i.id:i}if(void 0!==this.arrs)for(var o=0,s=this.arrs;o<s.length;o++)for(var a=s[o],u=a.name,c=a.fields,l=a.id,h=a.order,d=e[u]=[],p=0,f=this.vArrs[u].list;p<f.length;p++){var m=f[p],v={};void 0!==l&&(v[l]=m[l]),void 0!==h&&(v[h]=m[h]);for(var b=0,y=c;b<y.length;b++){var g=y[b].name;i=m[g];v[g]=null!==i&&"object"===typeof i?i.id:i}d.push(v)}return e},Object.defineProperty(e.prototype,"valueBoxs",{get:function(){for(var e={},t=this.values,n=0,r=this.fields;n<r.length;n++){var i=(v=r[n]).name,o=v._tuid,s=t[i];e[i]=void 0===o||"object"===typeof s?s:o.boxId(s)}if(void 0===this.arrs)return e;for(var a=0,u=this.arrs;a<u.length;a++)for(var c=u[a],l=(i=c.name,c.fields),h=(c.id,c.order,0),d=e[i]=this.vArrs[i].list.slice();h<d.length;h++)for(var p=d[h],f=0,m=l;f<m.length;f++){var v,b=(v=m[f]).name;o=v._tuid,s=p[b];p[b]=void 0===o||"object"===typeof s?s:o.boxId(s)}return e},enumerable:!0,configurable:!0}),e.prototype.setValues=function(e){if(void 0!==e){for(var t=this.values,n=this.errors,r=0,i=this.fields;r<i.length;r++){var o=i[r].name;n[o]=void 0;var s=e[o];t[o]=s}for(var a in this.vArrs){var u=e[a];if(void 0!==u){var c=t[a];c.clear(),c.push.apply(c,u)}}}else this.reset()},Object.defineProperty(e.prototype,"isOk",{get:function(){for(var e in this.vFields)if(!1===this.vFields[e].isOk)return!1;return!0},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e=this.values,t=this.errors,n=0,r=this.fields;n<r.length;n++){var i=r[n].name;e[i]=null,t[i]=void 0}for(var o in this.vFields){var s=this.vFields[o];void 0!==s.name&&s.setValue(null)}for(var o in this.vArrs){this.vArrs[o].reset()}},e.prototype.getValue=function(e){return this.values[e]},e.prototype.setValue=function(e,t){this.values[e]=t},e.prototype.setError=function(e,t){this.errors[e]=t},e.prototype.buildFieldValues=function(e){for(var t={valueFromFieldName:function(e){return this[e]}},n=0,r=e;n<r.length;n++){t[r[n].name]=null}return t},e.prototype.buildObservableValues=function(){var e=this.buildFieldValues(this.fields);if(void 0!==this.arrs)for(var t=0,n=this.arrs;t<n.length;t++){e[n[t].name]=d.l.array([],{deep:!0})}return Object(d.l)(e)},e.prototype.buildFormValues=function(){this.values=this.buildObservableValues(),this.errors=Object(d.l)(this.buildFieldValues(this.fields))},e.prototype.render=function(e){return void 0===e&&(e="py-3"),i.createElement(this.view,{className:e})},r.c([d.e],e.prototype,"isOk",null),e}();n.d(t,"a",function(){return q}),n.d(t,"b",function(){return W})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(15),o=n(9),s=n(22);var a=function(){function e(e,t,n,i){var o=this;this.startWait=function(){void 0!==o.ui&&o.ui.startWait()},this.endWait=function(e,t){void 0!==o.ui&&o.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)},this.showError=function(e){return r.b(o,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return void 0===this.ui?[3,2]:[4,this.ui.showError(e)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},this.isCenter=e,this.hostUrl=t,this.apiToken=n,this.ui=i,this.timeout=!0===s.b?5e5:5e3}return e.prototype.used=function(){this.post("",{})},e.prototype.get=function(e,t){return void 0===t&&(t=void 0),r.b(this,void 0,Promise,function(){var n,i,o,s,a,u;return r.e(this,function(r){switch(r.label){case 0:if(t&&(n=Object.keys(t)).length>0)for(i="?",o=0,s=n;o<s.length;o++)a=s[o],void 0!==t[a]&&(e+=i+a+"="+t[a],i="&");return(u=this.buildOptions()).method="GET",[4,this.innerFetch(e,u)];case 1:return[2,r.sent()]}})})},e.prototype.post=function(e,t){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="POST",n.body=JSON.stringify(t),[4,this.innerFetch(e,n)];case 1:return[2,r.sent()]}})})},e.prototype.put=function(e,t){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="PUT",n.body=JSON.stringify(t),[4,this.innerFetch(e,n)];case 1:return[2,r.sent()]}})})},e.prototype.delete=function(e,t){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=this.buildOptions()).method="DELETE",n.body=JSON.stringify(t),[4,this.innerFetch(e,n)];case 1:return[2,r.sent()]}})})},e.prototype.fetch=function(e,t,n,i){return r.b(this,void 0,Promise,function(){function s(e){return{channel:a,url:u,options:t,resolve:n,reject:i,error:e}}var a,u,c,l,h,d,p,f=this;return r.e(this,function(m){switch(m.label){case 0:a=this,this.startWait(),u=e,m.label=1;case 1:return m.trys.push([1,6,,8]),console.log("%s %s",t.method,u),c=setTimeout(function(){return a.endWait(e,i)},this.timeout),[4,fetch(encodeURI(u),t)];case 2:if(!1===(l=m.sent()).ok)throw clearTimeout(c),a.endWait(),console.log("call error %s",l.statusText),l.statusText;return(h=l.headers.get("content-type"))&&h.indexOf("json")>=0?[2,l.json().then(function(e){return r.b(f,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return clearTimeout(c),a.endWait(),!0===e.ok?[2,n(e.res)]:void 0!==e.error?[3,2]:[4,a.showError(s("not valid tonva json"))];case 1:return t.sent(),[3,4];case 2:return[4,a.showError(s(e.error))];case 3:t.sent(),i(e.error),t.label=4;case 4:return[2]}})})}).catch(function(e){return r.b(f,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,a.showError(s(e.message))];case 1:return t.sent(),[2]}})})})]:[3,3];case 3:return[4,l.text()];case 4:d=m.sent(),clearTimeout(c),a.endWait(),n(d),m.label=5;case 5:return[3,8];case 6:return"string"===typeof(p=m.sent())&&!0===p.toLowerCase().startsWith("unauthorized")?(o.c.logout(),[2]):[4,this.showError(s(p.message))];case 7:return m.sent(),[3,8];case 8:return[2]}})})},e.prototype.innerFetch=function(e,t){return r.b(this,void 0,Promise,function(){var n,o=this;return r.e(this,function(s){switch(s.label){case 0:return n=this.hostUrl+e,!0===this.isCenter&&void 0===this.apiToken&&Object(i.g)()?[4,Object(i.d)(n,t.method,t.body)]:[3,2];case 1:return[2,s.sent()];case 2:return[4,new Promise(function(e,i){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(n,t,e,i)];case 1:return r.sent(),[2]}})})})];case 3:return[2,s.sent()]}})})},e.prototype.callFetch=function(e,t,n){return r.b(this,void 0,Promise,function(){var i,o=this;return r.e(this,function(s){switch(s.label){case 0:return(i=this.buildOptions()).method=t,i.body=n,[4,new Promise(function(t,n){return r.b(o,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.fetch(e,i,t,n)];case 1:return r.sent(),[2]}})})})];case 1:return[2,s.sent()]}})})},e.prototype.buildOptions=function(){var e=o.c.language,t=o.c.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=e;return t&&(r+="-"+t),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),{headers:n}},e}()},,function(e,t,n){"use strict";var r=n(42);n.d(t,"CApp",function(){return r.a});n(77),n(49),n(53),n(26),n(48),n(37),n(50),n(52),n(51);var i=n(12);n.d(t,"PureJSONContent",function(){return i.b});n(28);var o=n(78);n.o(o,"tv")&&n.d(t,"tv",function(){return o.tv});n(46),n(7),n(18),n(45)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=function(){function e(e){this.formView=e}return e.prototype.render=function(){return i.createElement("div",{className:"col-sm-10"},this.renderControl())},Object.defineProperty(e.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.clear=function(){},e.prototype.clearErrors=function(){},e.prototype.readValues=function(e){},e.prototype.setError=function(e,t){},e.prototype.setInitValues=function(e){},e.prototype.isOk=function(){return this.validate(),!this.hasError},e.prototype.validate=function(){},r.c([o.e],e.prototype,"hasError",null),r.c([o.e],e.prototype,"filled",null),e}(),a=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.field=n,i.face=r,i.init(),i.setProps(),i}return r.d(t,e),t.prototype.ref=function(e){this.element=e},t.prototype.init=function(){var e;this.rules=[];var t=this.field.rules;void 0!==t&&(!0===Array.isArray(t)?(e=this.rules).push.apply(e,t):this.rules.push(t))},t.prototype.setProps=function(){return this.props={ref:this.ref.bind(this),name:this.field.name}},Object.defineProperty(t.prototype,"hasError",{get:function(){return void 0!==this.error},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return void 0!==this.value&&this.value!==this.field.defaultValue},enumerable:!0,configurable:!0}),t.prototype.clearValue=function(){this.value=void 0},t.prototype.clear=function(){this.clearErrors(),this.clearValue()},t.prototype.clearErrors=function(){this.isOK=void 0,this.error=void 0},t.prototype.readValues=function(e){e[this.field.name]=this.value},t.prototype.setError=function(e,t){},t.prototype.setInitValues=function(e){},t.prototype.getValueFromElement=function(){return this.value},t.prototype.validate=function(){try{var e=this.getValueFromElement();if(this.rules.length>0){for(var t=void 0,n=0,r=this.rules;n<r.length;n++){var i=r[n];console.log("validate: %s",e);var o=i(e);if(console.log("validate: %s err: %s",e,o),!0===o)this.error=void 0,t=!0;else if(void 0!==o)return this.error=o,void(this.isOK=!1)}this.isOK=t}this.value=e}catch(s){this.error=s.message}},t.prototype.render=function(){var e;if(void 0!==this.face){var t=this.face.notes;void 0!==t&&(e=i.createElement("small",{className:"text-muted"},t))}return i.createElement("div",{className:"col-sm-10"},this.renderControl(),e)},r.c([o.l],t.prototype,"isOK",void 0),r.c([o.l],t.prototype,"error",void 0),r.c([o.l],t.prototype,"value",void 0),r.c([o.e],t.prototype,"hasError",null),r.c([o.e],t.prototype,"filled",null),t}(s),u=function(e){function t(t){var n=e.call(this,t)||this;return n.otherClick=n.otherClick.bind(n),n}return r.d(t,e),t.prototype.otherClick=function(){var e=this.formView.props.onOther;void 0!==e&&e(this.formView.readValues())},t.prototype.renderControl=function(){console.log("buttons.renderControl");var e=this.formView.nothing,t=this.formView.hasError,n=this.formView.props;console.log("buttons.renderControl nothing:%s hasError:%s",e,t);var r,o=n.submitButton,s=n.otherButton;n.onOther;return void 0!==s&&(r=i.createElement("button",{className:"btn btn-outline-info ml-auto",onClick:this.otherClick},s)),i.createElement("div",{className:"d-flex justify-content-start"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:e||t},o||"\u63d0\u4ea4"),r)},t}(s),c=n(8),l=n(6),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.init=function(){e.prototype.init.call(this),!0===this.field.required&&this.rules.push(function(e){return null!==e&&void 0!==e&&0!==e.trim().length||"\u5fc5\u987b\u586b\u5165\u8981\u6c42\u5185\u5bb9"})},t.prototype.getValueFromElement=function(){return this.parseValue(this.element.value)},t.prototype.setProps=function(){e.prototype.setProps.call(this),c.assign(this.props,{onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)});var t=this.face;return void 0!==t&&c.assign(this.props,{placeholder:t.placeholder}),this.props},t.prototype.parseValue=function(e){return e},t.prototype.onBlur=function(){this.validate()},t.prototype.onChange=function(){console.log("onChange"),this.validate()},t.prototype.onFocus=function(){this.clearErrors()},t.prototype.className=function(){return l({"form-control":!0,"has-success":!0===this.isOK,"is-invalid":void 0!==this.error,"is-valid":void 0===this.error&&!0===this.isOK})},t.prototype.renderInput=function(){return i.createElement("input",r.a({className:this.className()},this.props))},t.prototype.ref=function(t){e.prototype.ref.call(this,t),t&&(t.value=void 0===this.value?"":this.value)},t.prototype.renderError=function(){return void 0===this.error?null:i.createElement("div",{className:"invalid-feedback"},this.error)},t.prototype.clearValue=function(){e.prototype.clearValue.call(this),this.element.value=""},t.prototype.setError=function(e,t){this.field.name===e&&(this.error=t)},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0!==t&&(this.value=t)},t.prototype.renderControl=function(){return i.createElement(i.Fragment,null,this.renderInput(),this.renderError())},t}(a),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return c.assign(t,{type:"text",maxLength:this.field.maxLength}),t},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length)return e},t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this);return c.assign(t,{type:"password",maxLength:this.field.maxLength}),t},t}(d),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.extraChars=[];var t=this.field,n=t.min,r=t.max;switch(void 0!==n?(this.rules.push(function(e){if(void 0!==e)return!(e<n)||"\u6700\u5c0f\u503c\u4e3a"+n}),n<0&&this.extraChars.push(45)):this.extraChars.push(45),void 0!==r&&this.rules.push(function(e){if(void 0!==e)return!(e>r)||"\u6700\u5927\u503c\u4e3a"+r}),this.field.type){case"dec":case"number":this.extraChars.push(46)}},t.prototype.parseValue=function(e){if(void 0!==e&&0!==e.trim().length){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("\u65e0\u6548\u7684\u6570\u5b57");return t}},t.prototype.setProps=function(){e.prototype.setProps.call(this),c.assign(this.props,{type:"number",step:this.field.step,onKeyPress:this.onKeyPress.bind(this)})},t.prototype.onKeyPress=function(e){var t=e.charCode;if(!(8===t||0===t||13===t||t>=48&&t<=57))if(void 0!==this.extraChars&&this.extraChars.indexOf(t)>=0)switch(t){case 46:this.onKeyDot();break;case 45:this.onKeyNeg(),e.preventDefault()}else e.preventDefault()},t.prototype.onKeyDot=function(){var e=this.element.value;e.indexOf(".")>=0&&(this.element.value=e.replace(".",""))},t.prototype.onKeyNeg=function(){var e=this.element.value,t=e.indexOf("-");e=t>=0?e.replace("-",""):"-"+e,this.element.value=e},t}(h),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.init=function(){e.prototype.init.call(this);var t=this.field,n=t.trueValue,r=t.falseValue;void 0===n&&(this.trueValue=1),void 0===r&&(this.falseValue=0)},t.prototype.setProps=function(){e.prototype.setProps.call(this),c.assign(this.props,{onChange:this.onChange.bind(this)})},t.prototype.clearValue=function(){this.element.checked=this.field.defaultValue===this.trueValue,this.value=this.getValueFromElement()},t.prototype.setInitValues=function(e){var t=e[this.field.name];void 0===t&&(t=this.field.defaultValue)},t.prototype.getValueFromElement=function(){return this.element.checked?this.trueValue:this.falseValue},t.prototype.onChange=function(){this.value=this.getValueFromElement()},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static"},i.createElement("label",{className:"form-control"},i.createElement("label",{className:"custom-control custom-checkbox mb-0"},i.createElement("input",{type:"checkbox",name:this.field.name,ref:this.props.ref,onChange:this.props.onChange,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},this.face.label))))},t}(a),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.renderControl=function(){var e=this;return i.createElement("div",{className:"form-control-static"},i.createElement("div",{className:"form-control"},this.face.list.map(function(t,n){var r;return"object"!==typeof t?r=t:(r=t.text,t.value),i.createElement("label",{key:n,className:"custom-control custom-radio w-25"},i.createElement("input",{type:"radio",name:e.field.name,className:"custom-control-input"}),i.createElement("span",{className:"custom-control-indicator"}),i.createElement("span",{className:"custom-control-description"},r))})))},t}(a),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setProps=function(){var t=e.prototype.setProps.call(this),n=this.field.maxLength,r=this.face.rows;return c.assign(t,{maxLength:n,rows:r}),t},t.prototype.renderInput=function(){var e=this;return i.createElement("textarea",r.a({ref:function(t){e.el=t,void 0!==t&&(t.value="")},className:this.className()},this.props))},t}(h),y=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.ref=i.ref.bind(i),i}return r.d(t,e),t.prototype.getValueFromElement=function(){var e=this.element,t=(e.selectedIndex,e.selectedOptions[0].value);switch(this.field.type){case"number":t=Number(t);break;case"date":t=new Date(t);break;case"bool":"string"===typeof t&&(t="true"===t.toLowerCase())}return t},t.prototype.renderControl=function(){var e=this.face.list,t=[];return void 0===this.face.default&&t.push(i.createElement("option",{key:-1,value:void 0},"\u8bf7\u9009\u62e9")),t.push.apply(t,e.map(function(e,t){var n,r;return"object"!==typeof e?n=r=e:(n=e.text,r=e.value),i.createElement("option",{key:t,value:r},n)})),i.createElement("div",{className:"form-control-static"},i.createElement("select",{name:this.field.name,className:"form-control",ref:this.ref},t))},t}(a),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},i.createElement("div",{className:"alert alert-primary",role:"alert"},"don't know how to create control",i.createElement("br",null),"field: ",JSON.stringify(this.field)," must be object ",i.createElement("br",null),"face: ",JSON.stringify(this.face)," must be object ",i.createElement("br",null)))},t}(a),w=function(e){function t(t,n){var r=e.call(this,t)||this;return r.element=n,r}return r.d(t,e),t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-plaintext"},this.element)},t}(s),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return r.b(t,void 0,void 0,function(){var e,t,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(i=r.sent())?(this.value=void 0,[2]):void 0===n?(this.value=i.id,[2]):(o=n(i),s=o.id,a=o.caption,this.value=s,this.caption=a,[2])}})})},t.onPicked=function(e){t.value=e.id},t}return r.d(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.controlContent=function(){var e=this.face,t=e.itemFromId,n=e.fromPicked,r=e.initCaption;if(void 0===this.value)return r||"\u8bf7\u9009\u62e9Id";if(void 0!==this.caption)return this.caption;if(void 0!==t&&void 0!==n){var i=t(this.value);if(i){var o=n(i);if(void 0!==o)return o.caption}}return String(this.value)},t.prototype.renderControl=function(){var e=this.face,t=e.tuid,n=e.input;return void 0===n?i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer",onClick:this.onClick},this.controlContent()):i.createElement("div",{className:"form-control-static "},i.createElement(n.component,{id:this.value,ui:t}))},r.c([o.l],t.prototype,"caption",void 0),t}(a),k=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.onIdChanged=i.onIdChanged.bind(i),i}return r.d(t,e),t.prototype.onIdChanged=function(e){this.value=e.id},t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.buildContent=function(){var e=this;return i.createElement(this.face.input.component,r.a({},this.face,{id:this.value,onFormValues:function(){return e.formView.readValues()},onIdChanged:this.onIdChanged}))},t.prototype.renderControl=function(){return i.createElement("div",{className:"form-control-static "},this.buildContent())},r.c([o.l],t.prototype,"caption",void 0),t}(a),C=n(5),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return r.b(t,void 0,void 0,function(){var e,t,n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return e=this.face,t=e.pick,n=e.fromPicked,[4,t(this.face,this.formView.props,this.formView.readValues())];case 1:return void 0===(i=r.sent())?(this.value=void 0,[2]):(o=n(i),s=o.id,a=o.caption,this.value=s,this.caption=a,[2])}})})},t.view=Object(C.a)(function(){var e,n=t.face.content;return e=void 0===t.value||null===t.value?"\u8bf7\u9009\u62e9":i.createElement(n,{id:t.value}),i.createElement("div",{className:"form-control-plaintext px-2 border text-primary rounded cursor-pointer bg-light",onClick:t.onClick},e)}),t}return r.d(t,e),t.prototype.setInitValues=function(e){var t=e[this.field.name];this.value=t},t.prototype.renderControl=function(){return i.createElement(this.view,null)},r.c([o.l],t.prototype,"caption",void 0),t}(a);n.d(t,"b",function(){return P}),n.d(t,"a",function(){return u});var P=function(e,t){t.label;return void 0!==t.group?function(e,t,n){return new g(e,n,void 0)}(e,0,t):void 0!==t.field?function(e,t,n){var r=n.field,i=n.face;switch(typeof r){case"string":r={name:r,type:"string"};break;case"object":break;default:return new g(e,r,i)}var o=r.type||"string";if(void 0===i){if(void 0===(i=x[o]))return new g(e,r,i)}else if(void 0===i.type){var s=x[o];i.type=void 0===s?"string":s.type}return new(S[i.type||o]||g)(e,r,i)}(e,0,t):new w(e,t.help)},S={string:d,password:p,number:f,checkbox:m,radiobox:v,select:y,"pick-id":E,"pick-tuid":k,textarea:b,pick:N},x={string:{type:"string"},number:{type:"number"},int:{type:"number"},dec:{type:"number"},bool:{type:"checkbox"}}},function(e,t,n){"use strict";var r=n(0),i=n(4),o=n(8),s=n.n(o),a=function(){function e(e,t,n){this.fieldMaps={},this.entities=e,this.name=t,this.typeId=n,this.sys=this.name.indexOf("$")>=0}return Object.defineProperty(e.prototype,"sName",{get:function(){return this.jName||this.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tvApi",{get:function(){return this.entities.uqApi},enumerable:!0,configurable:!0}),e.prototype.getApiFrom=function(){return this.entities.uqApi},e.prototype.fieldMap=function(e){void 0===e&&(e="$");var t=this.fieldMaps[e];if(void 0===t){var n=void 0;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){void 0!==(r=this.arrFields.find(function(t){return t.name===e}))&&(n=r.fields)}else if(void 0!==this.returns){var r;void 0!==(r=this.returns.find(function(t){return t.name===e}))&&(n=r.fields)}if(void 0===n)return{};t={};for(var i=0,o=n;i<o.length;i++){var s=o[i];t[s.name]=s}this.fieldMaps[e]=t}return t},e.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return void 0!==this.schema?[2]:[4,this.entities.uqApi.schema(this.name)];case 1:return e=t.sent(),this.setSchema(e),this.buildFieldsTuid(),[2]}})})},e.prototype.setSchema=function(e){if(void 0!==e&&void 0===this.schema){this.schema=e;var t=e.name;t!==this.name&&(this.jName=t),this.buildFieldsTuid()}},e.prototype.buildFieldsTuid=function(){var e=this.schema,t=e.fields,n=e.arrs,r=e.returns;this.entities.buildFieldTuid(this.fields=t),this.entities.buildArrFieldsTuid(this.arrFields=n,t),this.entities.buildArrFieldsTuid(this.returns=r,t)},e.prototype.schemaStringify=function(){return JSON.stringify(this.schema,function(e,t){if("_tuid"!==e)return t},4)},e.prototype.tuidFromField=function(e){var t=e._tuid,n=e.tuid;if(void 0!==n)return void 0!==t?t:e._tuid=this.entities.getTuid(n,void 0)},e.prototype.tuidFromName=function(e,t){if(void 0!==this.schema){var n=this.schema,r=n.fields,i=n.arrs,o=this.entities,s=e.toLowerCase();if(void 0===t)return c(s,r);if(void 0!==i){var a=t.toLowerCase(),u=i.find(function(e){return e.name===a});if(void 0!==u)return c(s,u.fields)}}function c(e,t){if(void 0!==t){var n=t.find(function(t){return t.name===e});if(void 0!==n)return o.getTuid(n.tuid,void 0)}}},e.prototype.buildParams=function(e){var t={},n=this.fields;void 0!==n&&this.buildFieldsParams(t,n,e);var r=this.arrFields;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i],a=s.name,u=s.fields;if(void 0!==e[a]){var c=[];t[a]=c;for(var l=0,h=e;l<h.length;l++){var d=h[l],p={};this.buildFieldsParams(p,u,d),c.push(p)}}}return t},e.prototype.buildFieldsParams=function(e,t,n){for(var r=0,i=t;r<i.length;r++){var o=i[r],s=o.name,a=n[s],u=void 0;switch(typeof a){default:u=a;break;case"object":var c=o._tuid;u=void 0===c?a.id:c.getIdFromObj(a)}e[s]=u}},e.prototype.pack=function(e){var t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);var r=this.arrFields;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];this.packArr(t,s.fields,e[s.name])}return t.join("")},e.prototype.escape=function(e,t){var n=e[t.name];switch(typeof n){default:return n;case"object":var r=t._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var i=n.length,o="",s=0,a=0;a<i;a++){switch(n.charCodeAt(a)){case 9:o+=n.substring(s,a)+"\\t",s=a+1;break;case 10:o+=n.substring(s,a)+"\\n",s=a+1}}return o+n.substring(s);case"undefined":return""}},e.prototype.packRow=function(e,t,n){var r=t.length;if(0!==r){var i="";i+=this.escape(n,t[0]);for(var o=1;o<r;o++){var s=t[o];i+="\t"+this.escape(n,s)}e.push(i+"\n")}},e.prototype.packArr=function(e,t,n){if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r];this.packRow(e,t,o)}e.push("\n")},e.prototype.unpackSheet=function(e){var t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));var i=this.arrFields;if(void 0!==i)for(var o=0,s=i;o<s.length;o++){var a=s[o];r=this.unpackArr(t,a,e,r)}return t},e.prototype.unpackReturns=function(e){var t={},n=0,r=this.returns;if(void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i];n=this.unpackArr(t,s,e,n)}return t},e.prototype.unpackRow=function(e,t,n,r){for(var i=0,o=0,s=r,a=0,u=n.length,c=t.length;r<u;r++)if(i=o,9===(o=n.charCodeAt(r))){var l=(d=t[a]).name;if(8!==i){if(r>s){var h=n.substring(s,r);e[l]=this.to(e,h,d)}}else e[l]=null;if(s=r+1,++a>=c){(r=n.indexOf("\n",s))>=0?++r:r=u;break}}else if(10===o){var d;l=(d=t[a]).name;if(8!==i){if(r>s){h=n.substring(s,r);e[l]=this.to(e,h,d)}}else e[l]=null;++r,++a;break}return r},e.prototype.to=function(e,t,n){switch(n.type){default:return t;case"datetime":case"date":case"time":return new Date(Number(t));case"id":case"tinyint":case"smallint":case"int":case"dec":return Number(t);case"bigint":var r=Number(t),i=n._tuid;return void 0===i?r:(i.useId(r,!0),i.boxId(r))}},e.prototype.unpackArr=function(e,t,n,r){for(var i=[],o=n.length,s=t.name,a=t.fields;r<o;){if(10===n.charCodeAt(r)){++r;break}var u={};i.push(u),r=this.unpackRow(u,a,n,r)}return e[s]=i,r},e}(),u=n(89),c=(function(){}(),function(e){function t(t,n,r,o){var s=e.call(this,t,r,o)||this;return s.queue=[],s.waitingIds=[],s.cache=i.l.map({},{deep:!1}),s.owner=n,s}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"tuid"},enumerable:!0,configurable:!0}),t.prototype.buildIdBoxer=function(){if(void 0===this.BoxId){this.BoxId=function(){};var e=this.BoxId.prototype;Object.defineProperty(e,"_$tuid",{value:this,writable:!1,enumerable:!1}),Object.defineProperty(e,"obj",{enumerable:!1,get:function(){if(!(void 0===this.id||this.id<=0))return this._$tuid.valueFromId(this.id)}}),e.valueFromFieldName=function(e){return this._$tuid.valueFromFieldName(e,this.obj)},e.getObj=function(){if(void 0!==this._$tuid)return this._$tuid.getCacheValue(this.id)},e.toJSON=function(){return this.id}}},t.prototype.boxId=function(e){if("object"===typeof e)return e;this.useId(e),this.buildIdBoxer();var t=new this.BoxId;return t.id=e,t},t.prototype.getTuidContent=function(){return this.entities.cUq.getTuidContent(this)},t.prototype.getIdFromObj=function(e){return e[this.idName]},t.prototype.setSchema=function(t){e.prototype.setSchema.call(this,t);var n=t.id,r=t.unique;this.idName=n,this.unique=r,this.schemaFrom=this.schema.from},t.prototype.buildFieldsTuid=function(){e.prototype.buildFieldsTuid.call(this);var t=this.schema.mainFields;if(void 0!==t)for(var n=function(e){var t=r.fields.find(function(t){return t.name===e.name});if(void 0===t)return"continue";e._tuid=t._tuid},r=this,i=0,o=t;i<o.length;i++){n(o[i])}},t.prototype.moveToHead=function(e){var t=this.queue.findIndex(function(t){return t===e});this.queue.splice(t,1),this.queue.push(e)},t.prototype.valueFromId=function(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}return this.getCacheValue(t)},t.prototype.getCacheValue=function(e){var t=this.cache.get(e);return void 0!==this.owner&&"object"===typeof t&&(t.$owner=this.owner.boxId(t.owner)),t},t.prototype.valueFromFieldName=function(e,t){if(void 0!==t&&void 0!==this.fields){var n=this.fields.find(function(t){return t.name===e});if(void 0!==n){var r=t[e],i=n._tuid;return void 0===i?r:i.valueFromId(r)}}},t.prototype.resetCache=function(e){this.cache.delete(e);var t=this.queue.findIndex(function(t){return t===e});this.queue.splice(t,1),this.useId(e)},t.prototype.useId=function(e,t){if(void 0!==e&&0!==e&&!1!==Object(u.isNumber)(e))if(!0!==this.cache.has(e))if(this.entities.cacheTuids(!0===t?70:20),this.cache.set(e,e),this.waitingIds.findIndex(function(t){return t===e})>=0)this.moveToHead(e);else{if(this.queue.length>=1e3){var n=this.queue.shift();if(n===e)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex(function(e){return e===n});this.waitingIds.splice(r,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e)},t.prototype.proxied=function(e,t){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return this.entities.getTuid(e,void 0).useId(t),[4,this.tvApi.proxied(this.name,e,t)];case 1:return n=r.sent(),this.cacheValue(n),[2,n]}})})},t.prototype.cacheValue=function(e){if(void 0===e)return!1;var t=this.getIdFromObj(e);if(void 0===t)return!1;var n=this.waitingIds.findIndex(function(e){return e===t});return n>=0&&this.waitingIds.splice(n,1),this.cache.set(t,e),!0},t.prototype.afterCacheId=function(e){if(void 0!==this.fields)for(var t=0,n=this.fields;t<n.length;t++){var r=n[t],i=r._tuid;void 0!==i&&i.useId(e[r.name])}},t.prototype.from=function(){},t.prototype.unpackTuidIds=function(e){if(void 0===this.schemaFrom){var t=this.schema.mainFields;if(void 0===t)return e;for(var n=[],r=e.length,i=0;i<r;){if(10===e.charCodeAt(i)){++i;break}var o={};i=this.unpackRow(o,t,e,i),n.push(o)}return n}return n=this.from().unpackTuidIds(e)},t.prototype.cacheIds=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i,o,s;return r.e(this,function(r){switch(r.label){case 0:return 0===this.waitingIds.length?[2]:(void 0===this.owner?e=this.name:(e=this.owner.name,t=this.name),[4,this.getApiFrom().tuidIds(e,t,this.waitingIds)]);case 1:for(n=r.sent(),n=this.unpackTuidIds(n),i=0,o=n;i<o.length;i++)s=o[i],!1!==this.cacheValue(s)&&(this.cacheTuidFieldValues(s),this.afterCacheId(s));return[4,this.cacheDivIds()];case 2:return r.sent(),[2]}})})},t.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return[2]})})},t.prototype.load=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,o,s,a,u;return r.e(this,function(r){switch(r.label){case 0:return void 0===e||0===e?[2]:[4,this.getApiFrom().tuidGet(this.name,e)];case 1:if(void 0===(t=r.sent()))return[2];for(n=0,i=this.schema.fields;n<i.length;n++)o=i[n],void 0!==(s=o.tuid)&&void 0!==(a=this.entities.getTuid(s))&&(u=o.name,t[u]=a.boxId(t[u]));return this.cacheValue(t),this.cacheTuidFieldValues(t),[2,t]}})})},t.prototype.getDiv=function(e){},t.prototype.cacheTuidFieldValues=function(e){var t=this.schema,n=t.fields,r=t.arrs;if(this.cacheFieldsInValue(e,n),void 0!==r)for(var i=0,o=r;i<o.length;i++){var s=o[i],a=s.name,u=s.fields,c=e[a];if(void 0!==c)for(var l=this.getDiv(a),h=0,d=c;h<d.length;h++){var p=d[h];p._$tuid=l,p.$owner=this.boxId(p.owner),l.cacheValue(p),this.cacheFieldsInValue(p,u)}}},t.prototype.cacheFieldsInValue=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i.name,s=i._tuid;if(void 0!==s){var a=e[o];e[o]=s.boxId(a)}}},t.prototype.save=function(e,t){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return(n=s.a.clone(t)).$id=e,[4,this.tvApi.tuidSave(this.name,n)];case 1:return[2,r.sent()]}})})},t.prototype.search=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.searchArr(void 0,e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.searchArr=function(e,t,n,i){return r.b(this,void 0,Promise,function(){var o,s,a,u,c,l,h;return r.e(this,function(r){switch(r.label){case 0:return o=this.schema.fields,void 0!==this.owner?(s=this.owner.name,a=this.name):(s=this.name,a=void 0),[4,this.getApiFrom().tuidSearch(s,a,e,t,n,i)];case 1:for(u=r.sent(),c=0,l=u;c<l.length;c++)h=l[c],this.cacheFieldsInValue(h,o),void 0!==this.owner&&(h.$owner=this.owner.boxId(h.owner));return[2,u]}})})},t.prototype.loadArr=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return void 0===n||0===n?[2]:[4,this.getApiFrom().tuidArrGet(this.name,e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.saveArr=function(e,t,n,i){return r.b(this,void 0,void 0,function(){var o;return r.e(this,function(r){switch(r.label){case 0:return(o=s.a.clone(i)).$id=n,[4,this.tvApi.tuidArrSave(this.name,e,t,o)];case 1:return[2,r.sent()]}})})},t.prototype.posArr=function(e,t,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.tvApi.tuidArrPos(this.name,e,t,n,i)];case 1:return[2,r.sent()]}})})},t.prototype.showInfo=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entities.cUq.showTuid(this,e)];case 1:return t.sent(),[2]}})})},t}(a)),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),Object.defineProperty(t.prototype,"Main",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uqApi",{get:function(){return this.entities.uqApi},enumerable:!0,configurable:!0}),t.prototype.setSchema=function(t){e.prototype.setSchema.call(this,t);var n=t.arrs;if(void 0!==n){this.divs={};for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o.name,a=new h(this.entities,this,s,this.typeId);this.divs[s]=a,a.setSchema(o)}}},t.prototype.getDiv=function(e){return this.divs[e]},t.prototype.cacheDivIds=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.divs)return[2];for(t in e=[],this.divs)e.push(t);n=0,r.label=1;case 1:return n<e.length?(i=e[n],[4,this.divs[i].cacheIds()]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.cUqFrom=function(){if(void 0===this.schemaFrom)return this.entities.cUq;var e=this.schemaFrom,t=e.owner,n=e.uq,r=this.entities.cUq,i=r.cApp;if(void 0===i)return r;var o=i.getImportUq(t,n);return void 0===o?(console.error(t+"/"+n+" \u4e0d\u5b58\u5728"),r):o},t.prototype.getApiFrom=function(){var e=this.from();return void 0!==e?e.entities.uqApi:this.entities.uqApi},t.prototype.from=function(){return void 0===this.schemaFrom?this:this.cUqFrom().tuid(this.name)},t.prototype.cFrom=function(){return this.cUqFrom().cTuidMainFromName(this.name)},t.prototype.cEditFrom=function(){return this.cUqFrom().cTuidEditFromName(this.name)},t.prototype.cInfoFrom=function(){return this.cUqFrom().cTuidInfoFromName(this.name)},t.prototype.cSelectFrom=function(){var e=this.cUqFrom();if(void 0!==e)return e.cTuidSelectFromName(this.name)},t}(c),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),Object.defineProperty(t.prototype,"Main",{get:function(){return this.owner},enumerable:!0,configurable:!0}),t.prototype.from=function(){return this.owner.from().getDiv(this.name)},t.prototype.getApiFrom=function(){return this.owner.getApiFrom()},t}(c),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"action"},enumerable:!0,configurable:!0}),t.prototype.submit=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),t=this.pack(e),[4,this.tvApi.action(this.name,{data:t})];case 2:return[2,n.sent()]}})})},t}(a),p=n(2),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"sheet"},enumerable:!0,configurable:!0}),t.prototype.setSchema=function(t){e.prototype.setSchema.call(this,t),this.states=t.states},t.prototype.build=function(e){this.states=[];for(var t=0,n=e.ops;t<n.length;t++){var r=n[t];this.states.push({name:r,actions:void 0})}},t.prototype.createSheetState=function(e,t){var n={name:e,actions:[]},r=n.actions;for(var i in t){var o={name:i};r.push(o)}return n},t.prototype.save=function(e,t){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),n=this.entities.appId,i=this.pack(t),[4,this.tvApi.sheetSave(this.name,{app:n,discription:e,data:i})];case 2:return[2,r.sent()]}})})},t.prototype.action=function(e,t,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.sheetAction(this.name,{id:e,flow:t,state:n,action:i})];case 2:return[2,r.sent()]}})})},t.prototype.unpack=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,o;return r.e(this,function(r){return t=e[0],n=t[0],i=this.unpackSheet(n.data),o=e[1],[2,{brief:n,data:i,flows:o}]})})},t.prototype.getSheet=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.getSheet(this.name,e)];case 2:return 0!==(t=n.sent())[0].length?[3,4]:[4,this.getArchive(e)];case 3:return[2,n.sent()];case 4:return[4,this.unpack(t)];case 5:return[2,n.sent()]}})})},t.prototype.getArchive=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.sheetArchive(this.name,e)];case 2:return t=n.sent(),[4,this.unpack(t)];case 3:return[2,n.sent()]}})})},t.prototype.getArchives=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.sheetArchives(this.name,{pageStart:e,pageSize:t})];case 2:return[2,n.sent()]}})})},t.prototype.getStateSheets=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.stateSheets(this.name,{state:e,pageStart:t,pageSize:n})];case 2:return[2,r.sent()]}})})},t.prototype.createPageStateItems=function(){return new m(this)},t.prototype.stateSheetCount=function(){return r.b(this,void 0,Promise,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.tvApi.stateSheetCount(this.name)];case 2:return e=t.sent(),[2,this.states.map(function(t){var n=t.name,r=0,i=e.find(function(e){return e.state===n});return void 0!==i&&(r=i.count),{state:n,count:r}})]}})})},t.prototype.mySheets=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.mySheets(this.name,{state:e,pageStart:t,pageSize:n})];case 2:return[2,r.sent()]}})})},t}(a),m=function(e){function t(t){var n=e.call(this,!0)||this;return n.sheet=t,n.pageSize=10,n}return r.d(t,e),t.prototype.load=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.sheet.getStateSheets(e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.setPageStart=function(e){this.pageStart=void 0===e?0:e.id},t}(p.PageItems),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"query"},enumerable:!0,configurable:!0}),t.prototype.setSchema=function(t){e.prototype.setSchema.call(this,t);var n=t.returns;this.returns=n,this.isPaged=void 0!==n.find(function(e){return"$page"===e.name})},t.prototype.resetPage=function(e,t){this.pageStart=void 0,this.pageSize=e,this.params=t,this.more=!1,this.list=void 0},Object.defineProperty(t.prototype,"hasMore",{get:function(){return this.more},enumerable:!0,configurable:!0}),t.prototype.loadPage=function(){return r.b(this,void 0,Promise,function(){var e,t,n,o;return r.e(this,function(r){switch(r.label){case 0:if(void 0===this.pageSize)throw"call resetPage(size:number, params:any) first";if(void 0!==this.pageStart)switch(this.startField.type){default:t=this.pageStart;break;case"date":case"time":case"datetime":t=this.pageStart.getTime()}return[4,this.page(this.params,t,this.pageSize+1)];case 1:return n=r.sent(),this.list=i.l.array([],{deep:!1}),void 0!==n&&(n.length>this.pageSize?(this.more=!0,n.pop(),o=this.returns.find(function(e){return"$page"===e.name}),this.startField=o.fields[0],this.pageStart=n[n.length-1][this.startField.name]):this.more=!1,(e=this.list).push.apply(e,n)),[2]}})})},t.prototype.page=function(e,t,n){return r.b(this,void 0,Promise,function(){var i;return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.tvApi.page(this.name,t,n+1,this.buildParams(e))];case 2:return i=r.sent(),[4,this.unpackReturns(i)];case 3:return[2,r.sent().$page]}})})},t.prototype.query=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.loadSchema()];case 1:return n.sent(),[4,this.tvApi.query(this.name,this.buildParams(e))];case 2:return t=n.sent(),[4,this.unpackReturns(t)];case 3:return[2,n.sent()]}})})},t.prototype.table=function(e){return r.b(this,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(e)];case 1:for(n in t=r.sent())return[2,t[n]];return[2]}})})},t.prototype.obj=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(e)];case 1:return(t=n.sent()).length>0?[2,t[0]]:[2]}})})},t.prototype.scalar=function(e){return r.b(this,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(e)];case 1:for(n in t=r.sent())return[2,t[n]];return[2]}})})},r.c([i.l],t.prototype,"list",void 0),t}(a),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.queryApiName="book",t}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"book"},enumerable:!0,configurable:!0}),t}(v),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.queryApiName="history",t}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"history"},enumerable:!0,configurable:!0}),t}(v),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actions={},t.queries={},t}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"map"},enumerable:!0,configurable:!0}),t.prototype.setSchema=function(t){e.prototype.setSchema.call(this,t),this.schemaFrom=this.schema.from;var n=t.actions,r=t.queries,i=t.keys;for(var o in this.entities.buildFieldTuid(this.keys=i),n){var s=n[o],a=s.name,u=this.entities.newAction(a,void 0);u.setSchema(s),this.actions[o]=u}for(var o in r){var c=r[o],l=(a=c.name,this.entities.newQuery(a,void 0));l.setSchema(c),this.queries[o]=l}},t.prototype.add=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.actions.add.submit(e)];case 2:return[2,t.sent()]}})})},t.prototype.del=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.actions.del.submit(e)];case 2:return[2,t.sent()]}})})},t.prototype.all=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadSchema()];case 1:return e.sent(),[4,this.queries.all.query({})];case 2:return[2,e.sent()]}})})},t.prototype.page=function(e,t,n){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.loadSchema()];case 1:return r.sent(),[4,this.queries.page.page(e,t,n)];case 2:return[2,r.sent()]}})})},t.prototype.query=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.loadSchema()];case 1:return t.sent(),[4,this.queries.query.query(e)];case 2:return[2,t.sent()]}})})},t.prototype.table=function(e){return r.b(this,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.query(e)];case 1:for(n in t=r.sent())return[2,t[n]];return[2]}})})},t.prototype.obj=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.table(e)];case 1:return(t=n.sent()).length>0?[2,t[0]]:[2]}})})},t.prototype.scalar=function(e){return r.b(this,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return[4,this.obj(e)];case 1:for(n in t=r.sent())return[2,t[n]];return[2]}})})},t}(a),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.queryApiName="pending",t}return r.d(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return"pending"},enumerable:!0,configurable:!0}),t}(v);function E(e){switch(e){case"tinyint":case"smallint":case"int":case"bigint":case"dec":return 0;case"char":case"text":return"";case"datetime":case"date":return"2000-1-1";case"time":return"0:00"}}var k=function(){function e(e,t,n){var r=this;this.tuids={},this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.loadIds=function(){for(var e in r.clearCacheTimer(),r.tuids){r.tuids[e].cacheIds()}},this.cUq=e,this.uqApi=t,this.appId=n}return e.prototype.tuid=function(e){return this.tuids[e.toLowerCase()]},e.prototype.action=function(e){return this.actions[e.toLowerCase()]},e.prototype.sheet=function(e){return this.sheets[e.toLowerCase()]},e.prototype.query=function(e){return this.queries[e.toLowerCase()]},e.prototype.book=function(e){return this.books[e.toLowerCase()]},e.prototype.map=function(e){return this.maps[e.toLowerCase()]},e.prototype.history=function(e){return this.histories[e.toLowerCase()]},e.prototype.pending=function(e){return this.pendings[e.toLowerCase()]},e.prototype.sheetFromTypeId=function(e){for(var t in this.sheets){var n=this.sheets[t];if(n.typeId===e)return n}},e.prototype.loadAccess=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return[4,this.uqApi.loadAccess()];case 1:return void 0===(e=t.sent())?[2]:(this.buildEntities(e),[2])}})})},e.prototype.loadEntities=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return[4,this.uqApi.loadEntities()];case 1:return e=t.sent(),this.buildEntities(e),[2]}})})},e.prototype.buildEntities=function(e){var t=e.access,n=e.tuids;this.buildTuids(n),this.buildAccess(t)},e.prototype.getTuid=function(e,t,n){var r=this.tuids[e];if(void 0!==r)return void 0===t?r:r.divs[t]},e.prototype.cacheTuids=function(e){this.clearCacheTimer(),this.cacheTimer=setTimeout(this.loadIds,e)},e.prototype.clearCacheTimer=function(){void 0!==this.cacheTimer&&(clearTimeout(this.cacheTimer),this.cacheTimer=void 0)},e.prototype.buildTuids=function(e){for(var t in e){(r=e[t]).name;var n=r.typeId;this.newTuid(t,n).sys=!0}for(var t in e){var r;(r=e[t]).name;this.getTuid(t).setSchema(r)}for(var t in this.tuids){this.tuids[t].buildFieldsTuid()}},e.prototype.buildAccess=function(e){for(var t in e){var n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}},e.prototype.newAction=function(e,t){var n=this.actions[e];return void 0!==n?n:(n=this.actions[e]=new d(this,e,t),this.actionArr.push(n),n)},e.prototype.newTuid=function(e,t){var n=this.tuids[e];return void 0!==n?n:(n=this.tuids[e]=new l(this,void 0,e,t),this.tuidArr.push(n),n)},e.prototype.newQuery=function(e,t){var n=this.queries[e];return void 0!==n?n:(n=this.queries[e]=new v(this,e,t),this.queryArr.push(n),n)},e.prototype.newBook=function(e,t){var n=this.books[e];return void 0!==n?n:(n=this.books[e]=new b(this,e,t),this.bookArr.push(n),n)},e.prototype.newMap=function(e,t){var n=this.maps[e];return void 0!==n?n:(n=this.maps[e]=new g(this,e,t),this.mapArr.push(n),n)},e.prototype.newHistory=function(e,t){var n=this.histories[e];if(void 0===n)return n=this.histories[e]=new y(this,e,t),this.historyArr.push(n),n},e.prototype.newPending=function(e,t){var n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new w(this,e,t),this.pendingArr.push(n),n},e.prototype.newSheet=function(e,t){var n=this.sheets[e];return void 0!==n?n:(n=this.sheets[e]=new f(this,e,t),this.sheetArr.push(n),n)},e.prototype.fromType=function(e,t){var n=t.split("|");t=n[0];var r=Number(n[1]);switch(t){case"uq":this.uqId=r;break;case"tuid":this.newTuid(e,r).sys=!1;break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r)}},e.prototype.fromObj=function(e,t){switch(t.$){case"sheet":this.buildSheet(e,t)}},e.prototype.buildSheet=function(e,t){var n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)},e.prototype.buildFieldTuid=function(e,t){if(void 0!==e){for(var n=0,r=e;n<r.length;n++){var i=(h=r[n]).tuid,o=h.arr,s=h.url;void 0!==i&&(h._tuid=this.getTuid(i,o,s))}for(var a=function(n){var r=n.owner;if(void 0===r)return"continue";var i=e.find(function(e){return e.name===r});if(void 0===i&&(void 0!==t&&(i=t.find(function(e){return e.name===r})),void 0===i))throw"owner field "+r+" is undefined";n._ownerField=i;var o=n.arr,s=n.url;if(n._tuid=u.getTuid(i._tuid.name,o,s),void 0===n._tuid)throw"owner field ${owner} is not tuid"},u=this,c=0,l=e;c<l.length;c++){var h;a(h=l[c])}}},e.prototype.buildArrFieldsTuid=function(e,t){if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n].fields;void 0!==i&&this.buildFieldTuid(i,t)}},e}();n.d(t,"b",function(){return E}),n.d(t,"a",function(){return k})},function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l});var r=n(0),i=n(1),o=n(32),s=function(){function e(e,t){if(this.form=e,this.row=t,void 0===t.type){var n=t.createControl;void 0===n&&(n=e.createControl),void 0===n&&(n=o.b),this.control=n(e,t)}}return e.prototype.isOk=function(){return void 0===this.control||this.control.isOk()},e.prototype.contains=function(e){var t=this.row.field;if(void 0!==t)return e===t.name;var n=this.row.group;return void 0!==n&&void 0!==n.find(function(t){return t.field.name===e})},Object.defineProperty(e.prototype,"hasError",{get:function(){return this.control.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filled",{get:function(){return this.control.filled},enumerable:!0,configurable:!0}),e.prototype.clear=function(){void 0!==this.control&&this.control.clear()},e.prototype.clearErrors=function(){void 0!==this.control&&this.control.clearErrors()},e.prototype.readValues=function(e){void 0!==this.control&&this.control.readValues(e)},e.prototype.setError=function(e,t){void 0!==this.control&&this.control.setError(e,t)},e.prototype.setInitValues=function(e){void 0!==this.control&&this.control.setInitValues(e)},e}(),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group"},this.row)},Object.defineProperty(t.prototype,"hasError",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filled",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(s),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e){return i.createElement("div",{key:e,className:"form-group row"},i.createElement("label",{className:"col-sm-2 col-form-label"},this.row.label),this.control.render())},t}(s);function c(e,t){return new u(e,t)}function l(e,t){return new a(e,t)}},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0);function i(e,t,n,i,o){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,e.fetch(t,n,i,o)];case 1:return r.sent(),[2]}})})}var o=function(){function e(e,t){this.path=e||"",this.showWaiting=t}return e.prototype.call=function(e,t,n){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,r.sent().callFetch(e,t,n)];case 2:return[2,r.sent()]}})})},e.prototype.get=function(e,t){return void 0===t&&(t=void 0),r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().get(this.path+e,t)];case 2:return[2,n.sent()]}})})},e.prototype.post=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().post(this.path+e,t)];case 2:return[2,n.sent()]}})})},e.prototype.put=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().put(this.path+e,t)];case 2:return[2,n.sent()]}})})},e.prototype.delete=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.getHttpChannel()];case 1:return[4,n.sent().delete(this.path+e,t)];case 2:return[2,n.sent()]}})})},e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=n(1),o=n(9),s=function(e){function t(t){var n=e.call(this,t)||this;return n.logoutClick=function(){o.c.showLogout(n.logout)},n.logout=function(){return r.b(n,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return"function"!==typeof(e=this.props.logout)?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[4,o.c.logout(void 0)];case 3:return t.sent(),[2]}})})},n.navChange=n.navChange.bind(n),n.state={hasBack:!1},n}return r.d(t,e),t.prototype.navChange=function(){this.setState({hasBack:o.c.level>1})},t.prototype.componentWillMount=function(){this.navChange()},t.prototype.componentWillUnmount=function(){},t.prototype.back=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,o.c.back()];case 1:return e.sent(),[2]}})})},t.prototype.openWindow=function(){window.open(document.location.href)},t.prototype.render=function(){var e,t,n,r,s=this.state.hasBack||self!=top,a=this.props,u=a.right,c=a.center,l=a.logout;if(void 0!==l&&self===top&&("boolean"===typeof l&&!0===l||"function"===typeof l)){var h=o.c.user;if(void 0!==h){var d=h.nick,p=h.name;n=i.createElement("div",{className:"d-flex align-items-center"},i.createElement("small",{className:"text-light"},d||p),i.createElement("a",{className:"dropdown-toggle btn btn-secondary btn-sm ml-2",role:"button",onClick:this.logoutClick},i.createElement("i",{className:"fa fa-sign-out"})))}}if(s)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-arrow-left"}));break;case"close":e=i.createElement("nav",{onClick:this.back},i.createElement("i",{className:"fa fa-close"}))}return self!=top&&(console.log(document.location.href),t=i.createElement("header",{onClick:this.openWindow})),(u||n)&&(r=i.createElement("aside",null,u," ",n)),i.createElement("header",{style:o.b},t,e,i.createElement("div",null,c),r)},t}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n.n(o),a=n(5),u=n(3),c=n(2),l=n(13),h=function(e){return s.a.createElement("div",{className:"px-3 py-2"},Object(l.a)(e))},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSubmit=function(){return r.b(t,void 0,void 0,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return e=this.vForm.getValues(),!0!==this.entity.isPaged?[3,3]:[4,this.entity.resetPage(30,e)];case 1:return n.sent(),[4,this.entity.loadPage()];case 2:return n.sent(),this.replacePage(this.pageResult),[3,5];case 3:return[4,this.entity.query(e)];case 4:t=n.sent(),this.replacePage(this.queryResult,t),n.label=5;case 5:return[2]}})})},t.again=function(){t.vForm.reset(),t.replacePage(t.view)},t.renderRow=function(e,n){return o.createElement(t.row,r.a({},e))},t.view=function(){return o.createElement(c.Page,{header:t.label},t.vForm.render("mx-3 my-2"),t.renderExtra())},t.pageResult=function(){var e=t.entity,n=(e.name,e.list),r=o.createElement("button",{className:"btn btn-outline-success",onClick:t.again},o.createElement(u.FA,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:t.label,right:r},o.createElement(u.List,{items:n,item:{render:t.renderRow}}))},t.queryResult=Object(a.a)(function(e){var n=o.createElement("button",{className:"btn btn-outline-success",onClick:t.again},o.createElement(u.FA,{name:"search"})," \u518d\u67e5\u8be2");return o.createElement(c.Page,{header:t.label,right:n},o.createElement("pre",null,JSON.stringify(e,void 0,"\t")))}),t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){var t,n,i;return r.e(this,function(r){return this.vForm=this.createForm(this.onSubmit,e),t=this.ui,n=t.row,i=t.queryRow,this.row=i||n||h,this.openPage(this.view),[2]})})},t.prototype.renderExtra=function(){},t}(i.b),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.PageItems.first(e)];case 1:return t.sent(),[2]}})})},t.renderRow=function(e,n){return o.createElement(t.row,r.a({},e))},t.clickRow=function(e){t.callOnSelected(e)},t.view=function(){var e=o.createElement(u.SearchBox,{className:"mx-1 w-100",initKey:"",onSearch:t.onSearch,placeholder:"\u641c\u7d22"+t.label});return o.createElement(c.Page,{header:e},o.createElement(u.List,{items:t.PageItems.items,item:{render:t.renderRow,onClick:t.clickRow},before:"\u641c\u7d22"+t.label+"\u8d44\u6599"}))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){var t,n,i;return r.e(this,function(r){switch(r.label){case 0:return t=this.ui,n=t.row,i=t.selectRow,this.row=i||n||h,this.PageItems=new f(this.entity),[4,this.onSearch(e)];case 1:return r.sent(),this.openPage(this.view),[2]}})})},t.prototype.callOnSelected=function(e){this.closePage(),this.returnCall(e)},t}(i.b),f=function(e){function t(t){var n=e.call(this)||this;return n.query=t,n}return r.d(t,e),t.prototype.load=function(){return r.b(this,void 0,Promise,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.query.loadSchema()];case 1:return n.sent(),!0!==this.query.isPaged?[3,3]:[4,this.query.page(this.param,this.pageStart,this.pageSize)];case 2:return e=n.sent(),[3,5];case 3:return[4,this.query.query(this.param)];case 4:t=n.sent(),e=t[this.query.returns[0].name],n.label=5;case 5:return[2,e]}})})},t.prototype.setPageStart=function(e){void 0===e&&(this.pageStart=0)},t}(c.PageItems),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(i.a),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VQueryMain)];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"VQueryMain",{get:function(){return this.ui&&this.ui.main||d},enumerable:!0,configurable:!0}),t}(m),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VQuerySelect,e)];case 1:return t.sent(),[2]}})})},Object.defineProperty(t.prototype,"VQuerySelect",{get:function(){return p},enumerable:!0,configurable:!0}),t}(m);n.d(t,"a",function(){return v}),n.d(t,"b",function(){return b})},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),i=n(1),o=n(5),s=n(4),a=n(41),u=n(21),c=n(9),l=n(16),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.overSize=!1,t.upload=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return this.resUploader?[4,this.resUploader.upload()]:[2];case 1:return null===(e=n.sent())?(this.overSize=!0,setTimeout(function(){return t.overSize=!1},3e3),[2]):(this.resId=e,this.isChanged=this.resId!=this.value,[2])}})})},t.page=Object(o.a)(function(e){var n,r=e.resolve,o=i.createElement("button",{className:"btn btn-sm btn-success",disabled:!t.isChanged,onClick:function(){return r(t.resId)}},"\u4fdd\u5b58");return!0===t.overSize&&(n=i.createElement("div",{className:"text-danger"},i.createElement("i",{className:"fa fa-times-circle"})," \u56fe\u7247\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc72M\uff0c\u65e0\u6cd5\u4e0a\u4f20")),i.createElement(l.a,{header:"\u66f4\u6539"+t.label,right:o},i.createElement("div",{className:"my-3 px-3 py-3 bg-white"},i.createElement("div",null,i.createElement("div",null,"\u4e0a\u4f20\u56fe\u7247\uff1a"),i.createElement("div",{className:"my-3"},i.createElement(a.a,{ref:function(e){return t.resUploader=e},multiple:!1,maxSize:2048})),i.createElement("div",null,i.createElement("button",{className:"btn btn-primary",onClick:t.upload},"\u4e0a\u4f20"))),n,i.createElement("div",{className:"small muted my-4"},"\u652f\u6301JPG\u3001GIF\u3001PNG\u683c\u5f0f\u56fe\u7247\uff0c\u4e0d\u8d85\u8fc72M\u3002"),i.createElement("div",{className:"d-flex"},i.createElement("div",{className:"w-12c h-12c mr-4",style:{border:"1px dotted gray",padding:"8px"}},i.createElement(u.a,{className:"w-100 h-100",src:t.resId})),i.createElement("div",null,i.createElement("div",{className:"small"},"\u56fe\u7247\u9884\u89c8"),i.createElement(u.a,{className:"w-4c h-4c mt-3",src:t.resId})))))}),t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(t){return this.resId=this.value,[2,new Promise(function(t,n){c.c.push(i.createElement(e.page,{resolve:t,reject:n}),function(){return n()})})]})})},r.c([s.l],t.prototype,"resId",void 0),r.c([s.l],t.prototype,"overSize",void 0),t}(n(24).a)},,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1);function i(){return r.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},r.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"}))}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=n(1),o=n(9),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.upload=function(){return r.b(t,void 0,Promise,function(){var e,t,n,i,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:for(void 0===(e=this.props.maxSize)||e<=0?e=1e11:e*=1024,t=o.c.resUrl+"upload",n=this.fileInput.files,i=new FormData,s=n.length,a=0;a<s;a++){if((u=n[a]).size>e)return[2,null];i.append("files[]",u,u.name)}r.label=1;case 1:return r.trys.push([1,4,,5]),c=new AbortController,[4,fetch(t,{method:"POST",body:i,signal:c.signal})];case 2:return[4,r.sent().json()];case 3:return[2,":"+r.sent().res.id];case 4:return l=r.sent(),console.error("%s %s",t,l),[3,5];case 5:return[2]}})})},t}return r.d(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.multiple,o=t.onFilesChange;return i.createElement("input",{className:n,ref:function(t){return e.fileInput=t},onChange:o,type:"file",name:"file",multiple:r})},t}(i.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),i=n(1),o=n(8),s=n.n(o),a=n(2),u=n(3),c=n(49),l=n(47),h=function(e){function t(t){var n=e.call(this,Object(a.resLang)(t&&t.res))||this;n.cImportUqs={},n.cUqCollection={},n.renderRow=function(e,t){var n=e.id,r=e.nick,o=e.name;return i.createElement(u.LMR,{className:"px-3 py-2",right:"id: "+n},i.createElement("div",null,r||o))},n.onRowClick=function(e){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return a.appInFrame.unit=e.id,[4,this.start()];case 1:return t.sent(),[2]}})})},n.selectUnitPage=function(){return i.createElement(a.Page,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},i.createElement(u.List,{items:n.appUnits,item:{render:n.renderRow,onClick:n.onRowClick}}))},a.nav.setSettings(t);var o=t.appName;if(void 0===o)throw'appName like "owner/app" must be defined in UI';var s=o.split("/");if(2!==s.length)throw"tonvaApp name must be / separated, owner/app";return n.appOwner=s[0],n.appName=s[1],void 0===t.uqs&&(t.uqs={}),n.ui=t,n.caption=n.res.caption||"Tonva",n}return r.d(t,e),t.prototype.startDebug=function(){return r.b(this,void 0,void 0,function(){var e,n;return r.e(this,function(r){switch(r.label){case 0:return e=this.appOwner+"/"+this.appName,n=new t({appName:e,uqs:{}}),!0,[4,n.start(!0)];case 1:return r.sent(),[2]}})})},t.prototype.loadUqs=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,o,s,u,c,l,h,d,p,f,m,v,b,y,g,w,E,k,C;return r.e(this,function(r){switch(r.label){case 0:return t=[],a.appInFrame.unit,n=e.id,i=e.uqs,this.id=n,o=[],s=[],[4,this.buildRoleAppUI()];case 1:for(u=r.sent(),this.ui=u,c=0,l=i;c<l.length;c++)h=l[c],d=h.id,p=h.uqOwner,f=h.uqName,m=h.access,v=p+"/"+f,b=u&&u.uqs&&u.uqs[v],y=this.newCUq(v,d,m,b||{}),this.cUqCollection[v]=y,o.push(y.loadSchema()),s.push(y.entities.uqApi.checkAccess());return[4,Promise.all(o)];case 2:for(g=r.sent(),Promise.all(s).then(function(e){for(var t=0,n=e;t<n.length;t++)n[t]}),w=0,E=g;w<E.length;w++)k=E[w],void 0===(C=k)||t.push(C);return 0===t.length?[2]:[2,t]}})})},t.prototype.buildRoleAppUI=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i,o;return r.e(this,function(r){switch(r.label){case 0:if(!this.ui)return[2,void 0];if(!(e=a.nav.hashParam))return[2,this.ui];if(t=this.ui.roles,!(n=t&&t[e]))return[2,this.ui];for(o in i={},this.ui)"roles"!==o&&(i[o]=this.ui[o]);return"function"!==typeof n?[3,2]:[4,n()];case 1:n=r.sent(),r.label=2;case 2:return s.a.merge(i,n),[2,i]}})})},t.prototype.getImportUq=function(e,t){var n=e+"/"+t,r=this.cImportUqs[n];if(void 0!==r)return r;this.ui&&this.ui.uqs&&this.ui.uqs[n];return this.cImportUqs[n]=r=this.getCUq(n),r},t.prototype.newCUq=function(e,t,n,r){var i=new(this.ui.CUq||c.a)(this,e,this.id,t,n,r);return Object.setPrototypeOf(i.x,this.x),i},Object.defineProperty(t.prototype,"cUqArr",{get:function(){var e=[];for(var t in this.cUqCollection)e.push(this.cUqCollection[t]);return e},enumerable:!0,configurable:!0}),t.prototype.getCUq=function(e){return this.cUqCollection[e]},Object.defineProperty(t.prototype,"VAppMain",{get:function(){return this.ui&&this.ui.main||d},enumerable:!0,configurable:!0}),t.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){var e,t,n,o,s,u,c,h;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,Object(a.loadAppUqs)(this.appOwner,this.appName)];case 1:return e=r.sent(),t=a.appInFrame.predefinedUnit,n=e.id,this.id=n,void 0!==(o=a.nav.user)&&o.id>0?(s=this,[4,l.a.userAppUnits(this.id)]):[3,3];case 2:switch(s.appUnits=r.sent(),this.appUnits.length){case 0:return this.showUnsupport(t),[2,!1];case 1:if(void 0===(u=this.appUnits[0].id)||u<0||void 0!==t&&u!=t)return this.showUnsupport(t),[2,!1];a.appInFrame.unit=u;break;default:if(t>0&&void 0!==this.appUnits.find(function(e){return e.id===t})){a.appInFrame.unit=t;break}return a.nav.push(i.createElement(this.selectUnitPage,null)),[2,!1]}r.label=3;case 3:return[4,this.loadUqs(e)];case 4:return void 0!==(c=r.sent())?(this.openPage(i.createElement(a.Page,{header:"ERROR"},i.createElement("div",{className:"m-3"},i.createElement("div",null,"Load Uqs \u53d1\u751f\u9519\u8bef\uff1a"),c.map(function(e,t){return i.createElement("div",{key:t},e)})))),[2,!1]):[2,!0];case 5:return h=r.sent(),a.nav.push(i.createElement(a.Page,{header:"App start error!"},i.createElement("pre",null,"string"===typeof h?h:h.message))),[2,!1];case 6:return[2]}})})},t.prototype.internalStart=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return!0!==e&&this.clearPrevPages(),[4,this.showMainPage()];case 1:return t.sent(),[2]}})})},t.prototype.render=function(){return this.renderView(this.VAppMain)},t.prototype.clearPrevPages=function(){a.nav.clear()},t.prototype.showUnsupport=function(e){this.clearPrevPages();var t=a.nav.user,n=t?t.name:"[\u672a\u767b\u5f55]";this.openPage(i.createElement(a.Page,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},i.createElement("div",{className:"m-3 text-danger container"},i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"\u767b\u5f55\u7528\u6237: "),i.createElement("div",{className:"col"},n)),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"App:"),i.createElement("div",{className:"col"},this.appOwner+"/"+this.appName)),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},"\u9884\u8bbe\u5c0f\u53f7:"),i.createElement("div",{className:"col"},e||i.createElement("small",{className:"text-muted"},"[\u65e0\u9884\u8bbe\u5c0f\u53f7]"))),i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"},i.createElement(u.FA,{name:"exclamation-triangle"})),i.createElement("div",{className:"col"},i.createElement("div",{className:"text-muted"},"\u65e0\u6cd5\u8fd0\u884c\u53ef\u80fd\u539f\u56e0\uff1a"),i.createElement("ul",{className:"p-0"},i.createElement("li",null,"\u6ca1\u6709\u5c0f\u53f7\u8fd0\u884c ",this.ui.appName),i.createElement("li",null,"\u7528\u6237 ",i.createElement("b",null,n)," \u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u4e00\u4e2a\u8fd0\u884c",this.ui.appName,"\u7684\u5c0f\u53f7"),e&&i.createElement("li",null,"\u9884\u8bbe\u5c0f\u53f7 ",i.createElement("b",null,e)," \u6ca1\u6709\u8fd0\u884cApp ",this.ui.appName)))),e||i.createElement("div",{className:"form-group row"},i.createElement("div",{className:"col-2"}),i.createElement("div",{className:"col"},"\u9884\u8bbe\u5c0f\u53f7\u5b9a\u4e49\u5728 public/unit.json \u6587\u4ef6\u4e2d\u3002 \u5b9a\u4e49\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u7531url\u76f4\u63a5\u542f\u52a8\u3002 \u7528\u6237\u7b2c\u4e00\u6b21\u8bbf\u95eeapp\u4e4b\u540e\uff0c\u4f1a\u7f13\u5b58\u5728localStorage\u91cc\u3002",i.createElement("br",null),"\u5982\u679c\u8981\u5220\u53bb\u7f13\u5b58\u7684\u9884\u5b9a\u4e49Unit\uff0clogout\u7136\u540e\u518dlogin\u3002")))))},t.prototype.showMainPage=function(){return r.b(this,void 0,void 0,function(){var e,t,n,i,o,s,u;return r.e(this,function(r){switch(r.label){case 0:return void 0===(e=Object(a.getExHash)())?[3,2]:(t=e.split("-")).length>3?"sheet"!==(n=t[3])&&"sheet_debug"!==n?[3,2]:(i=Number(t[4]),o=Number(t[5]),s=Number(t[6]),void 0===(u=this.getCUqFromId(i))?(alert("unknown uqId: "+i),[2]):(this.clearPrevPages(),[4,u.navSheet(o,s)])):[3,2];case 1:return r.sent(),[2];case 2:return this.openVPage(this.VAppMain),[2]}})})},t.prototype.getCUqFromId=function(e){for(var t in this.cUqCollection){var n=this.cUqCollection[t];if(n.id===e)return n}},t}(a.Controller),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.appPage=function(){var e=t.controller.caption;return i.createElement(a.Page,{header:e,logout:function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return a.appInFrame.unit=void 0,[2]})})}},t.appContent())},t.appContent=function(){var e,n=t.controller.cUqArr;return e=0===n.length?i.createElement("div",{className:"text-danger"},i.createElement(u.FA,{name:""})," \u6b64APP\u6ca1\u6709\u7ed1\u5b9a\u4efb\u4f55\u7684UQ"):n.map(function(e,t){return i.createElement("div",{key:t},e.render())}),i.createElement(i.Fragment,null,e)},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.openPage(this.appPage),[2]})})},t.prototype.render=function(e){return this.appContent()},t}(a.VPage)},function(e,t,n){"use strict";var r=n(68);n.o(r,"EasyDate")&&n.d(t,"EasyDate",function(){return r.EasyDate}),n.o(r,"FA")&&n.d(t,"FA",function(){return r.FA}),n.o(r,"LMR")&&n.d(t,"LMR",function(){return r.LMR}),n.o(r,"List")&&n.d(t,"List",function(){return r.List}),n.o(r,"Muted")&&n.d(t,"Muted",function(){return r.Muted}),n.o(r,"PropGrid")&&n.d(t,"PropGrid",function(){return r.PropGrid}),n.o(r,"SearchBox")&&n.d(t,"SearchBox",function(){return r.SearchBox}),n.o(r,"TonvaForm")&&n.d(t,"TonvaForm",function(){return r.TonvaForm});var i=n(69);n.o(i,"EasyDate")&&n.d(t,"EasyDate",function(){return i.EasyDate}),n.o(i,"FA")&&n.d(t,"FA",function(){return i.FA}),n.o(i,"LMR")&&n.d(t,"LMR",function(){return i.LMR}),n.o(i,"List")&&n.d(t,"List",function(){return i.List}),n.o(i,"Muted")&&n.d(t,"Muted",function(){return i.Muted}),n.o(i,"PropGrid")&&n.d(t,"PropGrid",function(){return i.PropGrid}),n.o(i,"SearchBox")&&n.d(t,"SearchBox",function(){return i.SearchBox}),n.o(i,"TonvaForm")&&n.d(t,"TonvaForm",function(){return i.TonvaForm});var o=n(70);n.o(o,"EasyDate")&&n.d(t,"EasyDate",function(){return o.EasyDate}),n.o(o,"FA")&&n.d(t,"FA",function(){return o.FA}),n.o(o,"LMR")&&n.d(t,"LMR",function(){return o.LMR}),n.o(o,"List")&&n.d(t,"List",function(){return o.List}),n.o(o,"Muted")&&n.d(t,"Muted",function(){return o.Muted}),n.o(o,"PropGrid")&&n.d(t,"PropGrid",function(){return o.PropGrid}),n.o(o,"SearchBox")&&n.d(t,"SearchBox",function(){return o.SearchBox}),n.o(o,"TonvaForm")&&n.d(t,"TonvaForm",function(){return o.TonvaForm});n(34),n(44);var s=n(71);n.d(t,"TonvaForm",function(){return s.a});n(32)},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),i=n(1),o=n(4),s=n(20),a=n(32),u=n(34),c=function(){function e(e){this.rows=[],this.uid=Object(s.a)(),this.props=e,this.buildRows(e),this.createControl=e.createControl,this.onSubmit=this.onSubmit.bind(this)}return Object.defineProperty(e.prototype,"hasError",{get:function(){var e=this.rows.map(function(e,t){return t+": "+e.hasError+"\n"});return console.log(e),this.rows.some(function(e){return e.hasError})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nothing",{get:function(){return this.rows.every(function(e){return!e.filled})},enumerable:!0,configurable:!0}),e.prototype.readValues=function(){for(var e={},t=0,n=this.rows;t<n.length;t++){n[t].readValues(e)}return e},e.prototype.clear=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clear()}},e.prototype.clearErrors=function(){for(var e=0,t=this.rows;e<t.length;e++){t[e].clearErrors()}},e.prototype.setError=function(e,t){for(var n=0,r=this.rows;n<r.length;n++){r[n].setError(e,t)}},e.prototype.setInitValues=function(e){if(void 0!==e)for(var t=0,n=this.rows;t<n.length;t++){n[t].setInitValues(e)}},e.prototype.buildRows=function(e){var t=e.formRows,n=e.createRow;if(void 0!==t){for(var r=0,o=t;r<o.length;r++){var s=o[r];this.rows.push(this.buildRow(s,n))}!0!==this.props.readOnly&&(this.buttonsRow=this.buildRow({createControl:this.createButtons.bind(this)},void 0))}else this.rows.push(Object(u.b)(this,i.createElement("div",{className:"text-warning"},"TonvaForm need formRows defined")))},e.prototype.buildRow=function(e,t){var n;return void 0!==e.type?n=u.b:void 0===(n=e.createRow)&&void 0===(n=t)&&(n=u.a),n(this,e)},e.prototype.createButtons=function(e,t){return new a.a(e)},e.prototype.isOk=function(){for(var e=!0,t=0,n=this.rows;t<n.length;t++){n[t].isOk()||(e=!1)}return e},e.prototype.render=function(){var e=this;return i.createElement("form",{onSubmit:this.onSubmit},this.rows.map(function(t,n){return t.render(e.uid+n)}),this.buttons())},e.prototype.buttons=function(){if(void 0!==this.buttonsRow)return this.buttonsRow.render(this.uid+this.rows.length)},e.prototype.onSubmit=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return e.preventDefault(),this.isOk()?(t=this.readValues(),[4,this.props.onSubmit(t)]):[2];case 1:return n.sent(),[2]}})})},r.c([o.e],e.prototype,"hasError",null),r.c([o.e],e.prototype,"nothing",null),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),i=n.n(r),o=n(3);function s(e,t){return i.a.createElement(o.FA,{className:e,name:t,fixWidth:!0})}var a={tuid:s("text-info","list-alt"),action:s("text-info","hand-o-right"),map:s("text-muted","list-ul"),book:s("text-muted","book"),query:s("text-warning","search"),history:s("text-info","hand-o-right"),pending:s("text-info","forward"),sheet:s("text-primary","wpforms")}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),i=function(e){function t(t,n){var r=e.call(this,n)||this;return r.cUq=t,r}return r.d(t,e),t}(n(2).Controller)},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.userAppUnits=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("tie/user-app-units",{app:e})];case 1:return[2,t.sent()]}})})},t}(n(2).CenterApi))("tv/",void 0)},function(e,t,n){"use strict";var r=n(0),i=n(4),o=n(2),s=n(7),a=n(1),u=n.n(a),c=n(5),l=n(3),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.newClick=function(){return t.event("new")},t.schemaClick=function(){return t.event("schema")},t.archivesClick=function(){return t.event("archives")},t.sheetStateClick=function(e){return t.event("state",e)},t.renderState=function(e,n){var r=e.state,i=e.count;if(0===i)return null;var o=a.createElement("span",{className:"badge badge-success ml-5 align-self-end"},i);return a.createElement(l.LMR,{className:"px-3 py-2",left:t.controller.getStateLabel(r),right:o})},t.view=Object(c.a)(function(){var e,n=t.controller.statesCount.filter(function(e){return e.count}),r=a.createElement("button",{className:"btn btn-outline-primary",onClick:t.archivesClick},"\u5df2\u5f52\u6863");return!0===t.isDev&&(e=a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:t.schemaClick},"\u6a21\u677f")),a.createElement(o.Page,{header:t.label},a.createElement(l.LMR,{className:"mx-3 my-2",right:r},a.createElement("button",{className:"btn btn-primary mr-2",color:"primary",onClick:t.newClick},"\u65b0\u5efa"),e),a.createElement(l.List,{className:"my-2",header:a.createElement(l.Muted,{className:"mx-3 my-1"},"\u5f85\u5904\u7406",t.label),none:"[ \u65e0 ]",items:n,item:{render:t.renderState,onClick:t.sheetStateClick}}))}),t}return r.d(t,e),t.prototype.open=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t}(s.b),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSubmit=function(){return r.b(t,void 0,Promise,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return e=this.vForm.getValues(),t=this.vForm.values,[4,this.controller.onSave(e,t)];case 1:return n.sent(),[2]}})})},t.view=function(){return a.createElement(o.Page,{header:t.label},t.vForm.render())},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.view),[2]})})},t}(s.b),p=n(28),f={width:"8rem"},m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.flowRow=function(e,t){var n,r=e.date,i=(e.user,e.preState,e.state),o=e.action;switch(void 0===o&&(o=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-primary",name:"pencil-square-o"})," \u5236\u5355")),i){case"$":break;case"#":n=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-success",name:"file-archive-o"}));break;default:n=a.createElement(a.Fragment,null,a.createElement(l.FA,{className:"text-muted",name:"arrow-right"})," \xa0 ",i)}return a.createElement(l.LMR,{left:a.createElement("div",{className:"pl-3 py-2",style:f},o),right:a.createElement("div",{className:"p-2"},a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:r})))},a.createElement("div",{className:"p-2"},n))},t.sheetView=function(){var e,n=t.sheetData,r=n.brief,i=n.flows;return"-"===r.state&&(e=a.createElement("div",{className:"mx-3 my-2",style:{color:"red"}},"\u672c\u5355\u636e\u4f5c\u5e9f")),a.createElement("div",null,e,t.vForm.render(),a.createElement(l.List,{header:a.createElement(l.Muted,{className:"mx-3 my-1"},"\u6d41\u7a0b"),items:i,item:{render:t.flowRow}}))},t}return r.d(t,e),t}(s.b),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSubmit=function(){return r.b(t,void 0,Promise,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return e=this.vForm.getValues(),[4,this.controller.saveSheet(e,this.vForm.values)];case 1:return t.sent(),this.closePage(),this.returnCall(this.vForm.values),[2]}})})},t.view=function(){return a.createElement(o.Page,{header:t.label},t.vForm.render())},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.sheetData=e,this.vForm=this.createForm(this.onSubmit,e.data,p.a.edit),this.openPage(this.view),[2]})})},t}(m),b=n(6),y=n.n(b),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionClick=function(e){return r.b(t,void 0,void 0,function(){var t,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return t=this.sheetData.brief,n=t.id,i=t.flow,o=t.state,[4,this.controller.action(n,i,o,e.name)];case 1:return r.sent(),this.ceasePage(),this.openPage(this.acted),[2]}})})},t.deleteClick=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return alert("\u5355\u636e\u4f5c\u5e9f\uff1a\u7a0b\u5e8f\u6b63\u5728\u8bbe\u8ba1\u4e2d"),[2]})})},t.editClick=function(){return r.b(t,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return[4,this.controller.editSheet(this.sheetData)];case 1:return e=t.sent(),this.vForm.setValues(e),[2]}})})},t.page=function(){var e,n,r=t.sheetData.brief,i=r.state,s=r.no,a=t.controller.getStateLabel(i),c=t.entity.states.find(function(e){return e.name===i});if(void 0===c){var l=void 0,h=void 0;switch(i){default:l="\u4e0d\u8ba4\u8bc6\u7684\u5355\u636e\u72b6\u6001'"+i+"'",h="text-info";break;case"-":l="\u5df2\u4f5c\u5e9f",h="text-danger";break;case"#":l="\u5df2\u5f52\u6863",h="text-success"}e=u.a.createElement("div",{className:y()(h)},"[",l,"]")}else e=u.a.createElement("div",{className:"flex-grow-1"},c.actions.map(function(e,n){return u.a.createElement("button",{key:n,className:"btn btn-primary mr-2",onClick:function(){return t.actionClick(e)}},t.controller.getActionLabel(i,e.name))})),"$"===i&&(n=u.a.createElement("div",null,u.a.createElement("button",{className:"btn btn-outline-info ml-2",onClick:t.editClick},"\u4fee\u6539"),u.a.createElement("button",{className:"btn btn-outline-danger ml-2",onClick:t.deleteClick},"\u4f5c\u5e9f")));return u.a.createElement(o.Page,{header:t.label+":"+a+"-"+s},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},e,n),u.a.createElement(t.sheetView,null)))},t.acted=function(){var e=t.sheetData.brief.discription;return u.a.createElement(o.Page,{header:"\u5df2\u5904\u7406",back:"close"},u.a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},u.a.createElement("div",{className:"p-3"},e),u.a.createElement("div",{className:"text-success"},u.a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),u.a.createElement("div",{className:"p-3"},u.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return t.backPage()}},"\u8fd4\u56de"))))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page),[2]})})},t}(m),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){return a.createElement(o.Page,{header:t.label+"\u6a21\u677f"},a.createElement("pre",{className:"mx-3 my-2"},t.entity.schemaStringify()))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t}(s.b),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.archiveClick=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){return 1===e.processing?[2]:(this.event("archived",e),[2])})})},t.archiveRow=function(e,t){e.id,e.no,e.discription;var n=e.date,r=a.createElement(a.Fragment,null,1===e.processing?"... ":"",e.no," \xa0 ",e.discription),i=a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:n}));return a.createElement(l.LMR,{className:"px-3 py-2",left:r,right:i})},t.view=function(){return a.createElement(o.Page,{header:"\u5df2\u5f52\u6863"+t.label},a.createElement(l.List,{items:t.list,item:{render:t.archiveRow,onClick:t.archiveClick}}))},t}return r.d(t,e),t.prototype.open=function(){return r.b(this,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return e=this,[4,this.entity.getArchives(void 0,10)];case 1:return e.list=t.sent(),this.openPage(this.view),[2]}})})},t}(s.b),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rowClick=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){return 1===e.processing?(this.event("processing",e.id),[2]):(this.event("action",e.id),[2])})})},t.onScrollBottom=function(){console.log("onScrollBottom"),t.controller.pageStateItems.more()},t.rowContent=function(e){e.id;var t=e.no,n=e.discription,r=e.date,i=e.processing,o=a.createElement(a.Fragment,null,t," \xa0 ",a.createElement(l.Muted,null,n)," ",1===i?"...":""),s=a.createElement(l.Muted,null,a.createElement(l.EasyDate,{date:r}));return a.createElement(l.LMR,{className:"px-3 py-2",left:o,right:s})},t.renderRow=function(e,n){return a.createElement(t.row,r.a({},e))},t.view=function(){var e=t.controller.pageStateItems;return a.createElement(o.Page,{header:t.label+" - "+t.stateLabel,onScrollBottom:t.onScrollBottom},a.createElement(l.List,{items:e,item:{render:t.renderRow,onClick:t.rowClick}}))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this.row=this.ui.listRow||this.rowContent,this.stateName=e.state,this.stateLabel=this.controller.getStateLabel(this.stateName),[4,this.controller.pageStateItems.first(this.stateName)];case 1:return t.sent(),this.openPage(this.view),[2]}})})},t}(s.b),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){var e=t.sheetData.brief;return a.createElement(o.Page,{header:t.label+":-"+e.no},a.createElement(t.sheetView,null))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.sheetData=e,this.vForm=this.createForm(void 0,this.sheetData.data),this.openPage(this.view),[2]})})},t}(m),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.restart=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return this.ceasePage(),[4,this.event("new")];case 1:return e.sent(),[2]}})})},t.actionClick=function(e){return r.b(t,void 0,void 0,function(){var t,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return this.ceasePage(),t=this.brief,n=t.id,i=t.flow,o=t.state,[4,this.controller.action(n,i,o,e.name)];case 1:return r.sent(),this.openPage(this.acted),[2]}})})},t.buttons=a.createElement(a.Fragment,null,a.createElement("button",{className:"btn btn-outline-primary mr-3",onClick:t.restart},"\u7ee7\u7eed\u5f00\u5355"),a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return t.backPage()}},"\u8fd4\u56de")),t.view=function(){var e=t.entity.states,n=e.find(function(e){return"$"===e.name}),r=a.createElement(a.Fragment,null,n.actions.map(function(e,n){return a.createElement("button",{key:n,className:"btn btn-primary mr-3",onClick:function(){return t.actionClick(e)}},t.controller.getActionLabel("$",e.name))}));return a.createElement(o.Page,{header:"\u5df2\u4fdd\u5b58",back:"close"},a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u4fdd\u5b58\uff01\u7cfb\u7edf\u5c1a\u672a\u5904\u7406"),a.createElement("div",{className:"p-3"},r,t.buttons)))},t.acted=function(){return a.createElement(o.Page,null,a.createElement("div",{className:"p-3 d-flex flex-column align-items-center"},a.createElement("div",{className:"text-success"},a.createElement(l.FA,{name:"check-circle-o"})," \u5355\u636e\u5df2\u5904\u7406\uff01"),a.createElement("div",{className:"p-3"},t.buttons)))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.brief=e,this.openPage(this.view),[2]})})},t}(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t}(s.b)),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.page=function(){var e=t.sheetData.brief,n=e.state,r=e.no,i=t.controller.getStateLabel(n);return u.a.createElement(o.Page,{header:t.label+":"+i+"-"+r},u.a.createElement("div",{className:"mb-2"},u.a.createElement("div",{className:"d-flex px-3 py-2 border-bottom bg-light"},"\u6b63\u5728\u5904\u7406\u4e2d..."),u.a.createElement(t.sheetView,null)))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return this.sheetData=e,this.vForm=this.createForm(void 0,e.data),this.openPage(this.page),[2]})})},t}(m),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.statesCount=i.l.array([],{deep:!0}),t.onSave=function(e,n){return r.b(t,void 0,Promise,function(){var t;return r.e(this,function(r){switch(r.label){case 0:return[4,this.saveSheet(e,n)];case 1:return t=r.sent(),this.ceasePage(),[4,this.showSaved(t)];case 2:return r.sent(),[2]}})})},t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.loadStateSheetCount()];case 1:return e.sent(),this.pageStateItems=this.entity.createPageStateItems(),[4,this.openVPage(this.VSheetMain)];case 2:return e.sent(),[2]}})})},t.prototype.onMessage=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,o;return r.e(this,function(r){return t=e.type,n=e.body,i=e.from,o=e.to,e.push,"sheet"===t&&this.onSheet(i,o,n),[2]})})},t.prototype.onSheet=function(e,t,n){var r=this.user.id,i=n.id,o=n.preState,s=n.state;console.log({$:"onMessage sheet",from:e,to:t.join(","),id:i,preState:o,state:s,me:r,sheetData:n}),e===r&&this.sheetActPreState(i,o),void 0!==t.find(function(e){return e===r})&&this.sheetActState(i,s,n)},t.prototype.sheetActPreState=function(e,t){if(this.changeStateCount(t,-1),void 0!==this.curState&&this.curState===t){var n=this.pageStateItems.items.findIndex(function(t){return t.id===e});n>=0&&this.pageStateItems.items.splice(n,1)}},t.prototype.sheetActState=function(e,t,n){this.changeStateCount(t,1),void 0!==this.curState&&this.curState===t&&this.pageStateItems.items.findIndex(function(t){return t.id===e})<0&&this.pageStateItems.items.push(n)},t.prototype.changeStateCount=function(e,t){if(void 0!==e){var n=this.statesCount.findIndex(function(t){return t.state===e});if(console.log({$:"changeState",state:e,delta:t,index:n}),!(n<0)){var r=this.statesCount[n];r.count+=t,r.count<0&&(r.count=0)}}},Object.defineProperty(t.prototype,"VSheetMain",{get:function(){return this.ui&&this.ui.main||h},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetNew",{get:function(){return this.ui.sheetNew||d},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetSaved",{get:function(){return this.ui.sheetSaved||N},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetEdit",{get:function(){return this.ui.sheetEdit||v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetSchema",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VArchives",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VArchived",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetList",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetAction",{get:function(){return this.ui.sheetAction||g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VSheetProcessing",{get:function(){return P},enumerable:!0,configurable:!0}),t.prototype.onEvent=function(e,t){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:switch(e){case"new":return[3,2];case"schema":return[3,3];case"archives":return[3,4];case"state":return[3,5];case"archived":return[3,6];case"action":return[3,8];case"processing":return[3,10]}return[3,1];case 1:return[2];case 2:return n=this.VSheetNew,[3,12];case 3:return n=this.VSheetSchema,[3,12];case 4:return n=this.VArchives,[3,12];case 5:return this.curState=t.state,n=this.VSheetList,[3,12];case 6:return[4,this.showArchived(t)];case 7:return r.sent(),[2];case 8:return[4,this.showAction(t)];case 9:return r.sent(),[2];case 10:return[4,this.showProcessing(t)];case 11:return r.sent(),[2];case 12:return[4,this.openVPage(n,t)];case 13:return r.sent(),[2]}})})},t.prototype.startSheet=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.beforeStart()];case 1:return!1===t.sent()?[2]:[4,this.onEvent("action",e)];case 2:return t.sent(),[2]}})})},t.prototype.showAction=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(e)];case 1:return t=n.sent(),Object(o.postWsToTop)({body:{$type:"msg",action:"$sheet",msg:{id:e,uq:this.cUq.id,state:t.brief.state}}}),[4,this.openVPage(this.VSheetAction,t)];case 2:return n.sent(),[2]}})})},t.prototype.showProcessing=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getSheetData(e)];case 1:return t=n.sent(),[4,this.openVPage(this.VSheetProcessing,t)];case 2:return n.sent(),[2]}})})},t.prototype.editSheet=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.vCall(this.VSheetEdit,e)];case 1:return[2,t.sent()]}})})},t.prototype.showArchived=function(e){return r.b(this,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return[4,this.getArchived(e.id)];case 1:return t=n.sent(),[4,this.openVPage(this.VArchived,t)];case 2:return n.sent(),[2]}})})},t.prototype.showSaved=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.openVPage(this.VSheetSaved,e)];case 1:return t.sent(),[2]}})})},t.prototype.getStateUI=function(e){var t=this.res.states;if(void 0!==t)return t[e]},t.prototype.getStateLabel=function(e){var t=this.getStateUI(e),n=t&&t.label||e;switch(n){default:return n;case"$":return"\u65b0\u5355"}},t.prototype.getActionLabel=function(e,t){var n=this.getStateUI(e);if(void 0===n)return t;var r=n.actions;if(void 0===r)return t;var i=r[t];return i&&i.label||t},t.prototype.loadStateSheetCount=function(){return r.b(this,void 0,Promise,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return this.statesCount.clear(),[4,this.entity.stateSheetCount()];case 1:return t=n.sent(),(e=this.statesCount).splice.apply(e,[0,0].concat(t)),[2]}})})},t.prototype.getSheetData=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.getSheet(e)];case 1:return[2,t.sent()]}})})},t.prototype.getArchived=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.entity.getArchive(e)];case 1:return[2,t.sent()]}})})},t.prototype.saveSheet=function(e,t){return r.b(this,void 0,Promise,function(){var n,i;return r.e(this,function(r){switch(r.label){case 0:return n=this.ui.sheetTitle,i=void 0===n?this.label:n(t,this.x),[4,this.entity.save(i,e)];case 1:return[2,r.sent()]}})})},t.prototype.action=function(e,t,n,i){return r.b(this,void 0,Promise,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.entity.action(e,t,n,i)];case 1:return[2,r.sent()]}})})},t}(s.a);n.d(t,"a",function(){return S})},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(33),s=n(18),a=n(7),u=n(1),c=n.n(u),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){return u.createElement(i.Page,{header:t.label},"Book")},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t}(a.b),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VBookMain)];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"VBookMain",{get:function(){return l},enumerable:!0,configurable:!0}),t}(a.a),d=n(48),p=n(53),f=n(37),m=n(26),v=n(50),b=n(12),y=n(3),g=function(e){function t(t){var n=e.call(this,t)||this;n.isSysVisible=!1,n.view=function(){var e,t=n.controller,r=t.res,i=t.uq,o=t.error,s={render:function(e,t){return e.render()},onClick:void 0},a=[{header:r.tuid||"TUID",items:n.tuidLinks},{cn:"my-2",header:r.map||"MAP",items:n.mapLinks},{cn:"my-2",header:r.sheet||"SHEET",items:n.sheetLinks},{cn:"my-2",header:r.action||"ACTION",items:n.actionLinks},{cn:"my-2",header:r.query||"QUERY",items:n.queryLinks},{cn:"mt-2 mb-4",header:r.book||"BOOK",items:n.bookLinks},{cn:"mt-2 mb-4",header:r.history||"HISTORY",items:n.historyLinks},{cn:"mt-2 mb-4",header:r.pending||"PENDING",items:n.pendingLinks}];return e=void 0!==o?c.a.createElement("div",{className:"p-3 text-danger"},"\u8fde\u63a5\u9519\u8bef: ",o):a.map(function(e,t){var n=e.cn,r=e.header,i=e.items;return i.length>0&&c.a.createElement(y.List,{key:t,className:n,header:c.a.createElement("div",{className:"px-3 py-1 bg-light"},c.a.createElement(y.Muted,null,r)),items:i,item:s})}),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"px-3 py-1 small"},r.uq||i),e)};var r=t.entities,i=r.tuidArr,o=r.mapArr,a=r.sheetArr,u=r.actionArr,l=r.queryArr,h=r.bookArr,d=r.historyArr,p=r.pendingArr;return n.tuidLinks=i.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cTuidMain(e))}),n.mapLinks=o.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cMap(e))}),n.sheetLinks=a.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cSheet(e))}),n.actionLinks=u.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cAction(e))}),n.queryLinks=l.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cQuery(e))}),n.bookLinks=h.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cBook(e))}),n.historyLinks=d.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cHistory(e))}),n.pendingLinks=p.filter(function(e){return n.isVisible(e)}).map(function(e){return new s.a(n.controller.cPending(e))}),n}return r.d(t,e),t.prototype.isVisible=function(e){return!0!==e.sys||this.isSysVisible},t.prototype.render=function(e){return void 0===this.view?c.a.createElement("div",null,"??? viewModel \u5fc5\u987b\u5b9a\u4e49 view ???"):c.a.createElement(this.view)},t}(i.View),w=n(52),E=n(51);function k(e){if(void 0!==e)for(var t in e)e[t.toLowerCase()]=e[t]}var C=function(e){function t(t,n,r,s,a,u){var c=e.call(this,Object(i.resLang)(u.res))||this;c.schemaLoaded=!1,c.isSysVisible=!1,c.cApp=t,c.uq=n,c.id=s,k(u.tuid),k(u.sheet),k(u.map),k(u.query),k(u.action),k(u.book),k(u.history),k(u.pending),c.ui=u,c.CTuidMain=u.CTuidMain||m.d,c.CTuidEdit=u.CTuidEdit||m.a,c.CTuidList=u.CTuidList||m.c,c.CTuidSelect=u.CTuidSelect||m.e,c.CTuidInfo=u.CTuidInfo||m.b,c.CQuery=u.CQuery||f.a,c.CQuerySelect=u.CQuerySelect||f.b,c.CMap=u.CMap||v.a,c.CAction=u.CAction||p.a,c.CSheet=u.CSheet||d.a,c.CBook=u.CBook||h,c.CHistory=u.CHistory||w.a,c.CPending=u.CPending||E.a;var l,b,y=n.split("/");switch(y.length){case 1:l="$$$",b=y[0];break;case 2:l=y[0],b=y[1];break;default:return void console.log("uq must be uqOwner/uqName format")}var g,C,N=document.location.hash,P=void 0===N||""===N?"debug/":"tv/";return g=null===a||void 0===a||"*"===a?[]:a.split(";").map(function(e){return e.trim()}).filter(function(e){return e.length>0}),C="$$$/$unitx"===n?new i.UnitxApi(i.appInFrame.unit):new i.UqApi(P,l,b,g,!0),c.entities=new o.a(c,C,r),c}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return[2]})})},t.prototype.loadEntites=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.entities.loadAccess()];case 1:return e.sent(),[2]}})})},t.prototype.loadSchema=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),!0===this.schemaLoaded?[2]:[4,this.loadEntites()];case 1:for(e in r.sent(),void 0===this.id&&(this.id=this.entities.uqId),this.ui)if(void 0!==(t=this.ui[e])&&(t.caption,void 0!==(n=t.collection)))for(i in n)void 0===this.entities[e](i)&&console.warn(e+":'"+i+"' is not uq entity");return this.schemaLoaded=!0,[2];case 2:return o=r.sent(),console.error(o),[2,this.error=o];case 3:return[2]}})})},t.prototype.getQuerySearch=function(e){return r.b(this,void 0,Promise,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return void 0!==(t=this.entities.query(e))?[3,1]:(alert("QUERY "+e+" \u6ca1\u6709\u5b9a\u4e49!"),[3,3]);case 1:return[4,t.loadSchema()];case 2:n.sent(),t.returns.length>1&&alert("QUERY "+e+" \u8fd4\u56de\u591a\u5f20\u8868, \u65e0\u6cd5\u505aQuerySearch"),n.label=3;case 3:return[2,t]}})})},t.prototype.getTuidPlaceHolder=function(e){var t=this.res,n=t.tuidPlaceHolder,r=t.entity,i=e.name;if(void 0!==r){var o=r[i];void 0!==o&&o.label}return n||"Select"},t.prototype.getNone=function(){return this.res.none||"none"},t.prototype.isVisible=function(e){return!0!==e.sys||this.isSysVisible},t.prototype.navSheet=function(e,t){return r.b(this,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return void 0===(n=this.entities.sheetFromTypeId(e))?(alert("sheetTypeId "+e+" is not exists!"),[2]):[4,this.cSheet(n).startSheet(t)];case 1:return r.sent(),[2]}})})},t.prototype.sheet=function(e){return this.entities.sheet(e)},t.prototype.action=function(e){return this.entities.action(e)},t.prototype.query=function(e){return this.entities.query(e)},t.prototype.book=function(e){return this.entities.book(e)},t.prototype.map=function(e){return this.entities.map(e)},t.prototype.history=function(e){return this.entities.history(e)},t.prototype.pending=function(e){return this.entities.pending(e)},t.prototype.tuid=function(e){return this.entities.tuid(e)},t.prototype.tuidDiv=function(e,t){var n=this.entities.tuid(e);if(void 0!==n){var r=n.divs;if(void 0!==r)return r[t]}},t.prototype.cSheetFromName=function(e){var t=this.entities.sheet(e);if(void 0!==t)return this.cSheet(t)},t.prototype.cActionFromName=function(e){var t=this.entities.action(e);if(void 0!==t)return this.cAction(t)},t.prototype.cQueryFromName=function(e){var t=this.entities.query(e);if(void 0!==t)return this.cQuery(t)},t.prototype.cBookFromName=function(e){var t=this.entities.book(e);if(void 0!==t)return this.cBook(t)},t.prototype.cMapFromName=function(e){var t=this.entities.map(e);if(void 0!==t)return this.cMap(t)},t.prototype.cHistoryFromName=function(e){var t=this.entities.history(e);if(void 0!==t)return this.cHistory(t)},t.prototype.cPendingFromName=function(e){var t=this.entities.pending(e);if(void 0!==t)return this.cPending(t)},t.prototype.cTuidMainFromName=function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidMain(t)},t.prototype.cTuidEditFromName=function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidEdit(t)},t.prototype.cTuidInfoFromName=function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidInfo(t)},t.prototype.cTuidSelectFromName=function(e){var t=this.entities.tuid(e);if(void 0!==t)return this.cTuidSelect(t)},t.prototype.cFromName=function(e,t){switch(e){case"sheet":var n=this.entities.sheet(t);if(void 0===n)return;return this.cSheet(n);case"action":var r=this.entities.action(t);if(void 0===r)return;return this.cAction(r);case"tuid":var i=this.entities.tuid(t);if(void 0===i)return;return this.cTuidMain(i);case"query":var o=this.entities.query(t);if(void 0===o)return;return this.cQuery(o);case"book":var s=this.entities.book(t);if(void 0===s)return;return this.cBook(s);case"map":var a=this.entities.map(t);if(void 0===a)return;return this.cMap(a);case"history":var u=this.entities.history(t);if(void 0===u)return;return this.cHistory(u);case"pending":var c=this.entities.pending(t);if(void 0===c)return;return this.cPending(c)}},t.prototype.linkFromName=function(e,t){return this.link(this.cFromName(e,t))},t.prototype.getUI=function(e){var t,n,r=e.name,i=e.typeName;if(void 0!==this.ui){var o=this.ui[i];void 0!==o&&(t=o[r])}var s=this.res.entity;return void 0!==s&&(n=s[r]),{ui:t||{},res:n||{}}},t.prototype.link=function(e){return new s.a(e)},Object.defineProperty(t.prototype,"tuidLinks",{get:function(){var e=this;return this.entities.tuidArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cTuidMain(t))})},enumerable:!0,configurable:!0}),t.prototype.cTuidMain=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidMain||this.CTuidMain)(this,e,n,r)},t.prototype.cTuidEdit=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidEdit||this.CTuidEdit)(this,e,n,r)},t.prototype.cTuidList=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidList||this.CTuidList)(this,e,n,r)},t.prototype.cTuidSelect=function(e){var t=this.getUI(e.owner||e),n=t.ui,r=t.res;return new(n&&n.CTuidSelect||this.CTuidSelect)(this,e,n,r)},t.prototype.cTuidInfo=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CTuidInfo||this.CTuidInfo)(this,e,n,r)},t.prototype.cSheet=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CSheet||this.CSheet)(this,e,n,r)},Object.defineProperty(t.prototype,"sheetLinks",{get:function(){var e=this;return this.entities.sheetArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cSheet(t))})},enumerable:!0,configurable:!0}),t.prototype.cAction=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CAction||this.CAction)(this,e,n,r)},Object.defineProperty(t.prototype,"actionLinks",{get:function(){var e=this;return this.entities.actionArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cAction(t))})},enumerable:!0,configurable:!0}),t.prototype.cQuery=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CQuery||this.CQuery)(this,e,n,r)},t.prototype.cQuerySelect=function(e){var t=this.entities.query(e);if(void 0!==t){var n=this.getUI(t),r=n.ui,i=n.res;return new(r&&r.CQuerySelect||this.CQuerySelect)(this,t,r,i)}},Object.defineProperty(t.prototype,"queryLinks",{get:function(){var e=this;return this.entities.queryArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cQuery(t))})},enumerable:!0,configurable:!0}),t.prototype.cBook=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CBook||this.CBook)(this,e,n,r)},Object.defineProperty(t.prototype,"bookLinks",{get:function(){var e=this;return this.entities.bookArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cBook(t))})},enumerable:!0,configurable:!0}),t.prototype.cHistory=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CHistory||this.CHistory)(this,e,n,r)},Object.defineProperty(t.prototype,"historyLinks",{get:function(){var e=this;return this.entities.historyArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cHistory(t))})},enumerable:!0,configurable:!0}),t.prototype.cPending=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CPending||this.CPending)(this,e,n,r)},Object.defineProperty(t.prototype,"pendingLinks",{get:function(){var e=this;return this.entities.pendingArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cPending(t))})},enumerable:!0,configurable:!0}),t.prototype.cMap=function(e){var t=this.getUI(e),n=t.ui,r=t.res;return new(n&&n.CMap||this.CMap)(this,e,n,r)},Object.defineProperty(t.prototype,"mapLinks",{get:function(){var e=this;return this.entities.mapArr.filter(function(t){return e.isVisible(t)}).map(function(t){return e.link(e.cMap(t))})},enumerable:!0,configurable:!0}),t.prototype.getTuidContent=function(e){var t,n=e.owner;return void 0===n?(t=this.getUI(e).ui)&&t.content||b.b:(t=this.getUI(n).ui)&&t.divs&&t.divs[e.name].content||b.b},t.prototype.showTuid=function(e,t){return r.b(this,void 0,Promise,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return n=e.owner,[4,this.cTuidInfo(n||e).start(t)];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,"VUq",{get:function(){return g},enumerable:!0,configurable:!0}),t.prototype.render=function(){return new this.VUq(this).render()},t}(i.Controller);n.d(t,"a",function(){return C})},function(e,t,n){"use strict";var r=n(0),i=n(8),o=n.n(i),s=n(7),a=n(33),u=n(1),c=n(5),l=n(6),h=n.n(l),d=n(3),p=n(2),f=n(13),m=n(12),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemRender=function(e,n){return u.createElement(t.ItemRow,{item:e})},t.ItemRow=Object(c.a)(function(e){var n,r,i,o,s,a,c=e.item,l=(c.tuid,c.box),p=c.children,v=c.isLeaf,b=c.keyIndex,y=c.values,g=t.controller.keyUIs[b],w=g.content,E=g.valuesContent,k=g.none;if(!1===t.isFrom&&(n=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return t.controller.addClick(c)}},u.createElement(d.FA,{name:"plus"})),r=u.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){return t.controller.removeClick(c)}},u.createElement(d.FA,{className:"text-info",name:"trash"}))),!1===v?i=0===b?n:u.createElement(u.Fragment,null,r," \xa0 ",n):b>0&&(i=r),!0===v)o=void 0,y&&(a=(E||m.b)(y,t.x));else{s="border-bottom";var C=k&&k(t.x);o=u.createElement(d.List,{className:"ml-4",items:p,item:{onClick:void 0,render:t.itemRender},none:C})}var N=u.createElement("div",{className:"py-1 pr-3"},Object(f.b)(l,w,t.x));return u.createElement("div",{className:"d-flex flex-column"},u.createElement(d.LMR,{className:h()("px-3","py-2",s),left:N,right:i},u.createElement("div",{className:"py-1"},a)),o)}),t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.isFrom=this.controller.isFrom,this.openPage(this.view),[2]})})},Object.defineProperty(t.prototype,"view",{get:function(){var e=this;return function(){return u.createElement(p.Page,{header:e.label},u.createElement(d.List,{items:e.controller.items,item:{className:"my-2",onClick:void 0,render:e.itemRender}}))}},enumerable:!0,configurable:!0}),t}(s.b),b=n(4),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onValuesSubmit=function(){return r.b(t,void 0,void 0,function(){var e;return r.e(this,function(t){return this.ceasePage(),e=this.vForm.getValues(),this.returnCall(e),[2]})})},t.view=function(){return u.createElement(p.Page,null,t.vForm.render())},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return this.vForm=this.createForm(this.onValuesSubmit),this.openPageElement(u.createElement(this.view,null)),[2]})})},t}(s.b),g=function(){return function(e,t,n,r){this.children=b.l.array([],{deep:!0}),this.parent=e,this.tuid=t,this.box=n,this.keyIndex=r,this.isLeaf=!1}}(),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.addClick=function(e){return r.b(t,void 0,void 0,function(){var t,n,i,o,s,u,c,l,h,d,p,f,m,v,b,g,w,E,k,C,N,P,S,x,F,T,O;return r.e(this,function(r){switch(r.label){case 0:if(t=e.keyIndex,n=e.children,i=this.keyFields.length,o=i-1,(s=t+1)>=i)return[2];for(u=this.keyFields[s],c=u.name,l=u._tuid,h={},d={},p=e;void 0!==p;p=p.parent)f=p.keyIndex,m=p.box,v=this.keyFields[f].name,h[v]=d[v]=m.id;return[4,this.searchOnKey(u,h)];case 1:return void 0===(b=r.sent())||b<=0?[2]:(l.useId(b),g=l.boxId(b),w={},E={},t+1!==o?[3,4]:(l.useId(b),E[c]=w[c]=g,this.entity.fields.length>0?[4,this.vCall(y,d)]:[3,3]));case 2:for(C in k=r.sent())E[C]=w[C]=k[C];r.label=3;case 3:return[3,5];case 4:for(E[c]=d[c]=g,C=s+1;C<o;C++)d[this.keyFields[C].name]=0;for(w[this.keyFields[o].name]=0,T=this.entity.fields,N=0,P=T;N<P.length;N++)S=P[N],S.name,x=S.type,!0!==S.null&&(w[S.name]=Object(a.b)(x));r.label=5;case 5:return d.arr1=[w],[4,this.entity.actions.add.submit(d)];case 6:return r.sent(),(F=n.findIndex(function(e){return e.box.id===b}))<0?n.push(this.createItem(e,l,g,s,E)):void 0!==(T=this.entity.fields)&&T.length>0&&(O=n[F],n.splice(F,1),O.values=E,n.splice(F,0,O)),this.removeCeased(),[2]}})})},t.removeClick=function(e){return r.b(t,void 0,void 0,function(){var t,n,i,s,a,u,c,l,h,d,p,f,m,v,b,y;return r.e(this,function(r){switch(r.label){case 0:if(t=this.keyFields[e.keyIndex],n=t._tuid,i=this.cUq.cTuidMain(n.Main),s=i.getLable(n),a=this.res.confirmDelete||o.a.template("do you really want to remove ${label}?"),!1===confirm(a({label:s})))return[2];for(u=this.entity,l=(c={}).arr1=[],h={},l.push(h),d=e;void 0!==d;d=d.parent)p=d.keyIndex,h[this.keyFields[p].name]=d.box.id;for(f=this.keyFields.length,m=e.keyIndex+1;m<f;m++)v=this.keyFields[m],h[v.name]=-1;return[4,u.actions.del.submit(c)];case 1:return r.sent(),b=e.parent.children,(y=b.findIndex(function(t){return t===e}))>=0&&b.splice(y,1),[2]}})})},t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){var e,t,n,i,s,a,u,c,l,h,d,p,f,v;return r.e(this,function(r){switch(r.label){case 0:return e=this.entity,t=e.keys,n=e.schemaFrom,this.isFrom=void 0!==n,[4,(i=this.entity.queries.all).query({})];case 1:for(s=r.sent(),a=s.ret,u=t.length,this.keyUIs=o.a.clone(this.ui.keys||[]),this.keyFields=[],c=i.returns[0].fields,l=0;l<u;l++)this.keyFields.push(c[l]),l>=this.keyUIs.length&&this.keyUIs.push({content:m.b});for(this.items=Object(b.l)([]),h=void 0,d=0,p=a;d<p.length;d++)f=p[d],void 0!==(v=this.addItem(h,f))&&(this.items.push(v),h=v);return[4,this.openVPage(this.VMapMain)];case 2:return r.sent(),[2]}})})},t.prototype.createItem=function(e,t,n,r,i){var o=new g(e,t,n,r);return r===this.keyFields.length-1&&(o.isLeaf=!0,o.values=i),o},t.prototype.addItem=function(e,t){for(var n=void 0,r=this.keyFields.length,i=e,o=0;o<r;o++){var s=this.keyFields[o],a=s.name,u=s._tuid,c=t[a];if(void 0===c)break;var l=c.id;if(0!==o){var h=i.children,d=(i.box,h.length);if(d>0){var p=h[d-1];if(p.box.id===l){i=p;continue}}l>0&&h.push(i=this.createItem(i,u,c,o,t))}else{if(0===l)continue;void 0!==i&&i.box.id===l||(n=i=this.createItem(void 0,u,c,o,t))}}return n},t.prototype.searchOnKey=function(e,t){return r.b(this,void 0,Promise,function(){var n,i,o,s,a;return r.e(this,function(r){switch(r.label){case 0:return n=e._tuid,i=e._ownerField,o=this.cUq.cTuidSelect(n),s=t,void 0!==i&&"object"===typeof(s=t[i.name])&&(s=s.id),[4,o.call(s)];case 1:return a=r.sent(),[2,n.getIdFromObj(a)]}})})},Object.defineProperty(t.prototype,"VMapMain",{get:function(){return v},enumerable:!0,configurable:!0}),t}(s.a);n.d(t,"a",function(){return w})},function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){return o.createElement(s.Page,{header:t.label},"pending")},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t}(i.b),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VPendingMain)];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"VPendingMain",{get:function(){return a},enumerable:!0,configurable:!0}),t}(i.a);n.d(t,"a",function(){return u})},function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.view=function(){return o.createElement(s.Page,{header:t.label},"History")},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return this.openPage(this.view),[2]})})},t}(i.b),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VHistoryMain)];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"VHistoryMain",{get:function(){return a},enumerable:!0,configurable:!0}),t}(i.a);n.d(t,"a",function(){return u})},function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(1),s=n(2),a=n(13),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSubmit=function(){return r.b(t,void 0,void 0,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return e=this.vForm.getValues(),t=this,[4,this.controller.submit(e)];case 1:return t.returns=n.sent(),this.closePage(),this.openPage(this.resultPage),[2]}})})},t.mainPage=function(){var e=t.controller.label;return o.createElement(s.Page,{header:e},t.vForm.render("mx-3 my-2"))},t.resultPage=function(){var e=t.controller.label;return o.createElement(s.Page,{header:e,back:"close"},"\u5b8c\u6210\uff01",o.createElement("pre",null,Object(a.a)(t.returns)))},t}return r.d(t,e),t.prototype.open=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){return this.vForm=this.createForm(this.onSubmit,e),this.openPage(this.mainPage),[2]})})},t}(i.b),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:return[4,this.openVPage(this.VActionMain)];case 1:return e.sent(),[2]}})})},Object.defineProperty(t.prototype,"VActionMain",{get:function(){return u},enumerable:!0,configurable:!0}),t.prototype.submit=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){return[2,this.entity.submit(e)]})})},t}(i.a);n.d(t,"a",function(){return c})},,function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(17),i=n(19),o={set:function(e,t){Object(r.i)(e,t),i.a.setCenterToken(t)},clear:function(){Object(r.i)(0,void 0),i.a.setCenterToken(void 0)}}},function(e,t,n){"use strict";var r=n(0),i=n(11),o=n(23),s=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.login=function(e){return r.b(this,void 0,Promise,function(){var t,n,i,s,a;return r.e(this,function(r){switch(r.label){case 0:return[4,this.get("login",e)];case 1:switch(typeof(t=r.sent())){default:return[2];case"string":return[2,Object(o.b)(t)];case"object":return n=t.token,i=Object(o.b)(n),s=t.nick,a=t.icon,s&&(i.nick=s),a&&(i.icon=a),[2,i]}return[2]}})})},t.prototype.register=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.post("register",e)];case 1:return[2,t.sent()]}})})},t.prototype.setVerify=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("set-verify",{account:e,type:t})];case 1:return[2,n.sent()]}})})},t.prototype.checkVerify=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("check-verify",{account:e,verify:t})];case 1:return[2,n.sent()]}})})},t.prototype.isExists=function(e){return r.b(this,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.get("is-exists",{account:e})];case 1:return[2,t.sent()]}})})},t.prototype.resetPassword=function(e,t,n,i){return r.b(this,void 0,void 0,function(){return r.e(this,function(r){switch(r.label){case 0:return[4,this.post("reset-password",{account:e,password:t,verify:n,type:i})];case 1:return[2,r.sent()]}})})},t.prototype.userSetProp=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.post("tie/user-set-prop",{prop:e,value:t})];case 1:return n.sent(),[2]}})})},t}(i.a))("tv/user/",void 0);t.a=s},,function(e,t,n){"use strict"},,,function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l});var r=n(0),i=n(1),o=n(9),s=n(16),a=n(11),u=function(){function e(e){var t=this;this.isDev=a.j,this.onMessageReceive=function(e){return r.b(t,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.onMessage(e)];case 1:return t.sent(),[2]}})})},this.res=e||{},this.x=this.res.x||{}}return Object.defineProperty(e.prototype,"user",{get:function(){return o.c.user},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLogined",{get:function(){var e=o.c.user;return void 0!==e&&e.id>0},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){o.c.unregisterReceiveHandler(this.receiveHandlerId),this.onDispose()},e.prototype.onDispose=function(){},e.prototype.openVPage=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new e(this).open(t)];case 1:return n.sent(),[2]}})})},e.prototype.renderView=function(e,t){return new e(this).render(t)},e.prototype.event=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.onEvent(e,t)];case 1:return n.sent(),[2]}})})},e.prototype.onEvent=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(e){return[2]})})},e.prototype.msg=function(e){alert(e)},e.prototype.errorPage=function(e,t){this.openPage(i.createElement(s.a,{header:"App error!"},i.createElement("pre",null,"string"===typeof t?t:t.message)))},e.prototype.onMessage=function(e){},e.prototype.beforeStart=function(){return r.b(this,void 0,Promise,function(){return r.e(this,function(e){return[2,!0]})})},e.prototype.registerReceiveHandler=function(){this.receiveHandlerId=o.c.registerReceiveHandler(this.onMessageReceive)},e.prototype.start=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.disposer=this.dispose.bind(this),this.registerReceiveHandler(),[4,this.beforeStart()];case 1:return!1===t.sent()?[2]:[4,this.internalStart(e)];case 2:return t.sent(),[2]}})})},Object.defineProperty(e.prototype,"isCalling",{get:function(){return void 0!==this._resolve_$},enumerable:!0,configurable:!0}),e.prototype.call=function(e){return r.b(this,void 0,Promise,function(){var t=this;return r.e(this,function(n){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(n,i){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return this._resolve_$.push(n),[4,this.start(e)];case 1:return t.sent(),[2]}})})})]})})},e.prototype.vCall=function(e,t){return r.b(this,void 0,Promise,function(){var n=this;return r.e(this,function(i){return void 0===this._resolve_$&&(this._resolve_$=[]),[2,new Promise(function(i,o){return r.b(n,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return this._resolve_$.push(i),[4,new e(this).open(t)];case 1:return n.sent(),[2]}})})})]})})},e.prototype.returnCall=function(e){if(void 0!==this._resolve_$){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Controller call already returned, or not called")}},e.prototype.openPage=function(e){o.c.push(e,this.disposer),this.disposer=void 0},e.prototype.replacePage=function(e){o.c.replace(e,this.disposer),this.disposer=void 0},e.prototype.backPage=function(){o.c.back()},e.prototype.closePage=function(e){o.c.pop(e)},e.prototype.ceasePage=function(e){o.c.ceaseTop(e)},e.prototype.removeCeased=function(){o.c.removeCeased()},e.prototype.regConfirmClose=function(e){o.c.regConfirmClose(e)},e}(),c=function(){function e(e){this.controller=e,this.res=e.res,this.x=e.x}return Object.defineProperty(e.prototype,"isDev",{get:function(){return a.j},enumerable:!0,configurable:!0}),e.prototype.renderVm=function(e,t){return new e(this.controller).render(t)},e.prototype.openVPage=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,new e(this.controller).open(t)];case 1:return n.sent(),[2]}})})},e.prototype.event=function(e,t){return r.b(this,void 0,void 0,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.controller.event(e,t)];case 1:return n.sent(),[2]}})})},e.prototype.vCall=function(e,t){return r.b(this,void 0,Promise,function(){return r.e(this,function(n){switch(n.label){case 0:return[4,this.controller.vCall(e,t)];case 1:return[2,n.sent()]}})})},e.prototype.returnCall=function(e){this.controller.returnCall(e)},e.prototype.openPage=function(e,t){this.controller.openPage(i.createElement(e,t))},e.prototype.replacePage=function(e,t){this.controller.replacePage(i.createElement(e,t))},e.prototype.openPageElement=function(e){this.controller.openPage(e)},e.prototype.replacePageElement=function(e){this.controller.replacePage(e)},e.prototype.backPage=function(){this.controller.backPage()},e.prototype.closePage=function(e){this.controller.closePage(e)},e.prototype.ceasePage=function(e){this.controller.ceasePage(e)},e.prototype.removeCeased=function(){this.controller.removeCeased()},e.prototype.regConfirmClose=function(e){this.controller.regConfirmClose(e)},e}(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e){return null},t}(c)},function(e,t,n){"use strict";var r=n(63);n.o(r,"Edit")&&n.d(t,"Edit",function(){return r.Edit}),n.o(r,"Form")&&n.d(t,"Form",function(){return r.Form}),n.o(r,"Image")&&n.d(t,"Image",function(){return r.Image}),n.o(r,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",function(){return r.TabCaptionComponent}),n.o(r,"Tabs")&&n.d(t,"Tabs",function(){return r.Tabs}),n.o(r,"emailRegex")&&n.d(t,"emailRegex",function(){return r.emailRegex}),n.o(r,"mobileRegex")&&n.d(t,"mobileRegex",function(){return r.mobileRegex}),n.o(r,"resLang")&&n.d(t,"resLang",function(){return r.resLang});var i=n(64);n.o(i,"Edit")&&n.d(t,"Edit",function(){return i.Edit}),n.o(i,"Form")&&n.d(t,"Form",function(){return i.Form}),n.o(i,"Image")&&n.d(t,"Image",function(){return i.Image}),n.o(i,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",function(){return i.TabCaptionComponent}),n.o(i,"Tabs")&&n.d(t,"Tabs",function(){return i.Tabs}),n.o(i,"emailRegex")&&n.d(t,"emailRegex",function(){return i.emailRegex}),n.o(i,"mobileRegex")&&n.d(t,"mobileRegex",function(){return i.mobileRegex}),n.o(i,"resLang")&&n.d(t,"resLang",function(){return i.resLang})},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r=/^[0-9]*$/,i=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=n(4),o=n(25),s=function(){function e(e){void 0===e&&(e=!1),this.isFirst=!0,this.loading=!1,this.beforeLoad=!0,this.loaded=!1,this.allLoaded=!1,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this._items=i.l.array([],{deep:e})}return Object.defineProperty(e.prototype,"items",{get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0},enumerable:!0,configurable:!0}),e.prototype.scrollToTop=function(){this.topDiv="$$"+Object(o.a)()},e.prototype.scrollToBottom=function(){this.bottomDiv="$$"+Object(o.a)()},e.prototype.reset=function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this._items.clear(),this.setPageStart(void 0)},e.prototype.append=function(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)},e.prototype.first=function(e){return r.b(this,void 0,Promise,function(){return r.e(this,function(t){switch(t.label){case 0:return this.reset(),this.beforeLoad=!1,this.param=e,[4,this.more()];case 1:return t.sent(),[2]}})})},e.prototype.more=function(){return r.b(this,void 0,Promise,function(){var e,t,n,i,o;return r.e(this,function(r){switch(r.label){case 0:return!0===this.allLoaded?[2]:!0===this.loading?[2]:(this.loading=!0,n=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(n=this.firstSize+1),[4,this.load(this.param,this.pageStart,n)]);case 1:return i=r.sent(),this.loading=!1,this.loaded=!0,o=i.length,!0===this.isFirst&&o>this.firstSize||!1===this.isFirst&&o>this.pageSize?(this.allLoaded=!1,--o,i.splice(o,1)):this.allLoaded=!0,0===o?(this._items.clear(),[2]):(this.setPageStart(i[o-1]),"tail"===this.appendPosition?(e=this._items).push.apply(e,i):(t=this._items).unshift.apply(t,i.reverse()),this.isFirst=!1,[2])}})})},r.c([i.l],e.prototype,"loading",void 0),r.c([i.l],e.prototype,"beforeLoad",void 0),r.c([i.l],e.prototype,"loaded",void 0),r.c([i.l],e.prototype,"allLoaded",void 0),r.c([i.e],e.prototype,"items",null),r.c([i.l],e.prototype,"topDiv",void 0),r.c([i.l],e.prototype,"bottomDiv",void 0),e}()},function(e,t,n){"use strict";var r=n(0),i=n(4);!function(){function e(e){void 0===e&&(e=100),this.arr=[],this.dict=new Map,this.maxCount=e}e.prototype.loadIds=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(null!==i){var o=this.dict.get(i);void 0===o&&(t.push(i),o={id:i},this.dict.set(i,o))}}this.loadId(t)},e.prototype.get=function(e){if(void 0===e||null===e)return null;var t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t},e.prototype.setItem=function(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))},e.prototype.loadId=function(e){return r.b(this,void 0,void 0,function(){var t,n,i,o,s,a,u,c,l;return r.e(this,function(r){switch(r.label){case 0:return[4,this._loadIds(e)];case 1:if(void 0!==(t=r.sent()))return[3,6];n=0,i=e,r.label=2;case 2:return n<i.length?null===(l=i[n])?[3,4]:[4,this._loadId(l)]:[3,5];case 3:o=r.sent(),this.setItem(l,o),r.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:for(s=function(e){var n=t.find(function(t){return t.id===e});a.setItem(e,n)},a=this,u=0,c=e;u<c.length;u++)l=c[u],s(l);r.label=7;case 7:return[2]}})})},r.c([i.l],e.prototype,"dict",void 0)}()},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(1),o=n(5),s=n(44);var a=function(e){function t(t){var n=e.call(this,t)||this;return n.formView=new s.a(n.props),n}return r.d(t,e),t.prototype.componentWillMount=function(){this.formView.setInitValues(this.props.initValues)},t.prototype.debug=function(){},t.prototype.render=function(){var e=this.props,t=e.className,n=e.children;e.initValues;return i.createElement("div",{className:t},void 0===n?this.formView.render():i.createElement("form",{onSubmit:this.formView.onSubmit},n))},t=r.c([o.a],t)}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o);!function(e){function t(t){var n=e.call(this,t)||this;return n.handleDocumentClick=function(e){!1!==n.state.dropdownOpen&&(n.button&&n.button.contains(e.target)||n.menu&&n.toggle())},n.toggle=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.state={dropdownOpen:!1},n}r.d(t,e),t.prototype.componentWillMount=function(){document.addEventListener("click",this.handleDocumentClick),document.addEventListener("touchstart",this.handleDocumentClick)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("touchstart",this.handleDocumentClick)},t.prototype.render=function(){var e=this,t=this.props,n=t.icon,r=t.actions,o=t.isRight;void 0===o&&(o=!0);var a=r.some(function(e){return void 0!==e.icon}),u=this.state.dropdownOpen;return i.createElement("div",{className:"dropdown"},i.createElement("button",{ref:function(t){return e.button=t},className:"cursor-pointer dropdown-toggle btn btn-sm","data-toggle":"dropdown","aria-expanded":u,onClick:this.toggle},i.createElement("i",{className:s()("fa","fa-"+(n||"ellipsis-v"))})),i.createElement("div",{ref:function(t){return e.menu=t},className:s()({"dropdown-menu":!0,"dropdown-menu-right":o,show:u})},r.map(function(e,t){var n,r=e.icon,o=e.caption,u=e.action;return void 0===r&&void 0===o?i.createElement("div",{className:"dropdown-divider"}):(!0===a&&(void 0!==r&&(r="fa-"+r),n=i.createElement(i.Fragment,null,i.createElement("i",{className:s()("fa",r,"fa-fw"),"aria-hidden":!0}),"\xa0 ")),void 0===u?i.createElement("h6",{className:"dropdown-header"},n," ",o):i.createElement("a",{className:"dropdown-item",key:t,href:"#",onClick:function(e){e.preventDefault(),u()}},n," ",o))})))}}(i.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),i=n(1),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(){var e=this.props.date;if(!e)return null;var t="string"===typeof e?new Date(Date.parse(e)):e,n=new Date,r=n.getTime()-t.getTime(),i=n.getDate(),o=t.getDate(),s=t.getHours(),a=t.getMinutes(),u=t.getMonth()+1,c=s+(a<10?":0":":")+a;return r<-864e5?t.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5 "+c:r<864e5?o!==i?(r<0?"\u660e\u5929 ":"\u6628\u5929 ")+c:c:r<31536e6?u+"\u6708"+o+"\u65e5 ":t.getFullYear()+"\u5e74"+u+"\u6708"+o+"\u65e5"},t}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(2);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e,t=this.props,n=t.icon,r=t.main,o=t.discription,u=t.px,c=t.py;e="string"===typeof o?i.createElement("div",null,o):o;var l=s()("media",void 0===u?"px-0":"px-"+u,void 0===c?"py-2":"py-"+c);return i.createElement("div",{className:l},i.createElement(a.Image,{className:"mr-3 w-4c h-4c",src:n}),i.createElement("div",{className:"media-body"},i.createElement("h5",{className:"mt-0"},r),e))}}(i.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(4),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.key=null,t.onChange=function(e){t.key=e.target.value,void 0!==t.key&&(t.key=t.key.trim(),""===t.key&&(t.key=void 0)),!0!==t.props.allowEmptySearch&&(t.disabled=!t.key)},t.onSubmit=function(e){return r.b(t,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:if(e.preventDefault(),null===this.key&&(this.key=this.props.initKey||""),!0!==this.props.allowEmptySearch){if(!this.key)return[2];this.input&&(this.input.disabled=!0)}return[4,this.props.onSearch(this.key)];case 1:return t.sent(),this.input&&(this.input.disabled=!1),[2]}})})},t}return r.d(t,e),t.prototype.clear=function(){this.input&&(this.input.value="")},t.prototype.render=function(){var e,t,n=this,r=this.props,o=r.className,a=r.inputClassName,u=r.onFocus,c=r.label,l=r.placeholder,h=r.buttonText,d=r.maxLength;switch(r.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return void 0!==c&&(t=i.createElement("label",{className:"input-group-addon"},c)),i.createElement("form",{className:o,onSubmit:this.onSubmit},i.createElement("div",{className:s()("input-group",e)},t,i.createElement("input",{ref:function(e){return n.input=e},onChange:this.onChange,type:"text",name:"key",onFocus:u,className:s()("form-control",a||"border-primary"),placeholder:l,defaultValue:this.props.initKey,maxLength:d}),i.createElement("div",{className:"input-group-append"},i.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.disabled},i.createElement("i",{className:"fa fa-search"}),i.createElement("i",{className:"fa"}),h))))},r.c([a.l],t.prototype,"disabled",void 0),t}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(8),s=n.n(o),a=n(6),u=n.n(a),c=n(43),l=(function(e){function t(t){var n=e.call(this,t)||this;return n.values={},n.stepViews=[],n.state={topView:void 0,stepViews:[]},n.onPrev=n.onPrev.bind(n),n.onNext=n.onNext.bind(n),n}r.d(t,e),t.prototype.setStep=function(e){var t=this.props.steps[e];if(void 0!==t){var n,o;void 0!==this.topView&&this.stepViews.push(this.topView),this.stepViews.length>0&&(n=i.createElement(l,{prefix:"undo",text:"\u4e0a\u4e00\u6b65"}),o=this.onPrev);var s=this.props,a=(s.header,s.footer,void 0===t.next?{prefix:"cloud-upload",text:this.props.submitButton||"\u63d0\u4ea4"}:{suffix:"arrow-right",text:"\u4e0b\u4e00\u6b65"}),u={formRows:t.formRows,submitButton:i.createElement(l,r.a({},a)),onSubmit:this.onNext,otherButton:n,onOther:o};this.stepViews.length;this.topView={stepName:e,step:t,props:u},this.setState({topView:this.topView,stepViews:this.stepViews})}},t.prototype.componentWillMount=function(){this.setStep(this.props.first)},t.prototype.onPrev=function(e){s.a.assign(this.values,e),this.topView=this.stepViews.pop(),this.setState({topView:this.topView,stepViews:this.stepViews})},t.prototype.onNext=function(e){s.a.assign(this.values,e);var t,n=this.topView.step.next;if(void 0===n)return this.props.onSubmit(this.values);t="string"===typeof n?n:n(this.values),this.setStep(t)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.header,o=e.footer,s=this.state,a=s.topView,u=s.stepViews,l=a.stepName,h=a.step,d=u.length+1;return i.createElement("div",{className:t},i.createElement("div",null,n&&n(h,d),i.createElement(c.TonvaForm,r.a({key:l,initValues:this.values},a.props)),o&&o(h,d)))}}(i.Component),function(e){var t,n,r=e.prefix,o=(e.text,e.suffix);return void 0!==r&&(t=i.createElement("i",{className:u()("fa","fa-"+r)})),void 0!==o&&(n=i.createElement("i",{className:u()("fa","fa-"+o)})),i.createElement(i.Fragment,null,t," ",e.text," ",n)})},function(e,t,n){"use strict";n(0),n(1),n(42)},function(e,t){},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(6),a=n.n(s),u=n(8),c=n.n(u),l=function(){return function(){}}(),h=function(e){function t(t){var n=e.call(this)||this;return n.func=t,n}return r.d(t,e),t.prototype.check=function(e,t){var n=this.func(t);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void e.push(n);default:return void e.push.apply(e,n)}},t}(l),d=function(e){function t(t){var n=e.call(this)||this;return n.res=t,n}return r.d(t,e),t}(l),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.check=function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(NaN!==t)return;break;case"undefined":}e.push(this.res.required)},t}(d),f=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.minMsg=c.a.template(t.min),i.maxMsg=c.a.template(t.max),i.min=n,i.max=r,i}return r.d(t,e),t.prototype.check=function(e,t){if(void 0!==t&&null!==t){var n=Number(t);NaN===n?e.push(this.res.number):this.checkMore(e,n)}},t.prototype.checkMore=function(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))},t}(d),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.checkMore=function(t,n){e.prototype.checkMore.call(this,t,n),!1===Number.isInteger(n)&&t.push(this.res.integer)},t}(f),v=n(5),b=function(){function e(e,t,n,r){var o=this;this.errors=[],this.contextErrors=[],this.onInputChange=function(e){o.changeValue(e.target.value,!0)},this.container=Object(v.a)(function(){if(!1===o.visible)return null;var e=o.context,t=e.form;if(!0===e.inNode)return o.render();var n=o.label;return!0===o.itemSchema.required&&!1!==t.props.requiredFlag&&null!==n&&(n=i.createElement(i.Fragment,null,n,"\xa0",i.createElement("span",{className:"text-danger"},"*"))),t.FieldContainer(n,o.render())}),this.context=e;var s=t.name;if(this.name=s,this.itemSchema=t,this.fieldProps=n,this.children=r,this.ui=e.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var a=this.ui,u=a.readOnly,c=a.disabled,l=a.visible;this.readOnly=!0===u,this.disabled=!0===c,this.visible=!(!1===l)}this.value=this.defaultValue=e.getValue(s),this.init()}return Object.defineProperty(e.prototype,"hasError",{get:function(){return this.errors.length+this.contextErrors.length>0},enumerable:!0,configurable:!0}),e.prototype.init=function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new p(this.context.form.res)),this.buildRules(),void 0!==this.ui){var e=this.ui.rules;if(void 0!==e)if(!1!==Array.isArray(e))for(var t=0,n=e;t<n.length;t++){var r=n[t];this.rules.push(new h(r))}else this.rules.push(new h(e))}},e.prototype.buildRules=function(){},e.prototype.checkRules=function(){for(var e,t=[],n=0,r=this.rules;n<r.length;n++){r[n].check(t,this.value)}0===t.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(e=this.errors).push.apply(e,t))},Object.defineProperty(e.prototype,"isOk",{get:function(){return 0===this.errors.length},enumerable:!0,configurable:!0}),e.prototype.setError=function(e){var t;void 0!==e&&("string"===typeof e?this.errors.push(e):(t=this.errors).push.apply(t,e))},e.prototype.setContextError=function(e){var t;void 0!==e&&("string"===typeof e?this.contextErrors.push(e):(t=this.contextErrors).push.apply(t,e))},e.prototype.clearError=function(){this.errors.splice(0)},e.prototype.clearContextError=function(){this.contextErrors.splice(0)},e.prototype.parse=function(e){return e},e.prototype.setElementValue=function(e){},e.prototype.setDataValue=function(e){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(e))},e.prototype.setValue=function(e){!0!==this.isChanging&&this.changeValue(e,!1)},e.prototype.getValue=function(){return this.context.getValue(this.name)},e.prototype.getReadOnly=function(){return this.readOnly},e.prototype.getDisabled=function(){return this.disabled},e.prototype.getVisible=function(){return this.visible},e.prototype.setReadOnly=function(e){this.readOnly=e},e.prototype.setDisabled=function(e){this.disabled=e},e.prototype.setVisible=function(e){this.visible=e},e.prototype.changeValue=function(e,t){var n,r,i=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var o=!0;void 0!==n&&(this.isChanging=!0,o=n(this.context,this.value,i),this.isChanging=!1),!0===o&&(this.setDataValue(e),!0!==t&&this.setElementValue(e),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,i),this.isChanging=!1))},Object.defineProperty(e.prototype,"className",{get:function(){var e;return!1===this.context.inNode&&(e="form-control"),a()(e,this.context.form.FieldClass,this.ui&&this.ui.className)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){var e;if(void 0===this.ui)e=this.name;else{var t=this.ui.label;e=null===t?null:t||this.name}return e},enumerable:!0,configurable:!0}),e.prototype.renderTemplet=function(){if(void 0!==this.children)return i.createElement(i.Fragment,null,this.children);if(void 0!==this.ui){var e=this.ui.Templet;return"function"===typeof e?e(this.value):e}},e.prototype.renderErrors=function(){var e=this.errors.concat(this.contextErrors);if(0===e.length)return null;var t=!0===this.context.inNode?"span":"div";return e.map(function(e){return i.createElement(t,{key:e,className:"text-danger d-inline-block my-2 ml-3"},i.createElement(i.Fragment,null,i.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e))})},r.c([o.l],e.prototype,"errors",void 0),r.c([o.l],e.prototype,"contextErrors",void 0),r.c([o.e],e.prototype,"hasError",null),r.c([o.l],e.prototype,"visible",void 0),r.c([o.e],e.prototype,"isOk",null),e}(),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="text",t.onKeyDown=function(e){return r.b(t,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return this.internalOnKeyDown(e),13!==e.keyCode?[2]:void 0===(t=this.context.form.props.onEnter)?[2]:(this.changeValue(e.currentTarget.value,!0),this.input.blur(),[4,t(this.name,this.context)]);case 1:return void 0!==(n=r.sent())&&this.context.setError(this.name,n),[2]}})})},t}return r.d(t,e),t.prototype.setElementValue=function(e){null!==this.input&&(this.input.value=e)},Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.ui&&this.ui.placeholder||this.name},enumerable:!0,configurable:!0}),t.prototype.internalOnKeyDown=function(e){},t.prototype.onBlur=function(e){this.onInputChange(e),this.checkRules(),this.context.checkContextRules()},t.prototype.onFocus=function(e){this.clearError(),this.context.removeErrorWidget(this),this.context.clearErrors()},t.prototype.onChange=function(e){},t.prototype.setReadOnly=function(e){null!==this.input&&(this.input.readOnly=this.readOnly=e)},t.prototype.setDisabled=function(e){null!==this.input&&(this.input.disabled=this.disabled=e)},t.prototype.render=function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,i.createElement(i.Fragment,null,i.createElement("input",{ref:function(t){return e.input=t},className:a()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:function(t){return e.onChange(t)},placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:function(t){return e.onFocus(t)},onBlur:function(t){return e.onBlur(t)},maxLength:this.itemSchema.maxLength}),this.renderErrors())},t}(b),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onInputChange=function(e){t.setValue(e.currentTarget.value)},t}return r.d(t,e),t.prototype.setElementValue=function(e){this.input.value=e},t.prototype.setReadOnly=function(e){this.input.readOnly=this.readOnly=e},t.prototype.setDisabled=function(e){this.input.disabled=this.disabled=e},t.prototype.render=function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,i.createElement("textarea",{ref:function(t){return e.input=t},className:a()(this.className,n),rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange})},t}(b),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="password",t}return r.d(t,e),t}(y),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="url",t}return r.d(t,e),t}(y),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="email",t}return r.d(t,e),t}(y),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="number",t}return r.d(t,e),t.prototype.buildRules=function(){e.prototype.buildRules.call(this);var t=this.context.form.res,n=this.itemSchema,r=n.min,i=n.max;this.rules.push("integer"===this.itemSchema.type?new f(t,r,i):new m(t,r,i))},t.prototype.parse=function(e){if(void 0!==e&&null!==e)return Number(e)},t}(y),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="number",t}return r.d(t,e),t.prototype.isValidKey=function(e){return 46===e||8===e||37===e||39===e||e>=48&&e<=57||e>=96&&e<=105||109===e||189===e},t.prototype.internalOnKeyDown=function(e){var t=e.keyCode;event.returnValue=this.isValidKey(t)},t}(C),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="date",t}return r.d(t,e),t}(y),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="datetime",t}return r.d(t,e),t}(y),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="time",t}return r.d(t,e),t}(y),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="month",t}return r.d(t,e),t}(y),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onInputChange=function(e){t.setDataValue(!0===e.target.checked?t.trueValue:t.falseValue)},t.onClick=function(){t.context.clearErrors()},t}return r.d(t,e),t.prototype.init=function(){if(e.prototype.init.call(this),void 0!==this.ui){var t=this.ui,n=t.trueValue,r=t.falseValue;this.trueValue=void 0===n||n,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1},t.prototype.setElementValue=function(e){this.input.checked=e===this.trueValue},t.prototype.setReadOnly=function(e){this.input.readOnly=this.readOnly=e},t.prototype.setDisabled=function(e){this.input.disabled=this.disabled=e},t.prototype.render=function(){var e=this,t=a()(this.className,"form-check-inline p-0"),n=i.createElement("input",{ref:function(t){return e.input=t},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return!0===this.context.inNode?i.createElement("label",{className:t},n," ",this.ui&&this.ui.label||this.name):i.createElement("div",{className:t},i.createElement("label",{className:"w-100 h-100 mb-0 d-flex justify-content-center"},n))},t}(b),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onInputChange=function(e){t.setDataValue(e.target.value)},t}return r.d(t,e),t.prototype.setElementValue=function(e){this.select.value=e},t.prototype.setReadOnly=function(e){this.select.disabled=this.readOnly=!e},t.prototype.setDisabled=function(e){this.select.disabled=this.disabled=e},t.prototype.render=function(){var e=this;if(!0===this.readOnly){var t=this.ui.list.find(function(t){return t.value===e.value}),n=void 0===t?"(???)":t.title;return i.createElement("span",{className:"form-control w-min-6c"},n)}return i.createElement("select",{ref:function(t){return e.select=t},className:a()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map(function(e,t){var n=e.title,r=e.value;return i.createElement("option",{className:void 0,key:t,value:r},n||r)}))},r.c([o.l],t.prototype,"readOnly",void 0),t}(b),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputs={},t}return r.d(t,e),t.prototype.setElementValue=function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}},t.prototype.setReadOnly=function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e},t.prototype.setDisabled=function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e},t.prototype.render=function(){var e,t=this,n=this.ui,r=n.defaultValue,o=n.list,s=this.context,u=s.isRow;s.inNode;!0===u&&(e=this.context.rowKey);var c=a()(this.className,"form-radio-inline");return i.createElement("span",{className:c},o.map(function(n,o){var s=n.value,a=n.title,u=t.name;return void 0!==e&&(u+="-"+e),i.createElement("label",{key:o,className:"form-radio-inline"},i.createElement("input",{ref:function(e){return t.inputs[o]=e},type:"radio",name:u,value:s,defaultChecked:(t.defaultValue||r)===s}),a||s)}))},t}(b),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputType="range",t}return r.d(t,e),t.prototype.setReadOnly=function(e){this.input.readOnly=this.readOnly=e},t.prototype.setDisabled=function(e){this.input.disabled=this.disabled=e},t.prototype.render=function(){var e=this,t=this.ui,n=t.min,r=t.max,o=t.step;return i.createElement(i.Fragment,null,i.createElement("input",{ref:function(t){return e.input=t},className:a()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:o}))},t}(b),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return r.b(t,void 0,void 0,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return void 0===(e=this.ui&&this.ui.pickId)?(alert("no pickId defined!"),[2]):[4,e(this.context,this.name,this.value)];case 1:return t=n.sent(),this.setDataValue(t),this.clearError(),this.clearContextError(),this.checkRules(),[2]}})})},t}return r.d(t,e),t.prototype.setReadOnly=function(e){this.readOnly=e},t.prototype.setDisabled=function(e){this.disabled=e},t.prototype.render=function(){var e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};return void 0===this.value||null===this.value?(n=e||"placeholder",r["text-muted"]=!0):n=void 0===t?i.createElement(i.Fragment,null,this.value):"function"===typeof t?t(this.value):t,i.createElement(i.Fragment,null,i.createElement("div",{className:a()(r),onClick:this.onClick},n),this.renderErrors())},r.c([o.l],t.prototype,"value",void 0),t}(b),j=function(e,t,n){return i.createElement("span",{className:"text-danger"},"!!data type ",e," only support ",(n||[]).join(", "),", can't use ui ",t,"!!")},q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return r.b(t,void 0,void 0,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return this.clearError(),this.clearContextError(),e=this.itemSchema,t=e.name,"submit"!==e.type?[3,2]:[4,this.context.submit(t)];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.observerRender=Object(v.a)(function(){var e,n,r,o=t.itemSchema,s=o.name,a=o.type;if(void 0!==t.ui){var u=t.ui.widget;if("button"!==u)return j(a,u,["button"]);e=t.ui.Templet,n=t.ui.className,r=t.ui.label}var c,l=t.context,h=l.form,d=l.hasError,p=t.context,f="submit"===a&&d;c=void 0!==t.children?t.children:"function"===typeof e?e():void 0!==e?e:r;var m=i.createElement("button",{className:n,type:"button",disabled:f,onClick:t.onClick},c||s);return!0===p.inNode?i.createElement(i.Fragment,null,m,t.renderErrors()):i.createElement("div",{className:h.ButtonClass},i.createElement("div",null,t.renderErrors()),m)}),t}return r.d(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.render=function(){return i.createElement(this.observerRender,null)},t}(b),R=function(){function e(e,t,n,r,o){var s,a=this;if(this.widgets={},this.errors=[],this.errorWidgets=[],this.renderErrors=Object(v.a)(function(){var e=a.errors;return 0===e.length?null:i.createElement(i.Fragment,null,e.map(function(e){return i.createElement("span",{key:e,className:"text-danger inline-block my-1 ml-3"},i.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)}))}),this.form=e,this.uiSchema=t,this.initData=n,this.inNode=r,this.isRow=o,void 0!==t){var u=t.rules;void 0!==u&&(this.rules=[],!1===Array.isArray(u)?this.rules.push(u):(s=this.rules).push.apply(s,u))}}return e.prototype.getArrRowContexts=function(e){void 0===this.subContexts&&(this.subContexts={});var t=this.subContexts[name];return void 0===t&&(this.subContexts[name]=t={}),t},Object.defineProperty(e.prototype,"arrName",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){return this.initData[e]},e.prototype.setValue=function(e,t){this.initData[e]=t;var n=this.widgets[e];void 0!==n&&n.setValue(t)},e.prototype.getDisabled=function(e){var t=this.widgets[e];if(void 0!==t)return t.getDisabled()},e.prototype.setDisabled=function(e,t){var n=this.widgets[e];void 0!==n&&n.setDisabled(t)},e.prototype.getReadOnly=function(e){var t=this.widgets[e];void 0!==t&&t.getReadOnly()},e.prototype.setReadOnly=function(e,t){var n=this.widgets[e];void 0!==n&&n.setReadOnly(t)},e.prototype.getVisible=function(e){var t=this.widgets[e];void 0!==t&&t.getVisible()},e.prototype.setVisible=function(e,t){var n=this.widgets[e];void 0!==n&&n.setVisible(t)},e.prototype.submit=function(e){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return this.checkRules(),!0===this.hasError?[2]:void 0===(t=this.form.props.onButtonClick)?(alert("button "+e+" clicked. you should define form onButtonClick"),[2]):[4,t(e,this)];case 1:return void 0===(n=r.sent())?[2]:(this.setError(e,n),[2])}})})},e.prototype.checkFieldRules=function(){for(var e in this.widgets)this.widgets[e].checkRules();if(void 0!==this.subContexts)for(var e in this.subContexts){var t=this.subContexts[e];for(var n in t)t[n].checkFieldRules()}},e.prototype.checkContextRules=function(){var e;if(this.clearErrors(),void 0!==this.rules){for(var t=0,n=this.rules;t<n.length;t++){var r=(0,n[t])(this);if(void 0!==r)if(!0===Array.isArray(r))(e=this.errors).push.apply(e,r);else if("string"===typeof r)this.errors.push(r);else for(var i in r)this.setError(i,r[i])}if(void 0!==this.subContexts)for(var i in this.subContexts){var o=this.subContexts[i];for(var s in o){var a=o[s];a.clearErrors(),a.checkContextRules()}}}},e.prototype.setError=function(e,t){var n=this.widgets[e];void 0!==n&&(n.setContextError(t),this.addErrorWidget(n))},e.prototype.clearContextErrors=function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearContextError()}},e.prototype.clearWidgetsErrors=function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearError()}},e.prototype.checkRules=function(){this.clearErrors(),this.clearWidgetsErrors(),this.checkFieldRules(),!0!==this.hasError&&this.checkContextRules()},e.prototype.addErrorWidget=function(e){this.errorWidgets.findIndex(function(t){return t===e})<0&&this.errorWidgets.push(e)},e.prototype.removeErrorWidget=function(e){var t=this.errorWidgets.findIndex(function(t){return t===e});t>=0&&this.errorWidgets.splice(t,1)},e.prototype.checkHasError=function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var e in this.subContexts){var t=this.subContexts[e];for(var n in t)if(!0===t[n].hasError)return!0}return!1},Object.defineProperty(e.prototype,"hasError",{get:function(){return this.checkHasError()},enumerable:!0,configurable:!0}),e.prototype.clearErrors=function(){this.errors.splice(0),this.errorWidgets.splice(0),this.clearContextErrors()},r.c([o.l],e.prototype,"errors",void 0),r.c([o.l],e.prototype,"errorWidgets",void 0),r.c([o.e],e.prototype,"hasError",null),e}(),L=1,D=function(e){function t(t,n,r,i){var o,s=this,a=t.uiSchema;if(void 0!==a){var u=a.items;void 0!==u&&(o=u[n.name])}return(s=e.call(this,t.form,o,r,i,!0)||this).parentContext=t,s.arrSchema=n,s.rowKey=L++,s.data=r,s}return r.d(t,e),t.prototype.getItemSchema=function(e){return this.arrSchema.itemSchemas[e]},t.prototype.getUiItem=function(e){if(void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)return t[e]}},Object.defineProperty(t.prototype,"arrName",{get:function(){return this.arrSchema.name},enumerable:!0,configurable:!0}),t.prototype.clearErrors=function(){e.prototype.clearErrors.call(this),this.parentContext.clearErrors()},Object.defineProperty(t.prototype,"parentData",{get:function(){return this.parentContext.data},enumerable:!0,configurable:!0}),t}(R),U=function(e){function t(t,n){return e.call(this,t,t.uiSchema,t.data,n,!1)||this}return r.d(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.form.data},enumerable:!0,configurable:!0}),t.prototype.getItemSchema=function(e){return this.form.itemSchemas[e]},t.prototype.getUiItem=function(e){var t=this.form.uiSchema;if(void 0!==t){var n=t.items;if(void 0!==n)return n[e]}},t}(R),B=i.createContext({}),M=Object(v.a)(function(e){var t,n,r,o,s=e.parentContext,u=e.arrSchema,c=e.children,l=u.name,h=u.arr,d=s.initData[l],p=s.form,f=s.getArrRowContexts(l),m=s.getUiItem(l),b=l,y=p.ArrContainer,g=p.RowContainer,w=p.RowSeperator,E=p.uiSchema;if(void 0!==E){var k=E.selectable,C=E.deletable,N=E.restorable;!0!==n&&(n=k),!0!==r&&(r=C),!0!==o&&(o=N)}if(void 0!==m){var P=m.widget,S=m.label,x=m.selectable,F=m.deletable,T=m.restorable,O=m.ArrContainer,V=m.RowContainer,I=m.RowSeperator;if(void 0!==x&&(n=x),void 0!==F&&(r=F),void 0!==T&&(o=T),void 0!==O&&(y=O),void 0!==V&&(g=V),void 0!==I&&(w=I),t=m.Templet,"arr"!==P)return j(u.type,P,["arr"]);b=S||b}var A=!0;return y(b,i.createElement(i.Fragment,null,d.map(function(e,l){var p,m,b=void 0;if(!1===A?b=w:A=!1,void 0!==c)p=new D(s,u,e,!0),m=i.createElement(i.Fragment,null,c);else{var y=typeof t;"function"===y?(p=new D(s,u,e,!0),m=i.createElement(Object(v.a)(t),e)):"object"===y?(p=new D(s,u,e,!0),m=t):(p=new D(s,u,e,!1),m=i.createElement(i.Fragment,null,h.map(function(e,t){return i.createElement(i.Fragment,{key:e.name},z(p,e,void 0))})))}var E,k,C=p.rowKey;if(f[C]=p,!0===n){E=i.createElement("div",{className:"form-row-checkbox"},i.createElement("input",{type:"checkbox",onClick:function(t){var n=t.target.checked;e.$isSelected=n;var r=e.$source;void 0!==r&&(r.$isSelected=n),p.clearErrors()},defaultChecked:e.$isSelected}))}var N=!(void 0===e.$isDeleted||!1===e.$isDeleted);if(!0===r){var P=N?"fa-undo":"fa-trash";k=i.createElement("div",{className:"form-row-edit text-info",onClick:function(){if(!0===o){e.$isDeleted=!N;var t=e.$source;void 0!==t&&(t.$isDeleted=!N)}else{var n=d.indexOf(e);n>=0&&d.splice(n,1)}p.clearErrors()}},i.createElement("i",{className:a()("fa",P,"fa-fw")}))}var S=!0===n||!0===r?function(t){return i.createElement("fieldset",{disabled:N},i.createElement("div",{className:a()("d-flex",{deleted:N,"row-selected":e.$isSelected})},E,i.createElement("div",{className:!0===n&&!0===r?"form-row-content":"form-row-content-1"},t),k))}:function(e){return e};return i.createElement(B.Provider,{key:C,value:p},b,g(S(i.createElement(i.Fragment,null,i.createElement(p.renderErrors,null),m))))})))}),_=n(21),H=n(38),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return r.b(t,void 0,void 0,function(){var e,t;return r.e(this,function(n){switch(n.label){case 0:return[4,(e=new H.a(this.itemSchema,this.ui,this.ui.label,this.value)).start()];case 1:return null!==(t=n.sent())&&(this.setValue(t),this.imageSrc=t),[4,e.end()];case 2:return n.sent(),[2]}})})},t.observerRender=Object(v.a)(function(){var e,n=["bg-white p-1 d-flex justify-content-center"];return t.readOnly||t.disabled||(n.push("cursor-pointer"),e=t.onClick),i.createElement("div",{className:a()(n),onClick:e},i.createElement(_.a,{src:t.imageSrc,className:"w-4c h-4c"}))}),t}return r.d(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.imageSrc=this.value},t.prototype.render=function(){return i.createElement(this.observerRender,null)},r.c([o.l],t.prototype,"imageSrc",void 0),t}(b),W={id:{dataTypes:["id"],widget:A},text:{dataTypes:["integer","number","string"],widget:y},textarea:{dataTypes:["string"],widget:g},password:{dataTypes:["string"],widget:w},date:{dataTypes:["date"],widget:P},datetime:{dataTypes:["date"],widget:S},time:{dataTypes:["date"],widget:x},month:{dataTypes:["date"],widget:F},select:{dataTypes:["integer","number","string","date","boolean"],widget:O},url:{dataTypes:["string"],widget:E},email:{dataTypes:["string"],widget:k},number:{dataTypes:["integer","number"],widget:C},updown:{dataTypes:["integer","number"],widget:N},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:T},image:{dataTypes:["string"],widget:$},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:V},range:{dataTypes:["integer"],widget:I},button:{dataTypes:["button","submit"],widget:q}};function z(e,t,n,r){if(void 0===e)return null;if(void 0!==t){var o,s=t.name,a=t.type;switch(a){case"arr":var u=e.getItemSchema(s);return i.createElement(M,{parentContext:e,arrSchema:u,children:n})}var c=e.getUiItem(s);if(void 0===c)o=p(a);else{var l=c.widget;switch(l){default:if(void 0!==l)o=W[l].widget;void 0===o&&(o=p(a));break;case"custom":o=c.WidgetClass;break;case"group":return i.createElement("span",null,"impletment group")}}e.isRow;var h=e.widgets,d=new o(e,t,r,n);return h[s]=d,i.createElement(d.container,null)}function p(e){switch(e){default:return y;case"id":return A;case"integer":return N;case"number":return C;case"string":return y;case"date":return P;case"boolean":return T;case"button":case"submit":return q}}}n(60);var K={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},Q=n(27),G=function(e){function t(t){var n=e.call(this,t)||this;n.watch=function(){void 0!==n.props.formData&&n.calcSelectOrDelete()},n.DefaultContainer=function(e){return i.createElement("form",{className:a()(n.props.className),onSubmit:function(e){return e.preventDefault()}},e)},n.DefaultFieldContainer=function(e,t){var r=n.props.fieldLabelSize;if(r>0){var o=void 0;null===e?r=0:o=i.createElement("label",{className:a()("col-sm-"+r,"col-form-label")},e);var s="col-sm-"+(12-r);return i.createElement("div",{className:"form-group row"},o,i.createElement("div",{className:s},t))}return i.createElement("div",{className:"form-group"},null===e?null:i.createElement("label",{className:"col-form-label"},e),t)},n.DefaultFieldClass=void 0,n.DefaultButtonClass="text-center py-2",n.DefaultRes=Object(Q.a)(K),n.ArrContainer=function(e,t){return i.createElement("div",null,i.createElement("div",{className:a()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},e),t)},n.RowContainer=function(e){var t=a()({"py-3":!0});return i.createElement("div",{className:t},e)},n.RowSeperator=i.createElement("div",{className:"border border-gray border-top"});var r=t.schema,s=t.uiSchema,u=(t.formData,t.Container),c=t.FieldContainer,l=t.FieldClass,h=t.ButtonClass,d=t.res;n.Container=u||n.DefaultContainer,n.FieldContainer=c||n.DefaultFieldContainer,n.FieldClass=void 0!==l&&""!==l&&null!==l?l:n.DefaultFieldClass,n.res=d||n.DefaultRes,n.ButtonClass=h||n.DefaultButtonClass,n.schema=r,n.itemSchemas={};for(var p=0,f=n.schema;p<f.length;p++){var m=f[p];n.itemSchemas[m.name]=m}return n.uiSchema=s,n.disposer=Object(o.d)(n.watch),n.data={},n}return r.d(t,e),t.prototype.renderContent=function(){var e=this;this.initData(this.props.formData);var t,n=this.props.children;return void 0!==n?(this.formContext=new U(this,!0),i.createElement(i.Fragment,null,n)):(void 0!==this.uiSchema&&(t=this.uiSchema.Templet),void 0!==t?(this.formContext=new U(this,!0),"function"===typeof t?t(this.data):t):(this.formContext=new U(this,!1),i.createElement(i.Fragment,null,this.schema.map(function(t,r){return i.createElement(i.Fragment,{key:r},z(e.formContext,t,n))}))))},t.prototype.initData=function(e){void 0===e&&(e={});for(var t=0,n=this.schema;t<n.length;t++){var r=n[t];this.initDataItem(r,this.data,e)}},t.prototype.initDataItem=function(e,t,n){var r=e.name,i=e.type;if("button"!==i)if("arr"===i){var s=e,a=s.arr;if(void 0!==a){for(var u=s.itemSchemas={},c=0,l=a;c<l.length;c++){u[(g=l[c]).name]=g}var h=n[r];void 0===h?h=[]:!1===Array.isArray(h)&&(h=[h]);for(var d=[],p=0,f=h;p<f.length;p++){for(var m=f[p],v={$source:m,$isSelected:m.$isSelected,$isDeleted:m.$isDeleted},b=0,y=a;b<y.length;b++){var g=y[b];this.initDataItem(g,v,m)}d.push(v)}t[r]=Object(o.l)(d)}}else t[r]=n[r]},t.prototype.calcSelectOrDelete=function(){for(var e=0,t=this.schema;e<t.length;e++){var n=t[e];this.arrItemOperated(n)}},t.prototype.arrItemOperated=function(e){var t=e.name;if("arr"===e.type&&void 0!==this.data){var n=this.data[t];if(void 0!==n)for(var r=e.arr,i=0,o=n;i<o.length;i++){var s=o[i],a=s.$source;if(void 0!==a){var u=a.$isSelected,c=a.$isDeleted;s.$isSelected=u,s.$isDeleted=c;for(var l=0,h=r;l<h.length;l++){var d=h[l];this.arrItemOperated(d)}}}}},t.prototype.componentDidMount=function(){var e=this.props.beforeShow;void 0!==e&&e(this.formContext)},t.prototype.componentWillUnmount=function(){void 0!==this.disposer&&this.disposer()},t.prototype.render=function(){var e=this.renderContent();return i.createElement(B.Provider,{value:this.formContext},i.createElement(this.formContext.renderErrors,null),this.Container(e))},t.prototype.buttonClick=function(e){return r.b(this,void 0,void 0,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return this.formContext.checkRules(),!0===this.formContext.hasError?[2]:void 0===(t=this.formContext.form.props.onButtonClick)?(alert("you should define form onButtonClick"),[2]):[4,t(e,this.formContext)];case 1:return void 0===(n=r.sent())?[2]:(this.formContext.setError(e,n),[2])}})})},t}(i.Component);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e=this.props,t=e.name,n=e.children,r=this.context;if(void 0===r)return i.createElement("span",{className:"text-danger"},"!only in Form!");var o=r.getItemSchema(t),s=z(r,o,n,this.props);return void 0===s?i.createElement("span",{className:"text-danger"},"!!",t," is not defined!!"):s},t.contextType=B}(i.Component);n.d(t,"a",function(){return G})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(5),s=n(6),a=n.n(s),u=(n(110),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e,t=this.props,n=t.className,r=t.badge,o=t.size,s=t.color,u=t.badgeAlign,c=t.badgeVertical,l=t.children,h=a()(n,"va-badge",o&&"va-badge-"+o,"va-badge-"+(s||"secondary"),u&&"va-badg-"+u,c&&"va-badg-"+c);return r&&(e=i.createElement("b",null,r)),i.createElement("div",{className:h},l,e)},t=r.c([o.a],t)}(i.Component),n(112),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(){var e,t,n,r=this.props,o=r.className,a=r.left,u=r.children,c=r.right,l=r.onClick;return void 0!==a&&(e=i.createElement("header",null,a)),void 0!==c&&(t=i.createElement("footer",null,c)),void 0!==l&&(n="cursor-pointer"),i.createElement("div",{className:s("va-lmr",o,n),onClick:l},e,i.createElement("div",null,u),t)},t=r.c([o.a],t)}(i.Component)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(){var e=this.props,t=e.name,n=e.className,r=e.size,o=e.spin,a=e.fixWidth,u=e.border,c=e.pull,l=e.pulse,h=e.rotate,d=e.flip,p=e.inverse,f=s(n,"fa",t&&"fa-"+t,r&&"fa-"+r,a&&"fa-fw",u&&"fa-border",c&&"fa-pull-"+c,o&&"fa-spin",l&&"fa-pulse",h&&"fa-rotate-"+h,d&&"fa-flip-"+d,p&&"fa-inverse");return i.createElement("i",{className:f})},t}(i.Component),l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.size,r=e.children,o=s("fa-stack",t,n&&"fa-"+n);return i.createElement("span",{className:o},r)}}(i.Component),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.iconClass,r=e.text,o=e.textClass;return i.createElement("div",{className:"py-2"},i.createElement(c,{className:n,name:t,fixWidth:!0}),i.createElement("span",{className:o},r))}}(i.Component),function(e){return i.createElement("small",{className:s("text-muted",e.className),style:e.style},e.children)});n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(8),s=n.n(o),a=n(5),u=n(9),c=n(16),l=n(24),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.newValue=e.target.value;var n=t.value;t.isChanged=t.newValue!=n},t.onBlur=function(e){t.verifyValue()},t.onFocus=function(){t.error=void 0},t.page=Object(a.a)(function(e){var n=e.resolve,r=(e.reject,i.createElement("button",{className:"btn btn-sm btn-success",disabled:!t.isChanged,onClick:function(){t.verifyValue(),void 0===t.error&&n(t.newValue)}},"\u4fdd\u5b58"));return i.createElement(c.a,{header:"\u66f4\u6539"+t.label,right:r},i.createElement("div",{className:"m-3"},i.createElement("input",{type:"text",onChange:t.onChange,onBlur:t.onBlur,onFocus:t.onFocus,className:"form-control",defaultValue:t.value}),t.uiItem&&i.createElement("div",{className:"small muted m-2"},t.uiItem.placeholder),t.error&&i.createElement("div",{className:"text-danger"},t.error)))}),t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(t){return[2,new Promise(function(t,n){var r=i.createElement(e.page,{resolve:t,reject:n});u.c.push(r,n)})]})})},t}(l.a),d=n(38),p=n(21),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.newValue=e;var n=t.value;t.isChanged=t.newValue!=n},t.page=Object(a.a)(function(e){var n=e.resolve,r=(e.reject,t.itemSchema.name),o=t.uiItem,s=o.list,a=o.defaultValue,u=i.createElement("button",{className:"btn btn-sm btn-success",disabled:!t.isChanged,onClick:function(){t.verifyValue(),void 0===t.error&&n(t.newValue)}},"\u4fdd\u5b58"),l=s?s.map(function(e,n){var o=e.title,s=e.value;return i.createElement("label",{key:n,className:"px-3 py-2 cursor-pointer"},i.createElement("input",{name:r,type:"radio",value:s,onClick:function(){return t.onChange(s)},defaultChecked:s===a})," ",o||s," \xa0")}):i.createElement(i.Fragment,null,"no list defined");return i.createElement(c.a,{header:"\u66f4\u6539"+t.label,right:u},i.createElement("div",{className:"m-3"},l))}),t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(t){return[2,new Promise(function(t,n){var r=i.createElement(e.page,{resolve:t,reject:n});u.c.push(r,n)})]})})},t}(l.a),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.newValue=e;var n=t.value;t.isChanged=t.newValue!=n},t.page=Object(a.a)(function(e){var n=e.resolve,r=(e.reject,t.uiItem.list),o=r?r.map(function(e,r){var o=e.title,s=e.value;return i.createElement("div",{key:r,className:"px-3 py-2 cursor-pointer bg-white mb-1",onClick:function(){t.onChange(s),n(t.newValue)}},o||s)}):i.createElement(i.Fragment,null,"no list defined");return i.createElement(c.a,{header:"\u66f4\u6539"+t.label},i.createElement("div",{className:"my-3"},o))}),t}return r.d(t,e),t.prototype.internalStart=function(){return r.b(this,void 0,Promise,function(){var e=this;return r.e(this,function(t){return[2,new Promise(function(t,n){var r=i.createElement(e.page,{resolve:t,reject:n});u.c.push(r,n)})]})})},t}(l.a),v=n(4),b=function(e){function t(t){var n=e.call(this,t)||this;n.defaultSepClassName="border-top edit-sep-light-gray",n.defaultRowContainerClassName="d-flex px-3 py-2 bg-white align-items-center",n.data={},n.rowClick=function(e,t,i,o){return r.b(n,void 0,void 0,function(){var n,s,a,u,c;return r.e(this,function(r){switch(r.label){case 0:return n=this.props,s=n.onItemChanged,a=n.onItemClick,!0===n.stopEdit?[2]:void 0===a?[3,2]:[4,a(e,t,o)];case 1:return r.sent(),[2];case 2:if(void 0===(c=function(e,t,n,r){var i;if(void 0!==t)switch(t.widget){default:break;case"text":i=h;break;case"image":i=d.a;break;case"radio":i=f;break;case"select":i=m}if(void 0===i)switch(e.type){case"string":i=h;break;case"image":i=d.a}if(void 0===i)return;return new i(e,t,n,r)}(e,t,i,o)))return alert("undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);"),[2];r.label=3;case 3:return r.trys.push([3,9,,10]),[4,c.start()];case 4:return(u=r.sent())==o?[3,7]:(this.data[e.name]=o,void 0!==s?[3,5]:(alert(e.name+" value changed, new: "+u+", pre: "+o),[3,7]));case 5:return[4,s(e,u,o)];case 6:r.sent(),r.label=7;case 7:return[4,c.end()];case 8:return r.sent(),[3,10];case 9:return r.sent(),console.log("no value changed"),[3,10];case 10:return[2]}})})};var o=t.topBorderClassName,a=t.bottomBorderClassName,u=t.sepClassName,c=t.rowContainerClassName,l=t.uiSchema,p=t.stopEdit;return n.topBorder=i.createElement("div",{className:o||n.defaultSepClassName}),n.bottomBorder=i.createElement("div",{className:a||n.defaultSepClassName}),n.rowContainerClassName=c||n.defaultRowContainerClassName,!0!==p&&(n.rowContainerClassName+=" cursor-pointer"),n.sep=i.createElement("div",{className:u||n.defaultSepClassName}),n.uiSchema=l&&l.items||{},s.a.mergeWith(n.data,n.props.data),n}return r.d(t,e),t.prototype.render=function(){var e=[],t=this.props.schema,n=t.length;e.push(this.topBorder);for(var r=0;r<n;r++)r>0&&e.push(this.sep),e.push(this.renderRow(t[r]));return e.push(this.bottomBorder),i.createElement("div",null,e.map(function(e,t){return i.createElement(i.Fragment,{key:t},e)}))},t.prototype.renderRow=function(e){var t,n=this,o=e.name,s=e.type,a=e.required,u=this.uiSchema[o],c=u&&u.label||o,l=this.data[o];if(void 0!==u&&l)switch(u.widget){case"radio":case"select":var h=u.list;t=i.createElement("b",null,h.find(function(e){return e.value===l}).title)}if(void 0===t)switch(s){default:t=l?i.createElement("b",null,l):i.createElement("small",{className:"text-muted"},"(\u65e0)");break;case"image":t=i.createElement(p.a,{className:"w-4c h-4c",src:l})}var d=!0===a&&i.createElement("span",{className:"text-danger"},"*");return i.createElement("div",{className:this.rowContainerClassName,onClick:function(){return r.b(n,void 0,void 0,function(){return r.e(this,function(t){switch(t.label){case 0:return[4,this.rowClick(e,u,c,l)];case 1:return[2,t.sent()]}})})}},i.createElement("div",{className:"w-6c"},c," ",d),i.createElement("div",{className:"flex-fill d-flex justify-content-end"},t),!0!==this.props.stopEdit&&i.createElement("div",{className:"w-2c text-right"},i.createElement("i",{className:"fa fa-chevron-right"})))},r.c([v.l],t.prototype,"data",void 0),t=r.c([a.a],t)}(i.Component);n.d(t,"a",function(){return b})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=n(5),u=n(4),c=function(){function e(e){this.list=e}return Object.defineProperty(e.prototype,"isPaged",{get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loading",{get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItems",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.updateProps=function(e){},e.prototype.renderContent=function(e,t){var n=this.list.props.item.render;return void 0===n?i.createElement("div",{className:"px-3 py-2"},JSON.stringify(e)):n(e,t)},r.c([u.e],e.prototype,"loading",null),e}(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,s=n.key,a=n.onClick;return i.createElement("li",{key:void 0===s?t:s(e),className:o("va-row-clickable",r),onClick:function(){return a&&a(e)}},this.renderContent(e,t))},t}(c),h=n(20),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e,t){var n=this.list.props.item,r=n.className,s=n.key;n.render;if("string"===typeof e){var a=o("va-list-gap","px-3","pt-1");return i.createElement("li",{key:Object(h.a)(),className:a},e)}return i.createElement("li",{key:void 0===s?t:s(e),className:o(r)},this.renderContent(e,t))},t}(c),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.buildItems=function(){console.log("buildItems in selectable.tsx");var e,t=this.list.props,n=t.items,r=t.selectedItems,i=t.compare;return void 0===n?this._items=void 0:null===n?this._items=null:(e=!0===Array.isArray(n)?n:n.items,this._selectedItems=r,this._items=void 0===r?e.map(function(e){return{selected:!1,item:e,labelId:Object(h.a)()}}):void 0===i?e.map(function(e){return{selected:void 0!==r.find(function(t){return t===e}),item:e,labelId:Object(h.a)()}}):e.map(function(e){return{selected:void 0!==r.find(function(t){return i(e,t)}),item:e,labelId:Object(h.a)()}}))},Object.defineProperty(t.prototype,"items",{get:function(){return this.buildItems(),this._items},enumerable:!0,configurable:!0}),t.prototype.updateProps=function(e){e.selectedItems!==this._selectedItems&&this.buildItems()},t.prototype.onSelect=function(e,t){e.selected=t;var n=this._items.some(function(e){return e.selected});this.list.props.item.onSelect(e.item,t,n)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this._items.filter(function(e){return!0===e.selected}).map(function(e){return e.item})},enumerable:!0,configurable:!0}),t.prototype.render=function(e,t){var n=this,r=this.list.props.item,s=r.className,a=r.key,u=(r.render,r.onSelect,e.labelId),c=e.selected;return i.createElement("li",{key:void 0===a?t:a(e),className:o(s)},i.createElement("div",{className:"d-flex align-items-center px-3"},i.createElement("input",{ref:function(e){e&&(n.input=e,e.checked=c)},className:"",type:"checkbox",value:"",id:u,defaultChecked:c,onChange:function(t){n.onSelect(e,t.target.checked)}}),i.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:u},this.renderContent(e.item,t))))},r.c([u.e],t.prototype,"items",null),t}(c);n(108);n.d(t,"a",function(){return f});var f=function(e){function t(t){var n=e.call(this,t)||this;n._$scroll=function(e){console.log("############### items scroll to "+e)};var r=n.props.item,i=r.onClick,o=r.onSelect;return n.listBase=void 0!==o?new p(n):void 0!==i?new l(n):new d(n),n}return r.d(t,e),t.prototype.componentWillUpdate=function(e,t,n){this.listBase.updateProps(e)},Object.defineProperty(t.prototype,"selectedItems",{get:function(){return this.listBase.selectedItems},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.header,o=t.footer,a=t.before,u=t.loading,c=t.none;t.item,t.selectedItems;void 0===a&&(a="before"),void 0===u&&(u="loading"),void 0===c&&(c="none");var l,h=this.listBase,d=(h.isPaged,h.items);h.loading;function p(e,t){if(e)switch(typeof e){default:case"string":return i.createElement("li",{className:"va-list-"+t},e);case"function":return i.createElement("li",{className:"va-list-"+t},e());case"object":return i.createElement("li",null,e)}}return l=null===d?p(a,"before"):void 0===d?p(u,"loading"):0===d.length?p(c,"none"):d.map(function(t,n){return e.listBase.render(t,n)}),i.createElement("ul",{className:s()("va-list",n)},p(r,"header"),l,p(o,"footer"))},t=r.c([a.a],t)}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n.n(o),a=function(){function e(){}return e.prototype.setValues=function(e){},e}(),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(e){return i.createElement("div",{key:"_b_"+e,className:""},i.createElement("div",{className:"w-100"},i.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))},t}(a),c=function(e){function t(t){var n=e.call(this)||this;return n.param=t,n}return r.d(t,e),t.prototype.render=function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=s()(t);return i.createElement("div",{key:"_g_"+e,className:n,style:{backgroundColor:"#f0f0f0"}})},t}(a),l=function(e){function t(t,n){var r=e.call(this)||this;return r.gridProps=t,r.prop=n,r.col=!0===t.labelFixLeft?"col":"col-sm",r}return r.d(t,e),t.prototype.render=function(e){var t=this.prop,n=t.onClick,r=t.bk,o=s()({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return i.createElement("div",{key:e,className:o,onClick:n},this.renderLabel(),this.renderProp())},t.prototype.renderLabel=function(){var e=this.prop.label;return void 0===e?null:i.createElement("label",{className:this.col+"-3 col-form-label"},e)},t.prototype.renderProp=function(){var e,t,n=this.prop.label;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var r=this.col+(void 0===n?"-12":"-9"),o=s()(e,t,r,"d-flex");return i.createElement("div",{className:o},this.renderPropBody())},t.prototype.renderPropBody=function(){return i.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())},t.prototype.renderPropContent=function(){return this.content},t}(a),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(l),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setValues=function(e){this.content=void 0===e?void 0:e[this.prop.name]},t}(l),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.setValues=function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}},t.prototype.renderPropBody=function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?i.createElement("div",null):i.createElement("div",{className:"w-100"},r.map(function(e,t){return i.createElement(i.Fragment,{key:t},0===t?null:i.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),i.createElement(n,e))}))},t}(l),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.renderPropBody=function(){return this.prop.component},t.prototype.renderProp=function(){var e,t,n,r=this.prop,o=r.label,a=r.full;switch(this.gridProps.alignValue){case"left":e="justify-content-start";break;case"center":e="justify-content-center";break;case"right":e="justify-content-end"}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}n=!0!==a?this.col+(void 0===o?"-12":"-9"):"w-100";var u=s()(e,t,n,"d-flex");return i.createElement("div",{className:u},this.renderPropBody())},t}(l),m=function(){function e(e,t){this.gridProps=e,this.props=t,this.buildRows()}return e.prototype.buildRows=function(){this.rows=[];for(var e=!0,t=0,n=this.props;t<n.length;t++){var r=n[t];if("string"===typeof r)this.rows.push(new c(r)),e=!0;else{e||this.rows.push(new u);var i=void 0;switch(r.type){default:continue;case"string":i=new h(this.gridProps,r);break;case"number":i=new d(this.gridProps,r);break;case"list":i=new p(this.gridProps,r);break;case"component":i=new f(this.gridProps,r)}this.rows.push(i),e=!1}}},e.prototype.setValues=function(e){for(var t=0,n=this.rows;t<n.length;t++){n[t].setValues(e)}},e.prototype.render=function(){return this.rows.map(function(e,t){return e.render(String(t))})},e}(),v=n(5),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.rows,r=e.values,o=new m(this.props,n);o.setValues(r);var a=s()("container-fluid",t);return i.createElement("div",{className:a},o.render())},t=r.c([v.a],t)}(i.Component);n.d(t,"a",function(){return b})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(6),s=n(5),a=(n(114),function(e){function t(t){var n=e.call(this,t)||this;return n.state={pressed:!1},n}return r.d(t,e),t.prototype.render=function(){var e,t,n,r,s,a,u=this.props,c=(u.date,u.main),l=u.vice,h=u.middle,d=u.midSize,p=u.icon,f=u.unread,m=u.right,v=u.onClick;if(void 0!==f){var b=void 0;(b="number"===typeof f?f:f.get())>0?n=i.createElement("b",null,b):b<0&&(n=i.createElement("b",{className:"dot"}))}switch(typeof p){case"object":e=i.createElement("header",null,p,n),t=!1;break;case"string":e=i.createElement("header",{className:"icon"},i.createElement("img",{src:p}),n),t=!0}if(void 0!==h)switch(typeof h){case"string":r=i.createElement("div",{style:{flex:d}},h);break;default:r=h}void 0!==m&&(s="string"===typeof m?i.createElement("footer",null,i.createElement("small",{className:"text-muted"},m)):i.createElement("footer",null,m)),void 0!==l&&(a=i.createElement("span",null,l));var y=o("va-row",{icon:t,pressed:this.state.pressed},{"va-action":void 0!==v});return i.createElement("li",{className:y,onClick:v},e,i.createElement("div",null,i.createElement("div",null,c),a),r,s)},t=r.c([s.a],t)}(i.Component));!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.d(t,e),t.prototype.render=function(){var e,t,n=this,s=this.props,u=s.header,c=s.items,l=s.beforeLoad,h=s.none,d=s.renderRow,p=s.className,f=s.footer,m=s.itemClick,v=s.converter,b=o(p,"va-list");return e=void 0===c?null===l?null:i.createElement("li",{className:"empty"},l||"..."):0===c.length?i.createElement("li",{className:"empty"},h||"[none]"):void 0!==d?c.map(function(e,t){return d(e,t,n.props.ex)}):c.map(function(e,t){var n,o=e.onClick;if(void 0===o&&void 0!==m&&(o=function(){return m(e)}),void 0!==v){if(void 0===(n=v(e)))return null}else n=r.a({},e);return void 0===n.key&&(n.key=n.main),i.createElement(a,r.a({onClick:o},n))}),void 0!==u&&(t="string"===typeof u?i.createElement("div",{className:"va-list-header"},u):u),i.createElement("div",{className:b},t,i.createElement("ul",null,e),f)},t=r.c([s.a],t)}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(5),a=n(6),u=n.n(a),c=function(){function e(){}return Object.defineProperty(e.prototype,"content",{get:function(){return!0!==this.selected?this._content:void 0!==this._content?this._content:this._content=this.contentBuilder()},enumerable:!0,configurable:!0}),r.c([o.l],e.prototype,"selected",void 0),e}(),l=function(e,t,n){return i.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},i.createElement("div",null,i.createElement("i",{className:"fa fa-lg fa-"+t})),i.createElement("small",null,e))},h=function(e){function t(t){var n,r=e.call(this,t)||this;r.tabs=[],r.tabClick=function(e){r.selectedTab.selected=!1,e.selected=!0,r.selectedTab=e};var i=r.props,o=i.size,s=i.tabs,a=i.tabBack,u=i.contentBack,l=i.sep,h=i.selected;switch(o){default:case"md":r.size="3.2rem";break;case"sm":r.size="4rem";break;case"lg":r.size="2.5rem"}return(n=r.tabs).push.apply(n,s.map(function(e){var t=new c;return t.name=e.name,t.selected=!1,t.caption=e.caption,t.contentBuilder=e.content,t.notify=e.notify,t})),r.tabBack=a||"bg-light",r.contentBack=u,r.sep=l||"border-top border-gray",void 0!==h&&(r.selectedTab=r.tabs.find(function(e){return e.name===h})),void 0===r.selectedTab&&(r.selectedTab=r.tabs[0]),r.selectedTab.selected=!0,r}return r.d(t,e),t.prototype.showTab=function(e){var t=this.tabs.find(function(t){return t.name===e});void 0!==t&&(void 0!==this.selectedTab&&(this.selectedTab.selected=!1),t.selected=!0,this.selectedTab=t)},t.prototype.render=function(){var e=this;return i.createElement("div",{className:"tab"},i.createElement("div",{className:this.contentBack,style:{height:"calc(100% - "+this.size+")"}},this.tabs.map(function(e,t){var n={display:!0===e.selected?void 0:"none"};return i.createElement("div",{key:t,style:n},e.content)})),i.createElement("div",{className:u()(this.tabBack,this.sep),style:{height:this.size}},this.tabs.map(function(t,n){var r,o=t.selected,s=t.caption,a=t.notify;if(void 0!==a){var u=a.get();void 0!==u&&(u>0?r=i.createElement("u",null,u>99?"99+":u):u<0&&(r=i.createElement("u",{className:"dot"})))}return i.createElement("div",{key:n,className:"",onClick:function(){return e.tabClick(t)}},i.createElement("div",{className:"align-self-center"},r,s(o)))})))},r.c([o.l],t.prototype,"selectedTab",void 0),r.c([o.l],t.prototype,"tabs",void 0),t=r.c([s.a],t)}(i.Component);n.d(t,"a",function(){return l}),n.d(t,"b",function(){return h})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(4),s=n(14),a=n(56);!function(e){function t(t){var n=e.call(this,t)||this;n.schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],n.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},n.onItemChanged=function(e,t,i){return r.b(n,void 0,void 0,function(){var n;return r.e(this,function(r){switch(r.label){case 0:return n=e.name,[4,a.a.userSetProp(n,t)];case 1:return r.sent(),this.data[n]=t,s.nav.user[n]=t,s.nav.saveLocalUser(),[2]}})})};var i=s.nav.user,o=i.nick,u=i.icon;return n.data={nick:o,icon:u},n}r.d(t,e),t.prototype.render=function(){return i.createElement(s.Page,{header:"\u4e2a\u4eba\u4fe1\u606f"},i.createElement(s.Edit,{schema:this.schema,uiSchema:this.uiSchema,data:this.data,onItemChanged:this.onItemChanged}))},r.c([o.l],t.prototype,"data",void 0)}(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1),o=n(11),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.reApi=function(){return r.b(t,void 0,void 0,function(){var e,t,n,i,s,a;return r.e(this,function(r){switch(r.label){case 0:return this.props.clearError(),e=this.props,t=e.channel,n=e.url,i=e.options,s=e.resolve,a=e.reject,[4,Object(o.n)(t,n,i,s,a)];case 1:return r.sent(),[2]}})})},t.close=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return this.props.clearError(),[2]})})},t}return r.d(t,e),t.prototype.render=function(){var e,t=this.props,n=t.error,r=t.url;if("object"===typeof n){var o=[];for(var s in n)o.push(i.createElement("li",{key:s},i.createElement("label",null,s),i.createElement("div",null,n[s])));e=i.createElement("ul",null,o)}else e=i.createElement("div",null,n);return i.createElement("li",null,i.createElement("article",{className:"page-container"},i.createElement("section",null,i.createElement("div",{className:"va-error"},i.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),i.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),i.createElement("div",null,"url: ",r),e,i.createElement("div",{className:"p-3"},i.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),i.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed"))))))},t}(i.Component);t.a=s},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=function(){function e(e){this.name=e}return e.prototype.get=function(){if(void 0!==this.value)return this.value;var e=localStorage.getItem(this.name);return this.value=null===e?void 0:JSON.parse(e)},e.prototype.set=function(e){e?(this.value=e,localStorage.setItem(this.name,JSON.stringify(e))):this.clear()},e.prototype.clear=function(){this.value=void 0,localStorage.removeItem(this.name)},e}(),i=function(){function e(){this.user=new r("user"),this.guest=new r("guest"),this.unit=new r("unit"),this.homeTabCur=new r("homeTabCur")}return e.prototype.logoutClear=function(){[this.user,this.unit,this.homeTabCur].map(function(e){return e.clear()})},e}()},,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.ee7cd8ed.svg"},function(e,t,n){e.exports=n(122)},,,,,function(e,t,n){},,,,,,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,,,,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(30),o=n(0),s=(n(97),n(2)),a=n(10),u={tuid:{salestask:{content:function(e){var t=e.desciption,n=e.customer,i=e.type,o=e.sourceid;return r.createElement(r.Fragment,null,Object(a.tv)(t),Object(a.tv)(n),Object(a.tv)(i),Object(a.tv)(o))}}}},c=n(6),l=n.n(c),h=n(3),d=n(5),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScrollBottom=function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){return[2]})})},t.onSalesTaskClick=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){return this.controller.showTaskDetailEdit(e),[2]})})},t.onSalesTaskAdd=function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.createTask()];case 1:return e.sent(),[2]}})})},t.renderSalesTask=function(e,n){e.description;var i=e.deadline,o=(e.createTime,e.customer),s=e.type,u=e.typeName,c=e.priorty,d=l()({"my-1 mr-3":!0,"text-danger":c>0,"text-info":!(c>0)}),p=r.createElement("div",{className:d},t.controller.taskIcon(u)),f=r.createElement("div",{className:"text-right"},i&&r.createElement("small",{className:"text-muted"},"\u65f6\u9650\uff1a",r.createElement(h.EasyDate,{date:i})));return r.createElement(h.LMR,{className:"px-3 py-2",left:p},r.createElement(h.LMR,{className:"",right:f},r.createElement("div",{className:"font-weight-bold"},Object(a.tv)(o,function(e){return r.createElement(r.Fragment,null,e.name)}))),r.createElement("div",{className:"text-muted"},Object(a.tv)(s,function(e){return r.createElement(r.Fragment,null,e.name)})))},t.page=Object(d.a)(function(){var e=t.controller.tasks;if(void 0===e)return null;var n=r.createElement("div",{className:"my-3 mx-2 text-muted"},"\u65e0\u4efb\u52a1"),i=r.createElement("div",{onClick:t.onSalesTaskAdd,className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),o=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:i},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u9500\u552e\u52a9\u624b")),a={render:t.renderSalesTask,onClick:t.onSalesTaskClick},u=e.tasksNow,c=e.dateTasksList;return r.createElement(s.Page,{header:o,onScrollBottom:t.onScrollBottom},u.length>0&&r.createElement(h.List,{before:"",none:n,items:u,item:a}),c.map(function(e,t){var i=e.date,o=e.list;return 0===o.length?null:r.createElement(r.Fragment,{key:t},r.createElement("div",{className:"small text-muted pt-3 px-3 pb-2 text-center"},r.createElement(h.EasyDate,{date:i})),r.createElement(h.List,{before:"",none:n,items:o,item:a}))}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return[2]})})},t.prototype.render=function(e){return r.createElement(this.page,null)},t}(s.VPage),f=n(4),m=[{name:"resulttype",type:"id",required:!1},{name:"result",type:"string",required:!0}],v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiSchema={items:{resulttype:{visible:!1},result:{widget:"textarea",label:"\u7ed3\u679c",placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u7ed3\u679c\uff01",rows:12},submit:{widget:"button",label:"\u63d0\u4ea4"}}},t.onCompletionTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){var e,t,r;return o.e(this,function(i){switch(i.label){case 0:return e=n.form.data,t=e.result,r=e.resulttype,[4,this.controller.completionTask(this.task,t,r)];case 1:return i.sent(),this.closePage(2),[2]}})})},t.page=Object(d.a)(function(e){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:t.onCompletionTask},"\u5b8c\u7ed3");return r.createElement(s.Page,{header:"\u5b8c\u7ed3",footer:n},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:m,uiSchema:t.uiSchema,onButtonClick:t.onFormButtonClick})))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.task=e,this.openPage(this.page,e),[2]})})},t}(s.VPage),b=[{name:"resulttype",type:"string",required:!1},{name:"date",type:"date",required:!0},{name:"result",type:"string",required:!1}],y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiSchema={items:{resulttype:{visible:!1},date:{widget:"date",label:"\u65e5\u671f",placeholder:"\u8bf7\u8f93\u5165\u65e5\u671f\uff01"},result:{widget:"textarea",label:"\u539f\u56e0",placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u7ed3\u679c\uff01",rows:12},submit:{widget:"button",label:"\u63d0\u4ea4"}}},t.onExtensionTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){var e,t,r,i;return o.e(this,function(o){switch(o.label){case 0:return e=n.form.data,t=e.result,r=e.resulttype,i=e.date,[4,this.controller.extensionTask(this.task,t,r,i)];case 1:return o.sent(),this.closePage(2),[2]}})})},t.page=Object(d.a)(function(e){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:t.onExtensionTask},"\u5b8c\u7ed3");return r.createElement(s.Page,{header:"\u63a8\u8fdf",footer:n},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:b,uiSchema:t.uiSchema,onButtonClick:t.onFormButtonClick})))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.task=e,this.openPage(this.page,e),[2]})})},t}(s.VPage),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderHistory=function(e,t){var n=e.date,i=e.status,o=e.principal,u=e.result;return r.createElement("div",{className:"d-block p-3"},r.createElement(h.LMR,{right:o.id!==s.nav.user.id&&r.createElement("span",{className:"text-muted small"},Object(a.tv)(o))},r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement(h.EasyDate,{date:n})," ",Object(a.tv)(i,function(e){return e.name})))),r.createElement("div",null,u))},t.page=Object(d.a)(function(e){var n=r.createElement("div",{className:"m-3 text-muted small"},"\u3010\u672a\u5904\u7406\u3011");return r.createElement(s.Page,{header:"\u5904\u7406\u8be6\u60c5"},r.createElement(h.List,{before:"",none:n,items:e.tasks,item:{render:t.renderHistory}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t}(s.VPage),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.render=function(e){var t=this,n=this.controller.cSalesTask,i=n.showCustomerDetail,s=n.showTaskHistory,u=(e.type,e.customer),c=e.description,l=e.deadline,d=e.id,p=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"w-100 py-3",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,i(u.id)];case 1:return[2,e.sent()]}})})},left:r.createElement("div",{className:"mr-2"}," ",r.createElement(h.FA,{name:"user",className:"text-info mr-2 pt-1"})," "),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))},Object(a.tv)(u,function(e){return r.createElement(r.Fragment,null,e.name)}))},{type:"component",name:"deadline",component:r.createElement(h.LMR,{className:"w-100 py-2",left:r.createElement("div",{className:"mr-2"}," ",r.createElement(h.FA,{name:"clock-o",className:"text-info mr-2 pt-1 "})," ")},r.createElement(h.EasyDate,{date:l}))},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,s(d)];case 1:return[2,e.sent()]}})})},left:r.createElement("span",null,r.createElement(h.FA,{className:"text-warning",name:"hand-o-right"})," \xa0 \u8be6\u60c5"),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))})}];return c&&p.push({type:"component",name:"description",component:r.createElement("div",{className:"w-100 py-3"},c)}),r.createElement(h.PropGrid,{className:"my-2",rows:p,values:e})},t}(s.View),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.render=function(e){var t=this,n=this.controller.cSalesTask.showCustomerDetail,i=e.customer,s=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer my-2 w-100",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,n(i.id)];case 1:return[2,e.sent()]}})})},left:r.createElement("div",{className:"mr-2"}," ",r.createElement(h.FA,{name:"user",className:"text-info mr-2 pt-1 "})," "),right:r.createElement("div",{className:"w-2c text-right"},r.createElement("i",{className:"fa fa-chevron-right"}))},Object(a.tv)(i,function(e){return r.createElement(r.Fragment,null,e.name)}))}];return r.createElement(h.PropGrid,{className:"my-2",rows:s,values:e})},t}(s.View),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.render=function(e){var t=this,n=this.controller.cSalesTask,i=n.showTaskComplet,s=n.showTaskExtension,a=n.showTaskInvalid;return r.createElement("div",{className:"d-flex px-1"},r.createElement("div",{className:"flex-grow-1 align-self-center justify-content-start"},r.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,i(e)];case 1:return[2,t.sent()]}})})}},"\xa0\u5904\u7406\xa0")),r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2 align-self-center",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,s(e)];case 1:return[2,t.sent()]}})})}},"\u63a8\u8fdf"),r.createElement("button",{type:"button",className:"btn btn-outline-info ml-2 align-self-center",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,a(e)];case 1:return[2,t.sent()]}})})}},"\u53d6\u6d88"))},t}(s.View),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.render=function(e){var t=e.fields;return void 0===t?r.createElement(r.Fragment,null):r.createElement(r.Fragment,null,t.map(function(e,t){var n=e.fieldName,i=e.value,o=r.createElement("div",{className:"ml-4"},n),s=r.createElement("div",{className:"mr-4"},i);return r.createElement(h.LMR,{className:"bg-white row",left:o,right:s})}))},t}(s.View),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon="plus",t.renderDetailEdit=function(e){var n=t,i=n.caption,o=n.renderDetailTop,a=n.renderActionsBottom,u=n.renderContent;return r.createElement(s.Page,{header:i,footer:a(e)},o(e),u(e))},t.renderDetailValues=function(e){var n=t,i=n.caption,o=n.renderDetailTop,a=n.renderContent;return r.createElement(s.Page,{header:i},o(e),a(e))},t.renderDetailTop=function(e){return t.renderView(w,e)},t.renderContent=function(e){return t.renderView(C,e)},t.renderActionsBottom=function(e){return t.renderView(k,e)},t.renderCreateTop=function(e){return t.renderView(E,e)},t}return o.d(t,e),t.prototype.showDetailFromId=function(e){return o.b(this,void 0,Promise,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.cSalesTask.loadTask(e)];case 1:return t=n.sent(),this.openPage(this.renderDetailValues(t)),[2]}})})},t.prototype.showDetailEdit=function(e){return o.b(this,void 0,Promise,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.cSalesTask.loadTask(e.id)];case 1:return t=n.sent(),this.openPage(this.renderDetailEdit(t)),[2]}})})},t.prototype.showCreate=function(e){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return this.openPage(r.createElement(s.Page,{header:e.typeName},"\u6ca1\u6709\u7ee7\u627fshowCreate\uff01")),[2]})})},t}(s.Controller),P=[{name:"id",type:"id",required:!1},{name:"customer",type:"id",required:!1},{name:"type",type:"id",required:!1},{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!1}],S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiSchema={items:{id:{visible:!1},customer:{visible:!1},type:{visible:!1},description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},t.onAddSalesTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.cSalesTask.addTask(n.form.data,this.task)];case 1:return e.sent(),this.closePage(1),[2]}})})},t.page=Object(d.a)(function(e){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:t.onAddSalesTask},"\u4fdd\u5b58");return r.createElement(s.Page,{header:t.controller.caption,footer:n},r.createElement("div",{className:"App-container container text-left"},t.controller.renderCreateTop(e),r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:P,uiSchema:t.uiSchema,onButtonClick:t.onFormButtonClick,requiredFlag:!1})))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.task=e,this.openPage(this.page,e),[2]})})},t}(s.VPage),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=r.createElement(h.FA,{name:"flask",size:"lg",fixWidth:!0}),t}return o.d(t,e),t.prototype.internalStart=function(e){},t.prototype.showCreate=function(e){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return this.openVPage(S,e),[2]})})},t}(N),F=[{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!1}],T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiSchema={items:{description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"}}},t.onAddSalesTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.cSalesTask.addTask(n.form.data,this.salestask)];case 1:return e.sent(),this.closePage(1),[2]}})})},t.page=Object(d.a)(function(e){return t.render(e)}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.salestask=e,this.openPage(this.page,e),[2]})})},t.prototype.render=function(e){var t=this,n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:this.onAddSalesTask},"\u4fdd\u5b58");return r.createElement(s.Page,{header:this.controller.caption,footer:n},r.createElement("div",{className:"App-container container text-left"},this.controller.renderCreateTop(e),r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:F,uiSchema:this.uiSchema,onButtonClick:this.onFormButtonClick,requiredFlag:!1})))},t}(s.VPage),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.internalStart=function(e){},t.prototype.showCreate=function(e){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return this.openVPage(T,e),[2]})})},t}(N),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=r.createElement(h.FA,{name:"flask",size:"lg",fixWidth:!0}),t.caption="\u5927\u5305\u88c5\u62a5\u4ef7\u8ddf\u8e2a",t}return o.d(t,e),t.prototype.internalStart=function(e){},t.prototype.showCreate=function(e){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return this.openVPage(T,e),[2]})})},t}(N),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAddSalesTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.cSalesTask.addTask(n.form.data,this.salestask)];case 1:return e.sent(),this.closePage(1),[2]}})})},t.page=Object(d.a)(function(e){return t.render(e)}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.salestask=e,this.openPage(this.page,e),[2]})})},t.prototype.render=function(e){var t=this,n=this.controller.taskCommonType,i=n.schema,o=n.uiSchema,a=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:this.onAddSalesTask},"\u4fdd\u5b58");return r.createElement(s.Page,{header:this.controller.caption,footer:a},r.createElement("div",{className:"App-container container text-left"},this.controller.renderCreateTop(e),r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:i,uiSchema:o,onButtonClick:this.onFormButtonClick,requiredFlag:!1})))},t}(s.VPage),A=function(e){function t(t,n){var r=e.call(this,n)||this;return r.taskCommonType=t,r.icon=t.icon,r.caption=t.caption,r}return o.d(t,e),t.prototype.internalStart=function(e){},t.prototype.showCreate=function(e){return o.b(this,void 0,Promise,function(){return o.e(this,function(t){return this.openVPage(I,e),[2]})})},t}(N),j={typeA:O,"\u8bd5\u5242\u62a5\u4ef7\u8ddf\u8e2a":x,"\u5927\u5305\u88c5\u62a5\u4ef7\u8ddf\u8e2a":V,common1:{caption:"Common1",icon:r.createElement(h.FA,{name:"flask",size:"lg",fixWidth:!0}),schema:[{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!1}],uiSchema:{items:{description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"}}}},common2:{caption:"Common2",icon:r.createElement(h.FA,{name:"plus",size:"lg",fixWidth:!0}),schema:[{name:"description",type:"string",required:!1},{name:"priorty",type:"number",required:!1},{name:"deadline",type:"string",required:!1},{name:"description1",type:"string",required:!1},{name:"description2",type:"number",required:!1}],uiSchema:{items:{description:{widget:"text",label:"\u5185\u5bb9",placeholder:"\u8bf7\u586b\u5199\u4efb\u52a1\u5185\u5bb9"},priorty:{widget:"checkbox",label:"\u91cd\u8981\u6027",placeholder:"\u91cd\u8981\u6027"},deadline:{widget:"date",label:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4",placeholder:"\u8981\u6c42\u5b8c\u6210\u65f6\u95f4"},submit:{widget:"button",label:"\u63d0\u4ea4"},description2:{widget:"radio",label:"\u63cf\u8ff02",defaultValue:1,list:[{value:0,title:"\u5973"},{value:1,title:"\u7537"}]}}}}};var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderList=function(e,n){e.description;var i=e.name,o=r.createElement("div",{className:"text-info mr-3"},t.controller.cSalesTask.taskIcon(i));return r.createElement(h.LMR,{className:"px-3 py-2",left:o},r.createElement("div",{className:"font-weight-bold"},i))},t.onClickTaskType=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.selectTaskType(e)];case 1:return t.sent(),this.ceasePage(1),[2]}})})},t.ai=function(){return r.createElement(h.LMR,{className:"p-3 bg-white mb-1 cursor-pointer",left:r.createElement(h.FA,{className:"text-success mr-3 mt-1",name:"android",size:"lg",fixWidth:!0}),onClick:t.controller.aiClick},r.createElement("div",{className:"font-weight-bold"},"\u5e2e\u6211\u627e\u627e\u673a\u4f1a"))},t.page=Object(d.a)(function(e){var n=t.controller,i=n.tasktypelist,o=(n.selectTaskType,r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u62b1\u6b49\uff0c\u672a\u627e\u5230\u76f8\u5173\u4ea7\u54c1\uff0c\u8bf7\u91cd\u65b0\u641c\u7d22\uff01"));return r.createElement(s.Page,{header:"\u65b0\u5efa\u4efb\u52a1"},t.ai(),r.createElement(h.List,{before:"",none:o,items:i,item:{render:t.renderList,onClick:t.onClickTaskType}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t}(s.VPage),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.page=Object(d.a)(function(){return r.createElement(s.Page,{header:"AI"},r.createElement("div",{className:"p-3"},!1===t.finished?r.createElement(r.Fragment,null,r.createElement("i",{className:"fa fa-spinner fa-spin fa-3x fa-fw"}),r.createElement("span",{className:"sr-only"},"Loading..."),"\u597d\u963f\uff0c\u6211\u6765\u7b97\u7b97\uff0c\u7a0d\u7b49......"):r.createElement(r.Fragment,null,r.createElement("i",{className:"fa fa-frown-o fa-2x fa-fw text-warning"})," \u6ca1\u6709\u627e\u5230\u9002\u5408\u4f60\u7684\u673a\u4f1a\uff01")))}),t}return o.d(t,e),t.prototype.open=function(){return o.b(this,void 0,void 0,function(){var e=this;return o.e(this,function(t){return this.finished=!1,this.openPage(this.page),setTimeout(function(){e.finished=!0},3e3),[2]})})},o.c([f.l],t.prototype,"finished",void 0),t}(s.VPage),L=function(e){function t(t,n){var r=e.call(this,n)||this;r.selectTaskType=function(e){return o.b(r,void 0,Promise,function(){return o.e(this,function(t){return this.returnCall(e),[2]})})},r.aiClick=function(){r.openVPage(R)},r.cSalesTask=t;var i=r.cSalesTask.cApp.cUqSalesTask;return r.tuidTaskType=i.tuid("tasktype"),r}return o.d(t,e),t.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return this.customerid=e,[4,this.searchByKey("")];case 1:return t.sent(),this.openVPage(q,e),[2]}})})},t.prototype.searchByKey=function(e){return o.b(this,void 0,void 0,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return t=this,[4,this.tuidTaskType.search(e,0,100)];case 1:return t.tasktypelist=n.sent(),[2]}})})},o.c([f.l],t.prototype,"tasktypelist",void 0),t}(s.Controller),D=n(8),U=n.n(D),B=function(){function e(e){this.tasksNow=f.l.array([],{deep:!0}),this.dateTasksList=f.l.array([],{deep:!0});for(var t=0,n=e;t<n.length;t++){var r=n[t];this.add(r)}}return e.prototype.postPone=function(e,t){this.remove(t);var n=U.a.clone(t);n.remindDate=e,this.add(n)},e.prototype.add=function(e){var t=e.remindDate;if(t){var n=this.dateTasksList.find(function(e){return e.date===t});void 0===n?(n={date:t,list:[e]},this.dateTasksList.push(n)):n.list.push(e)}else this.tasksNow.push(e)},e.prototype.remove=function(e){var t=this.tasksNow.findIndex(function(t){return t.id===e.id});if(t>=0)this.tasksNow.splice(t,1);else for(var n=this.dateTasksList.length,r=0;r<n;r++){var i=this.dateTasksList[r].list;if((t=i.findIndex(function(t){return t.id===e.id}))>=0)return i.splice(t,1),void(0===i.length&&this.dateTasksList.splice(r,1))}},o.c([f.l],e.prototype,"tasksNow",void 0),o.c([f.l],e.prototype,"dateTasksList",void 0),e}(),M=[{name:"resulttype",type:"id",required:!1},{name:"result",type:"string",required:!0}],_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uiSchema={items:{resulttype:{visible:!1},result:{widget:"textarea",label:"\u7ed3\u679c",placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u7ed3\u679c\uff01",rows:12},submit:{widget:"button",label:"\u63d0\u4ea4"}}},t.onInvalidTask=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return this.form?[4,this.form.buttonClick("submit")]:[2];case 1:return e.sent(),[2]}})})},t.onFormButtonClick=function(e,n){return o.b(t,void 0,void 0,function(){var e,t,r;return o.e(this,function(i){switch(i.label){case 0:return e=n.form.data,t=e.result,r=e.resulttype,[4,this.controller.onInvalidTask(this.task,t,r)];case 1:return i.sent(),this.closePage(2),[2]}})})},t.page=Object(d.a)(function(e){var n=r.createElement("button",{type:"button",className:"btn btn-primary w-100",onClick:t.onInvalidTask},"\u5b8c\u7ed3");return r.createElement(s.Page,{header:"\u62d2\u7edd",footer:n},r.createElement("div",{className:"App-container container text-left"},r.createElement(s.Form,{ref:function(e){return t.form=e},className:"my-3",schema:M,uiSchema:t.uiSchema,onButtonClick:t.onFormButtonClick})))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.task=e,this.openPage(this.page,e),[2]})})},t}(s.VPage),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderHistory=function(e,t){var n=e.task,i=e.date,o=e.status,s=(e.principal,e.result);return r.createElement("div",{className:"d-block p-3"},r.createElement(h.LMR,null,r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement(h.EasyDate,{date:i})," ",Object(a.tv)(o,function(e){return e.name}))),r.createElement(h.LMR,{right:r.createElement("small",null,Object(a.tv)(n,function(e){return Object(a.tv)(e.type,function(e){return e.name})})),left:r.createElement("div",null,r.createElement("span",null,r.createElement(h.FA,{name:"user",className:"mr-3 text-info"})),Object(a.tv)(n,function(e){return Object(a.tv)(e.customer,function(e){return e.name})}))})),r.createElement("small",null,s))},t.onTaskClick=function(e){return o.b(t,void 0,void 0,function(){var t,n;return o.e(this,function(r){return t=e.task.obj,n={id:t.id,type:t.type,typeName:t.type.obj.name,description:null,remindDate:null,deadline:null,customer:t.customer},this.controller.showDetailFromId(n),[2]})})},t.page=Object(d.a)(function(e){var n=r.createElement("div",{className:"m-3 text-muted small"},"\u3010\u65e0\u8bb0\u5f55\u3011");return r.createElement(s.Page,{header:"\u5df2\u5b8c\u6210\u4efb\u52a1"},r.createElement(h.List,{before:"",none:n,items:e.tasks,item:{render:t.renderHistory,onClick:t.onTaskClick}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t}(s.VPage),$=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderHistory=function(e,t){var n=e.task,i=e.date,o=e.status,s=(e.principal,e.result);return r.createElement("div",{className:"d-block p-3"},r.createElement(h.LMR,null,r.createElement("div",null,r.createElement("small",{className:"text-muted"},r.createElement(h.EasyDate,{date:i})," ",Object(a.tv)(o,function(e){return e.name}))),Object(a.tv)(n,function(e){return Object(a.tv)(e.type,function(e){return e.name})})),r.createElement("small",null,s))},t.onSalesTaskClick=function(e){return o.b(t,void 0,void 0,function(){var t,n;return o.e(this,function(r){return t=e.task.obj,n={id:t.id,type:t.type,typeName:t.type.obj.name,description:null,remindDate:null,deadline:null,customer:t.customer},this.controller.showTaskDetailEdit(n),[2]})})},t.page=Object(d.a)(function(e){var n=r.createElement("div",{className:"m-3 text-muted small"},"\u3010\u65e0\u8bb0\u5f55\u3011");return r.createElement(s.Page,{header:"\u4ea4\u6d41\u8bb0\u5f55"},r.createElement(h.List,{before:"",none:n,items:e.tasks,item:{render:t.renderHistory,onClick:t.onSalesTaskClick}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t}(s.VPage),W=(function(e){function t(t){var n=e.call(this)||this;return n.firstSize=n.pageSize=10,n.searchsalestskQuery=t,n}o.d(t,e),t.prototype.load=function(e,t,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===t&&(t=0),[4,this.searchsalestskQuery.page(e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.setPageStart=function(e){this.pageStart=void 0===e?0:e.id}}(s.PageItems),function(e){function t(t,n){var i=e.call(this,n)||this;i.taskTypes={},i.searchByKey=function(e){return o.b(i,void 0,void 0,function(){var e;return o.e(this,function(t){switch(t.label){case 0:return[4,this.qeurySearchTask.table({})];case 1:return e=t.sent(),this.tasks=new B(e),[2]}})})},i.loadTask=function(e){return o.b(i,void 0,void 0,function(){var t,n;return o.e(this,function(r){switch(r.label){case 0:return[4,this.taskTuid.load(e)];case 1:return t=r.sent(),n=t,[4,this.searchTaskCompletion(e)];case 2:return n.fields=r.sent(),[2,t]}})})},i.searchTaskCompletion=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.qeurySearchTaskCompletion.table({taskid:e})];case 1:return[2,t.sent()]}})})},i.showTaskHistory=function(e){return o.b(i,void 0,void 0,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.qeurySearchHistory.table({taskid:e})];case 1:return t=n.sent(),this.openVPage(g,{tasks:t}),[2]}})})},i.showEmployeeHistory=function(){return o.b(i,void 0,void 0,function(){var e;return o.e(this,function(t){switch(t.label){case 0:return[4,this.qeurySearchEmployeeHistory.table({})];case 1:return e=t.sent(),this.openVPage(H,{tasks:e}),[2]}})})},i.showCustomerHistory=function(e){return o.b(i,void 0,void 0,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.qeurySearchCustomerHistory.table({customerid:e})];case 1:return t=n.sent(),this.openVPage($,{tasks:t}),[2]}})})},i.showTaskDetailEdit=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.getCTaskType(e.typeName).showDetailEdit(e),[2]})})},i.showDetailFromId=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.getCTaskType(e.typeName).showDetailFromId(e.id),[2]})})},i.showTaskComplet=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.openVPage(v,e),[2]})})},i.showTaskExtension=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.openVPage(y,e),[2]})})},i.showTaskInvalid=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.openVPage(_,e),[2]})})},i.onInvalidTask=function(e,t,n){return o.b(i,void 0,void 0,function(){var n;return o.e(this,function(r){switch(r.label){case 0:return n={taskid:e.id,resulttype:"Inval",result:t},[4,this.completionTaskAction.submit(n)];case 1:return r.sent(),this.tasks.remove(e),[2]}})})},i.createTask=function(){return o.b(i,void 0,void 0,function(){var e,t,n,r;return o.e(this,function(i){switch(i.label){case 0:return[4,this.selectTaskType()];case 1:return e=i.sent(),[4,this.selectCustomer()];case 2:return t=i.sent(),n=e.name,r={id:null,type:e,typeName:n,description:null,remindDate:null,deadline:null,customer:t},this.getCTaskType(n).showCreate(r),[2]}})})},i.selectCustomer=function(){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.cApp.cCustomer.call()];case 1:return[2,e.sent()]}})})},i.selectTaskType=function(){return o.b(i,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.cSalesTaskType.call()];case 1:return[2,e.sent()]}})})},i.addTask=function(e,t){return o.b(i,void 0,void 0,function(){var n,r,i,s,a,u,c,l,h;return o.e(this,function(o){switch(o.label){case 0:return n=e.description,r=e.priorty,i=e.deadline,s=t.customer,a=t.type,u=s.id,c=a.id,l={id:void 0,description:n,customer:u,type:c,sourceID:"",sourceType:"",sourceNo:"",priorty:r=r?1:0,deadline:i},[4,this.addTaskAction.submit(l)];case 1:return h=o.sent(),l.id=h.id,[4,this.searchByKey(e)];case 2:return o.sent(),[2]}})})},i.showCustomerDetail=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.cApp.cCustomer.showCustomerDetail(e),[2]})})},i.render=Object(d.a)(function(){return i.renderView(p)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=t,i.cSalesTaskType=new L(i,void 0);var s=i.cApp,a=s.cUqSalesTask,u=s.cUqCustomer;return i.taskTuid=a.tuid("task"),i.tuidCustomer=u.tuid("customer"),i.taskTypeTuid=a.tuid("tasktype"),i.taskBook=a.book("taskbook"),i.completionTaskAction=a.action("CompletionTask"),i.extensionTaskAction=a.action("ExtensionTask"),i.addTaskAction=a.action("AddTask"),i.qeurySearchTask=a.query("searchtask"),i.qeurySearchHistory=a.query("searchhistorytask"),i.qeurySearchEmployeeHistory=a.query("searchhistorytaskbyemployee"),i.qeurySearchCustomerHistory=a.query("searchhistorytaskbycustomer"),i.qeurySearchTaskCompletion=a.query("searchtaskcompletion"),i.taskTypes=function(e){var t={};for(var n in j){var r,i=j[n];"function"===typeof i?((r=t[n]=new i(void 0)).cSalesTask=e,r.caption||(r.caption=n)):(r=t[n]=new A(i,void 0)).cSalesTask=e}return t}(i),i}return o.d(t,e),t.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.searchByKey(e)];case 1:return t.sent(),[2]}})})},t.prototype.taskIcon=function(e){var t=this.taskTypes[e];if(void 0===t)throw e+" is not defined";return t.icon},t.prototype.getCTaskType=function(e){var t=this.taskTypes[e];if(void 0===t)throw e+" is not defined";return t},t.prototype.completionTask=function(e,t,n){return o.b(this,void 0,void 0,function(){var n;return o.e(this,function(r){switch(r.label){case 0:return n={taskid:e.id,resulttype:"compl",result:t,fields:[{fieldName:"a",value:1},{fieldName:"b",value:2},{fieldName:"a",value:3}]},[4,this.completionTaskAction.submit(n)];case 1:return r.sent(),this.tasks.remove(e),this.closePage(2),[2]}})})},t.prototype.extensionTask=function(e,t,n,r){return o.b(this,void 0,void 0,function(){var n;return o.e(this,function(i){switch(i.label){case 0:return n={taskid:e.id,result:t,remindDate:r},[4,this.extensionTaskAction.submit(n)];case 1:return i.sent(),this.tasks.postPone(r,e),[2]}})})},o.c([f.l],t.prototype,"tasks",void 0),t}(s.Controller)),z="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask",K="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/customer",Q="\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/product",G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCustomer=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.selectCustomer(e)];case 1:return t.sent(),this.ceasePage(),[2]}})})},t.page=Object(d.a)(function(e){var n=t.controller.pageCustomer,i=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u8bf7\u641c\u7d22\u5ba2\u6237\uff01");return r.createElement(s.Page,{header:"\u9009\u62e9\u5ba2\u6237"},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2",size:"md",onSearch:function(e){return t.controller.searchByKey(e)},placeholder:"\u641c\u7d22\u5ba2\u6237\u59d3\u540d\u3001\u5355\u4f4d"}),r.createElement(h.List,{before:"",none:i,items:n,item:{render:t.renderCustomer,onClick:t.onClickCustomer}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t.prototype.renderCustomer=function(e,t){var n=e.name;return r.createElement(h.LMR,{className:"px-3 py-2 ",left:r.createElement(h.FA,{name:"user",className:" my-2 mr-3 text-info"})},r.createElement("div",{className:"font-weight-bold"}),r.createElement("div",null,n))},t}(s.VPage),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.page=Object(d.a)(function(e){var n=t.controller.cApp.cSalesTask.showCustomerHistory,i=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"university",className:"text-info"}))," \xa0\u5317\u4eac\u5927\u5b66"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,n(e.id)];case 1:return[2,t.sent()]}})})},left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"hand-o-right",className:"text-info"}))," \xa0\u6c9f\u901a\u8bb0\u5f55"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"string",name:"no",label:"\u7f16\u53f7",vAlign:"center"},{type:"string",name:"name",label:"\u59d3\u540d",vAlign:"stretch"},{type:"string",name:"gender",label:"\u6027\u522b",vAlign:"stretch"},{type:"string",name:"birthday",label:"\u751f\u65e5"},{type:"string",name:"birthday",label:"\u9886\u57df",vAlign:"center"},{type:"string",name:"birthday",label:"TOP\u5355\u4f4d",vAlign:"stretch"}];return r.createElement(s.Page,{header:"\u5ba2\u6237\u8be6\u60c5"},r.createElement(h.PropGrid,{className:"my-2",rows:i,values:e,alignValue:"right"}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t}(s.VPage),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCustomer=function(e){return o.b(t,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.controller.showCustomerDetail(e.id)];case 1:return t.sent(),[2]}})})},t.page=Object(d.a)(function(e){var n=t.controller.pageCustomer,i=r.createElement("div",{className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),o=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u8bf7\u641c\u7d22\u5ba2\u6237\uff01");r.createElement("br",null);var a=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:i},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u5ba2\u6237"));return r.createElement(s.Page,{header:a},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2  ",size:"md",onSearch:function(e){return t.controller.searchByKey(e)},placeholder:"\u641c\u7d22\u5ba2\u6237\u59d3\u540d\u3001\u5355\u4f4d"}),r.createElement(h.List,{before:"",none:o,items:n,item:{render:t.renderCustomer,onClick:t.onClickCustomer}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t.prototype.render=function(e){return r.createElement(this.page,null)},t.prototype.renderCustomer=function(e,t){var n=e.name;return r.createElement(h.LMR,{className:"px-3 py-2 ",left:r.createElement(h.FA,{name:"user",className:" my-2 mr-3 text-info"})},r.createElement("div",{className:"font-weight-bold"}),r.createElement("div",null,n))},t}(s.VPage),X=function(e){function t(t){var n=e.call(this)||this;return n.firstSize=n.pageSize=10,n.searchCustomerQuery=t,n}return o.d(t,e),t.prototype.load=function(e,t,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===t&&(t=0),[4,this.searchCustomerQuery.page(e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.setPageStart=function(e){this.pageStart=void 0===e?0:e.id},t}(s.PageItems),Z=function(e){function t(t,n){var i=e.call(this,n)||this;i.searchByKey=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.pageCustomer=new X(this.querySearchCustomer),this.pageCustomer.first({key:e}),[2]})})},i.loadCustomerDetail=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){switch(t.label){case 0:return[4,this.tuidCustomer.load(e)];case 1:return[2,t.sent()]}})})},i.showCustomerDetail=function(e){return o.b(i,void 0,void 0,function(){var t;return o.e(this,function(n){switch(n.label){case 0:return[4,this.loadCustomerDetail(e)];case 1:return t=n.sent(),this.openVPage(J,t),[2]}})})},i.selectCustomer=function(e){return o.b(i,void 0,Promise,function(){return o.e(this,function(t){return this.returnCall(e),[2]})})},i.render=Object(d.a)(function(){return i.pageCustomer=null,i.renderView(Y)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=t;var s=i.cApp.cUqCustomer;return i.tuidCustomer=s.tuid("customer"),i.querySearchCustomer=s.query("searchcustomer"),i}return o.d(t,e),t.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.pageCustomer=null,this.openVPage(G,e),[2]})})},o.c([f.l],t.prototype,"pageCustomer",void 0),t}(s.Controller),ee="http://www.jkchemical.com/static/Structure/",te="http://www.jkchemical.com/static/Structure/999.png";function ne(e){var t=e.style,n=e.className,i=e.chemicalId;return r.createElement(s.Image,{src:i&&ee+i.substr(0,3)+"/"+i+".png",style:t,className:n,altImage:te})}var re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderBrand=function(e){return t.productPropItem("\u54c1\u724c",e.name)},t.productPropItem=function(e,t){return null===t||void 0===t?null:r.createElement(r.Fragment,null,r.createElement("div",{className:"col-4 col-sm-2 col-lg-4 text-muted pr-0 small"},e),r.createElement("div",{className:"col-8 col-sm-4 col-lg-8"},t))},t.renderProduct=function(e,n){var i=e.brand,o=e.description,s=e.descriptionC,u=e.CAS,c=e.purity,l=e.molecularFomula,h=e.molecularWeight,d=e.origin,p=e.imageUrl;return r.createElement("div",{className:"d-block mb-4 px-2"},r.createElement("div",{className:"py-2"},r.createElement("div",null,r.createElement("strong",null,o)),r.createElement("div",null,s)),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-3"},r.createElement(ne,{chemicalId:p,className:"w-100"})),r.createElement("div",{className:"col-9"},r.createElement("div",{className:"row"},t.productPropItem("CAS",u),t.productPropItem("\u7eaf\u5ea6",c),t.productPropItem("\u5206\u5b50\u5f0f",l),t.productPropItem("\u5206\u5b50\u91cf",h),t.productPropItem("\u4ea7\u54c1\u7f16\u53f7",d),Object(a.tv)(i,t.renderBrand)))))},t.onScrollBottom=function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,this.controller.pageProduct.more()];case 1:return e.sent(),[2]}})})},t.page=Object(d.a)(function(e){var n=t.controller.pageProduct,i=r.createElement("div",{className:"cursor-pointer px-3 py-1"},r.createElement(h.FA,{name:"plus"})),o=r.createElement("div",{className:"my-3 mx-2 text-warning"},"\u672a\u641c\u7d22\u5230\u4ea7\u54c1");r.createElement("br",null);var a=r.createElement(h.LMR,{className:"pl-3 py-2 bg-primary text-white",right:i},r.createElement("div",{className:"d-flex h-100 align-items-center"},"\u4ea7\u54c1"));return r.createElement(s.Page,{header:a,onScrollBottom:t.onScrollBottom},r.createElement(h.SearchBox,{className:"px-1 w-100  mt-2 mr-2 ",size:"md",onSearch:function(e){return t.controller.searchByKey(e)},placeholder:"\u641c\u7d22\u54c1\u540d\u3001\u7f16\u53f7\u3001CAS\u3001MDL\u7b49"}),r.createElement(h.List,{before:"",none:o,items:n,item:{render:t.renderProduct,onClick:null}}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t.prototype.render=function(e){return r.createElement(this.page,null)},t}(s.VPage),ie=function(e){function t(t){var n=e.call(this)||this;return n.firstSize=n.pageSize=10,n.searchProductQuery=t,n}return o.d(t,e),t.prototype.load=function(e,t,n){return o.b(this,void 0,Promise,function(){return o.e(this,function(r){switch(r.label){case 0:return void 0===t&&(t=0),[4,this.searchProductQuery.page(e,t,n)];case 1:return[2,r.sent()]}})})},t.prototype.setPageStart=function(e){this.pageStart=void 0===e?0:e.id},t}(s.PageItems),oe=function(e){function t(t,n){var i=e.call(this,n)||this;i.searchByKey=function(e){return o.b(i,void 0,void 0,function(){return o.e(this,function(t){return this.pageProduct=new ie(this.querySearchProduct),this.pageProduct.first({key:e,salesRegion:1}),[2]})})},i.render=Object(d.a)(function(){return i.pageProduct=null,i.renderView(re)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=t;var s=i.cApp.cUqProduct;return i.querySearchProduct=s.query("searchProduct"),i}return o.d(t,e),t.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openVPage(null,e),[2]})})},o.c([f.l],t.prototype,"pageProduct",void 0),o.c([f.l],t.prototype,"customerlist",void 0),t}(s.Controller),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logout=function(){s.nav.showLogout()},t.page=Object(d.a)(function(e){var n=t.controller.cApp.cSalesTask.showEmployeeHistory,i=[{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",onClick:function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return[2,e.sent()]}})})},left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"tag",className:"text-info"}))," \xa0\u5df2\u5b8c\u6210\u4efb\u52a1"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"line-chart",className:"text-danger"}))," \xa0\u9500\u91cf"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"usd ",className:"text-warning"}))," \xa0\u5de5\u8d44"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})},{type:"component",name:"customer",component:r.createElement(h.LMR,{className:"cursor-pointer w-100 py-3",left:r.createElement("div",null," ",r.createElement("small",null,r.createElement(h.FA,{name:"car",className:"text-info"}))," \xa0\u62dc\u8bbf"),right:r.createElement("div",{className:"w-2c text-right"}," ",r.createElement("i",{className:"fa fa-chevron-right"}))})}],a=r.createElement("div",{className:"mr-3"},r.createElement(h.FA,{name:"bars"})),u=r.createElement(h.LMR,{className:"pl-3 pt-2 pb-3 bg-primary text-white",right:a},"\u6211\u7684"),c=r.createElement("button",{type:"button",className:"btn btn-danger w-100",onClick:t.logout},"\u9000\u51fa");return r.createElement(s.Page,{header:u,footer:c},r.createElement(h.PropGrid,{className:"my-2",rows:i,values:e,alignValue:"right"}))}),t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openPage(this.page,e),[2]})})},t.prototype.render=function(e){return r.createElement(this.page,null)},t}(s.VPage),ae=function(e){function t(t,n){var i=e.call(this,n)||this;i.render=Object(d.a)(function(){return i.renderView(se)}),i.tab=function(){return r.createElement(i.render,null)},i.cApp=t;var o=i.cApp,s=o.cUqSalesTask,a=o.cUqCustomer;return i.tuidCustomer=s.tuid("customer"),i.querySearchCustomer=a.query("searchcustomer"),i}return o.d(t,e),t.prototype.internalStart=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(t){return this.openVPage(se,e),[2]})})},t}(s.Controller),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.d(t,e),t.prototype.internalStart=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(n){switch(n.label){case 0:return this.cUqSalesTask=this.getCUq(z),this.cUqCustomer=this.getCUq(K),this.cUqProduct=this.getCUq(Q),this.cCustomer=new Z(this,void 0),this.cProduct=new oe(this,void 0),this.cSalesTask=new W(this,this.res),this.cMe=new ae(this,void 0),this.cSalesTask.start(),[4,e.prototype.internalStart.call(this,t)];case 1:return n.sent(),[2]}})})},t}(a.CApp),ce=function(e){return!0===e?"text-primary":"text-muted"},le={appName:"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask",CApp:ue,main:function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(e){var n=t.controller,i=n.cSalesTask,o=n.cCustomer,a=n.cProduct,u=n.cMe,c=[{name:"home",label:"\u4efb\u52a1",content:i.tab,icon:"home",notify:void 0},{name:"member",label:"\u5ba2\u6237",content:o.tab,icon:"vcard"},{name:"member",label:"\u4ea7\u54c1",content:a.tab,icon:"flask"},{name:"member",label:"\u6211",content:u.tab,icon:"user"}].map(function(e){var t=e.name,n=e.label,r=e.icon;return{name:t,caption:function(e){return Object(s.TabCaptionComponent)(n,r,ce(e))},content:e.content,notify:e.notify}});return r.createElement(s.Page,{header:!1},r.createElement(s.Tabs,{tabs:c}))},t}return o.d(t,e),t.prototype.open=function(e){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){return this.openPage(this.render),[2]})})},t}(s.VPage),uqs:{"\u767e\u7075\u5a01\u7cfb\u7edf\u5de5\u7a0b\u90e8/salestask":u}},he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onLogined=function(){return o.b(t,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return[4,Object(a.startApp)(le)];case 1:return e.sent(),[2]}})})},t}return o.d(t,e),t.prototype.render=function(){return r.createElement(s.NavView,{onLogined:this.onLogined})},t}(r.Component),de=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function pe(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(118),n(120);i.render(r.createElement(he,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="./service-worker.js";de?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):pe(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):pe(e)})}}()}],[[92,4,3]]]);
//# sourceMappingURL=main.5dc479ba.chunk.js.map